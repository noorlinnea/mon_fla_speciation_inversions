#### Demographic analyses (gIMble) Poikela et al. 2024 ####

## trimming Illumina reads
conda activate myenv
conda install -c bioconda fastp
conda install -c bioconda sambamba

fastp -p --detect_adapter_for_pe -i 0_illumina_reads/fla3Fall.1.fq.gz -I 0_illumina_reads/fla3Fall.2.fq.gz -o 1_trim/fla3Fall.1.trim.fq.gz -O 1_trim/fla3Fall.2.trim.fq.gz --cut_front --cut_tail --cut_window_size 4 --cut_mean_quality 20 --json fla3Fall.trim.json --html fla3Fall.trim.html --thread 8
fastp -p --detect_adapter_for_pe -i 0_illumina_reads/flaASH13F2.112.1.fq.gz -I 0_illumina_reads/flaASH13F2.112.2.fq.gz -o 1_trim/flaASH13F2.112.1.trim.fq.gz -O 1_trim/flaASH13F2.112.2.trim.fq.gz --cut_front --cut_tail --cut_window_size 4 --cut_mean_quality 20 --json flaASH13F2.112.trim.json --html flaASH13F2.112.trim.html --thread 8
fastp -p --detect_adapter_for_pe -i 0_illumina_reads/flaASH13F2.120.1.fq.gz -I 0_illumina_reads/flaASH13F2.120.2.fq.gz -o 1_trim/flaASH13F2.120.1.trim.fq.gz -O 1_trim/flaASH13F2.120.2.trim.fq.gz --cut_front --cut_tail --cut_window_size 4 --cut_mean_quality 20 --json flaASH13F2.120.trim.json --html flaASH13F2.120.trim.html --thread 8
fastp -p --detect_adapter_for_pe -i 0_illumina_reads/flaCRAN14F7.1.fq.gz -I 0_illumina_reads/flaCRAN14F7.2.fq.gz -o 1_trim/flaCRAN14F7.1.trim.fq.gz -O 1_trim/flaCRAN14F7.2.trim.fq.gz --cut_front --cut_tail --cut_window_size 4 --cut_mean_quality 20 --json flaCRAN14F7.trim.json --html flaCRAN14F7.trim.html --thread 8
fastp -p --detect_adapter_for_pe -i 0_illumina_reads/flaJX13F31.112.1.fq.gz -I 0_illumina_reads/flaJX13F31.112.2.fq.gz -o 1_trim/flaJX13F31.112.1.trim.fq.gz -O 1_trim/flaJX13F31.112.2.trim.fq.gz --cut_front --cut_tail --cut_window_size 4 --cut_mean_quality 20 --json flaJX13F31.112.trim.json --html flaJX13F31.112.trim.html --thread 8
fastp -p --detect_adapter_for_pe -i 0_illumina_reads/flaJX13F31.120.1.fq.gz -I 0_illumina_reads/flaJX13F31.120.2.fq.gz -o 1_trim/flaJX13F31.120.1.trim.fq.gz -O 1_trim/flaJX13F31.120.2.trim.fq.gz --cut_front --cut_tail --cut_window_size 4 --cut_mean_quality 20 --json flaJX13F31.120.trim.json --html flaJX13F31.120.trim.html --thread 8
fastp -p --detect_adapter_for_pe -i 0_illumina_reads/flaLB15F3.112.1.fq.gz -I 0_illumina_reads/flaLB15F3.112.2.fq.gz -o 1_trim/flaLB15F3.112.1.trim.fq.gz -O 1_trim/flaLB15F3.112.2.trim.fq.gz --cut_front --cut_tail --cut_window_size 4 --cut_mean_quality 20 --json flaLB15F3.112.trim.json --html flaLB15F3.112.trim.html --thread 8
fastp -p --detect_adapter_for_pe -i 0_illumina_reads/flaLB15F3.120.1.fq.gz -I 0_illumina_reads/flaLB15F3.120.2.fq.gz -o 1_trim/flaLB15F3.120.1.trim.fq.gz -O 1_trim/flaLB15F3.120.2.trim.fq.gz --cut_front --cut_tail --cut_window_size 4 --cut_mean_quality 20 --json flaLB15F3.120.trim.json --html flaLB15F3.120.trim.html --thread 8
fastp -p --detect_adapter_for_pe -i 0_illumina_reads/flaMB14F10.1.fq.gz -I 0_illumina_reads/flaMB14F10.2.fq.gz -o 1_trim/flaMB14F10.1.trim.fq.gz -O 1_trim/flaMB14F10.2.trim.fq.gz --cut_front --cut_tail --cut_window_size 4 --cut_mean_quality 20 --json flaMB14F10.trim.json --html flaMB14F10.trim.html --thread 8
fastp -p --detect_adapter_for_pe -i 0_illumina_reads/flaMT13F11.112.1.fq.gz -I 0_illumina_reads/flaMT13F11.112.2.fq.gz -o 1_trim/flaMT13F11.112.1.trim.fq.gz -O 1_trim/flaMT13F11.112.2.trim.fq.gz --cut_front --cut_tail --cut_window_size 4 --cut_mean_quality 20 --json flaMT13F11.112.trim.json --html flaMT13F11.112.trim.html --thread 8
fastp -p --detect_adapter_for_pe -i 0_illumina_reads/flaMT13F11.120.1.fq.gz -I 0_illumina_reads/flaMT13F11.120.2.fq.gz -o 1_trim/flaMT13F11.120.1.trim.fq.gz -O 1_trim/flaMT13F11.120.2.trim.fq.gz --cut_front --cut_tail --cut_window_size 4 --cut_mean_quality 20 --json flaMT13F11.120.trim.json --html flaMT13F11.120.trim.html --thread 8
fastp -p --detect_adapter_for_pe -i 0_illumina_reads/flaTER14F5.1.fq.gz -I 0_illumina_reads/flaTER14F5.2.fq.gz -o 1_trim/flaTER14F5.1.trim.fq.gz -O 1_trim/flaTER14F5.2.trim.fq.gz --cut_front --cut_tail --cut_window_size 4 --cut_mean_quality 20 --json flaTER14F5.trim.json --html flaTER14F5.trim.html --thread 8
fastp -p --detect_adapter_for_pe -i 0_illumina_reads/flaVAN14F20.112.1.fq.gz -I 0_illumina_reads/flaVAN14F20.112.2.fq.gz -o 1_trim/flaVAN14F20.112.1.trim.fq.gz -O 1_trim/flaVAN14F20.112.2.trim.fq.gz --cut_front --cut_tail --cut_window_size 4 --cut_mean_quality 20 --json flaVAN14F20.112.trim.json --html flaVAN14F20.112.trim.html --thread 8
fastp -p --detect_adapter_for_pe -i 0_illumina_reads/flaVAN14F20.120.1.fq.gz -I 0_illumina_reads/flaVAN14F20.120.2.fq.gz -o 1_trim/flaVAN14F20.120.1.trim.fq.gz -O 1_trim/flaVAN14F20.120.2.trim.fq.gz --cut_front --cut_tail --cut_window_size 4 --cut_mean_quality 20 --json flaVAN14F20.120.trim.json --html flaVAN14F20.120.trim.html --thread 8
fastp -p --detect_adapter_for_pe -i 0_illumina_reads/mon4Fall.1.fq.gz -I 0_illumina_reads/mon4Fall.2.fq.gz -o 1_trim/mon4Fall.1.trim.fq.gz -O 1_trim/mon4Fall.2.trim.fq.gz --cut_front --cut_tail --cut_window_size 4 --cut_mean_quality 20 --json mon4Fall.trim.json --html mon4Fall.trim.html --thread 8
fastp -p --detect_adapter_for_pe -i 0_illumina_reads/monAF15F28.112.1.fq.gz -I 0_illumina_reads/monAF15F28.112.2.fq.gz -o 1_trim/monAF15F28.112.1.trim.fq.gz -O 1_trim/monAF15F28.112.2.trim.fq.gz --cut_front --cut_tail --cut_window_size 4 --cut_mean_quality 20 --json monAF15F28.112.trim.json --html monAF15F28.112.trim.html --thread 8
fastp -p --detect_adapter_for_pe -i 0_illumina_reads/monAF15F28.120.1.fq.gz -I 0_illumina_reads/monAF15F28.120.2.fq.gz -o 1_trim/monAF15F28.120.1.trim.fq.gz -O 1_trim/monAF15F28.120.2.trim.fq.gz --cut_front --cut_tail --cut_window_size 4 --cut_mean_quality 20 --json monAF15F28.120.trim.json --html monAF15F28.120.trim.html --thread 8
fastp -p --detect_adapter_for_pe -i 0_illumina_reads/monASH13F13.112.1.fq.gz -I 0_illumina_reads/monASH13F13.112.2.fq.gz -o 1_trim/monASH13F13.112.1.trim.fq.gz -O 1_trim/monASH13F13.112.2.trim.fq.gz --cut_front --cut_tail --cut_window_size 4 --cut_mean_quality 20 --json monASH13F13.112.trim.json --html monASH13F13.112.trim.html --thread 8
fastp -p --detect_adapter_for_pe -i 0_illumina_reads/monASH13F13.120.1.fq.gz -I 0_illumina_reads/monASH13F13.120.2.fq.gz -o 1_trim/monASH13F13.120.1.trim.fq.gz -O 1_trim/monASH13F13.120.2.trim.fq.gz --cut_front --cut_tail --cut_window_size 4 --cut_mean_quality 20 --json monASH13F13.120.trim.json --html monASH13F13.120.trim.html --thread 8
fastp -p --detect_adapter_for_pe -i 0_illumina_reads/monAZA2.1.fq.gz -I 0_illumina_reads/monAZA2.2.fq.gz -o 1_trim/monAZA2.1.trim.fq.gz -O 1_trim/monAZA2.2.trim.fq.gz --cut_front --cut_tail --cut_window_size 4 --cut_mean_quality 20 --json monAZA2.trim.json --html monAZA2.trim.html --thread 8
fastp -p --detect_adapter_for_pe -i 0_illumina_reads/monCRAN14F16.1.fq.gz -I 0_illumina_reads/monCRAN14F16.2.fq.gz -o 1_trim/monCRAN14F16.1.trim.fq.gz -O 1_trim/monCRAN14F16.2.trim.fq.gz --cut_front --cut_tail --cut_window_size 4 --cut_mean_quality 20 --json monCRAN14F16.trim.json --html monCRAN14F16.trim.html --thread 8
fastp -p --detect_adapter_for_pe -i 0_illumina_reads/monFA13F2.1.fq.gz -I 0_illumina_reads/monFA13F2.2.fq.gz -o 1_trim/monFA13F2.1.trim.fq.gz -O 1_trim/monFA13F2.2.trim.fq.gz --cut_front --cut_tail --cut_window_size 4 --cut_mean_quality 20 --json monFA13F2.trim.json --html monFA13F2.trim.html --thread 8
fastp -p --detect_adapter_for_pe -i 0_illumina_reads/monHO13F3.1.fq.gz -I 0_illumina_reads/monHO13F3.2.fq.gz -o 1_trim/monHO13F3.1.trim.fq.gz -O 1_trim/monHO13F3.2.trim.fq.gz --cut_front --cut_tail --cut_window_size 4 --cut_mean_quality 20 --json monHO13F3.trim.json --html monHO13F3.trim.html --thread 8
fastp -p --detect_adapter_for_pe -i 0_illumina_reads/monJX13F48.112.1.fq.gz -I 0_illumina_reads/monJX13F48.112.2.fq.gz -o 1_trim/monJX13F48.112.1.trim.fq.gz -O 1_trim/monJX13F48.112.2.trim.fq.gz --cut_front --cut_tail --cut_window_size 4 --cut_mean_quality 20 --json monJX13F48.112.trim.json --html monJX13F48.112.trim.html --thread 8
fastp -p --detect_adapter_for_pe -i 0_illumina_reads/monJX13F48.120.1.fq.gz -I 0_illumina_reads/monJX13F48.120.2.fq.gz -o 1_trim/monJX13F48.120.1.trim.fq.gz -O 1_trim/monJX13F48.120.2.trim.fq.gz --cut_front --cut_tail --cut_window_size 4 --cut_mean_quality 20 --json monJX13F48.120.trim.json --html monJX13F48.120.trim.html --thread 8
fastp -p --detect_adapter_for_pe -i 0_illumina_reads/monMB14F1.1.fq.gz -I 0_illumina_reads/monMB14F1.2.fq.gz -o 1_trim/monMB14F1.1.trim.fq.gz -O 1_trim/monMB14F1.2.trim.fq.gz --cut_front --cut_tail --cut_window_size 4 --cut_mean_quality 20 --json monMB14F1.trim.json --html monMB14F1.trim.html --thread 8
fastp -p --detect_adapter_for_pe -i 0_illumina_reads/monSE13F37.1.fq.gz -I 0_illumina_reads/monSE13F37.2.fq.gz -o 1_trim/monSE13F37.1.trim.fq.gz -O 1_trim/monSE13F37.2.trim.fq.gz --cut_front --cut_tail --cut_window_size 4 --cut_mean_quality 20 --json monSE13F37.trim.json --html monSE13F37.trim.html --thread 8
fastp -p --detect_adapter_for_pe -i 0_illumina_reads/monTER14F11.1.fq.gz -I 0_illumina_reads/monTER14F11.2.fq.gz -o 1_trim/monTER14F11.1.trim.fq.gz -O 1_trim/monTER14F11.2.trim.fq.gz --cut_front --cut_tail --cut_window_size 4 --cut_mean_quality 20 --json monTER14F11.trim.json --html monTER14F11.trim.html --thread 8
fastp -p --detect_adapter_for_pe -i 0_illumina_reads/monVAN14F1.112.1.fq.gz -I 0_illumina_reads/monVAN14F1.112.2.fq.gz -o 1_trim/monVAN14F1.112.1.trim.fq.gz -O 1_trim/monVAN14F1.112.2.trim.fq.gz --cut_front --cut_tail --cut_window_size 4 --cut_mean_quality 20 --json monVAN14F1.112.trim.json --html monVAN14F1.112.trim.html --thread 8
fastp -p --detect_adapter_for_pe -i 0_illumina_reads/monVAN14F1.120.1.fq.gz -I 0_illumina_reads/monVAN14F1.120.2.fq.gz -o 1_trim/monVAN14F1.120.1.trim.fq.gz -O 1_trim/monVAN14F1.120.2.trim.fq.gz --cut_front --cut_tail --cut_window_size 4 --cut_mean_quality 20 --json monVAN14F1.120.trim.json --html monVAN14F1.120.trim.html --thread 8


## mapping Illumina reads

# reference genome fasta
D_montana.ref_genome.unmasked.fa

# index fasta
bwa index D_montana.ref_genome.unmasked.fa
samtools faidx D_montana.ref_genome.unmasked.fa

bwa mem -R "@RG\tID:flaASH13F2.112\tSM:flaASH13F2\tPL:ILLUMINA\tPU:flaASH13F2.112\tLB:flaASH13F2.112\tDS:flaASH13F2.112" -t 16 D_montana.ref_genome.unmasked.fa /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/flaASH13F2.112.1.trim.fq.gz /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/flaASH13F2.112.2.trim.fq.gz | samtools sort -@16 -T /scratch/npoikela/flaASH13F2.112.mapping.temp5 -o flaASH13F2.112.vs.D_montana.ref_genome.unmasked.bam
sambamba markdup --tmpdir=/scratch/npoikela/flaASH13F2.112.markdup.temp5 -t 16 flaASH13F2.112.vs.D_montana.ref_genome.unmasked.bam flaASH13F2.112.vs.D_montana.ref_genome.unmasked.MD.bam
bwa mem -R "@RG\tID:flaASH13F2.120\tSM:flaASH13F2\tPL:ILLUMINA\tPU:flaASH13F2.120\tLB:flaASH13F2.120\tDS:flaASH13F2.120" -t 16 D_montana.ref_genome.unmasked.fa /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/flaASH13F2.120.1.trim.fq.gz /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/flaASH13F2.120.2.trim.fq.gz | samtools sort -@16 -T /scratch/npoikela/flaASH13F2.120.mapping.temp5 -o flaASH13F2.120.vs.D_montana.ref_genome.unmasked.bam
sambamba markdup --tmpdir=/scratch/npoikela/flaASH13F2.120.markdup.temp5 -t 16 flaASH13F2.120.vs.D_montana.ref_genome.unmasked.bam flaASH13F2.120.vs.D_montana.ref_genome.unmasked.MD.bam
samtools merge flaASH13F2.vs.D_montana.ref_genome.unmasked.MD.bam flaASH13F2.112.vs.D_montana.ref_genome.unmasked.MD.bam flaASH13F2.120.vs.D_montana.ref_genome.unmasked.MD.bam && samtools index flaASH13F2.vs.D_montana.ref_genome.unmasked.MD.bam
picard AddOrReplaceReadGroups I=flaASH13F2.vs.D_montana.ref_genome.unmasked.MD.bam O=flaASH13F2.vs.D_montana.ref_genome.unmasked.MD.rg.bam RGID=flaASH13F2 RGLB=flaASH13F2 RGPL=ILLUMINA RGPU=flaASH13F2 RGSM=flaASH13F2
samtools index flaASH13F2.vs.D_montana.ref_genome.unmasked.MD.rg.bam

bwa mem -R "@RG\tID:flaJX13F31.112\tSM:flaJX13F31\tPL:ILLUMINA\tPU:flaJX13F31.112\tLB:flaJX13F31.112\tDS:flaJX13F31.112" -t 16 D_montana.ref_genome.unmasked.fa /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/flaJX13F31.112.1.trim.fq.gz /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/flaJX13F31.112.2.trim.fq.gz | samtools sort -@16 -T /scratch/npoikela/flaJX13F31.112.mapping.temp5 -o flaJX13F31.112.vs.D_montana.ref_genome.unmasked.bam
sambamba markdup --tmpdir=/scratch/npoikela/flaJX13F31.112.markdup.temp5 -t 16 flaJX13F31.112.vs.D_montana.ref_genome.unmasked.bam flaJX13F31.112.vs.D_montana.ref_genome.unmasked.MD.bam
bwa mem -R "@RG\tID:flaJX13F31.120\tSM:flaJX13F31\tPL:ILLUMINA\tPU:flaJX13F31.120\tLB:flaJX13F31.120\tDS:flaJX13F31.120" -t 16 D_montana.ref_genome.unmasked.fa /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/flaJX13F31.120.1.trim.fq.gz /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/flaJX13F31.120.2.trim.fq.gz | samtools sort -@16 -T /scratch/npoikela/flaJX13F31.120.mapping.temp5 -o flaJX13F31.120.vs.D_montana.ref_genome.unmasked.bam
sambamba markdup --tmpdir=/scratch/npoikela/flaJX13F31.120.markdup.temp5 -t 16 flaJX13F31.120.vs.D_montana.ref_genome.unmasked.bam flaJX13F31.120.vs.D_montana.ref_genome.unmasked.MD.bam
samtools merge flaJX13F31.vs.D_montana.ref_genome.unmasked.MD.bam flaJX13F31.112.vs.D_montana.ref_genome.unmasked.MD.bam flaJX13F31.120.vs.D_montana.ref_genome.unmasked.MD.bam && samtools index flaJX13F31.vs.D_montana.ref_genome.unmasked.MD.bam
picard AddOrReplaceReadGroups I=flaJX13F31.vs.D_montana.ref_genome.unmasked.MD.bam O=flaJX13F31.vs.D_montana.ref_genome.unmasked.MD.rg.bam RGID=flaJX13F31 RGLB=flaJX13F31 RGPL=ILLUMINA RGPU=flaJX13F31 RGSM=flaJX13F31
samtools index flaJX13F31.vs.D_montana.ref_genome.unmasked.MD.rg.bam

bwa mem -R "@RG\tID:flaLB15F3.112\tSM:flaLB15F3\tPL:ILLUMINA\tPU:flaLB15F3.112\tLB:flaLB15F3.112\tDS:flaLB15F3.112" -t 16 D_montana.ref_genome.unmasked.fa /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/flaLB15F3.112.1.trim.fq.gz /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/flaLB15F3.112.2.trim.fq.gz | samtools sort -@16 -T /scratch/npoikela/flaLB15F3.112.mapping.temp5 -o flaLB15F3.112.vs.D_montana.ref_genome.unmasked.bam
sambamba markdup --tmpdir=/scratch/npoikela/flaLB15F3.112.markdup.temp5 -t 16 flaLB15F3.112.vs.D_montana.ref_genome.unmasked.bam flaLB15F3.112.vs.D_montana.ref_genome.unmasked.MD.bam
bwa mem -R "@RG\tID:flaLB15F3.120\tSM:flaLB15F3\tPL:ILLUMINA\tPU:flaLB15F3.120\tLB:flaLB15F3.120\tDS:flaLB15F3.120" -t 16 D_montana.ref_genome.unmasked.fa /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/flaLB15F3.120.1.trim.fq.gz /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/flaLB15F3.120.2.trim.fq.gz | samtools sort -@16 -T /scratch/npoikela/flaLB15F3.120.mapping.temp5 -o flaLB15F3.120.vs.D_montana.ref_genome.unmasked.bam
sambamba markdup --tmpdir=/scratch/npoikela/flaLB15F3.120.markdup.temp5 -t 16 flaLB15F3.120.vs.D_montana.ref_genome.unmasked.bam flaLB15F3.120.vs.D_montana.ref_genome.unmasked.MD.bam
samtools merge flaLB15F3.vs.D_montana.ref_genome.unmasked.MD.bam flaLB15F3.112.vs.D_montana.ref_genome.unmasked.MD.bam flaLB15F3.120.vs.D_montana.ref_genome.unmasked.MD.bam && samtools index flaLB15F3.vs.D_montana.ref_genome.unmasked.MD.bam
picard AddOrReplaceReadGroups I=flaLB15F3.vs.D_montana.ref_genome.unmasked.MD.bam O=flaLB15F3.vs.D_montana.ref_genome.unmasked.MD.rg.bam RGID=flaLB15F3 RGLB=flaLB15F3 RGPL=ILLUMINA RGPU=flaLB15F3 RGSM=flaLB15F3
samtools index flaLB15F3.vs.D_montana.ref_genome.unmasked.MD.rg.bam

bwa mem -R "@RG\tID:flaMT13F11.112\tSM:flaMT13F11\tPL:ILLUMINA\tPU:flaMT13F11.112\tLB:flaMT13F11.112\tDS:flaMT13F11.112" -t 16 D_montana.ref_genome.unmasked.fa /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/flaMT13F11.112.1.trim.fq.gz /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/flaMT13F11.112.2.trim.fq.gz | samtools sort -@16 -T /scratch/npoikela/flaMT13F11.112.mapping.temp5 -o flaMT13F11.112.vs.D_montana.ref_genome.unmasked.bam
sambamba markdup --tmpdir=/scratch/npoikela/flaMT13F11.112.markdup.temp5 -t 16 flaMT13F11.112.vs.D_montana.ref_genome.unmasked.bam flaMT13F11.112.vs.D_montana.ref_genome.unmasked.MD.bam
bwa mem -R "@RG\tID:flaMT13F11.120\tSM:flaMT13F11\tPL:ILLUMINA\tPU:flaMT13F11.120\tLB:flaMT13F11.120\tDS:flaMT13F11.120" -t 16 D_montana.ref_genome.unmasked.fa /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/flaMT13F11.120.1.trim.fq.gz /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/flaMT13F11.120.2.trim.fq.gz | samtools sort -@16 -T /scratch/npoikela/flaMT13F11.120.mapping.temp5 -o flaMT13F11.120.vs.D_montana.ref_genome.unmasked.bam
sambamba markdup --tmpdir=/scratch/npoikela/flaMT13F11.120.markdup.temp5 -t 16 flaMT13F11.120.vs.D_montana.ref_genome.unmasked.bam flaMT13F11.120.vs.D_montana.ref_genome.unmasked.MD.bam
samtools merge flaMT13F11.vs.D_montana.ref_genome.unmasked.MD.bam flaMT13F11.112.vs.D_montana.ref_genome.unmasked.MD.bam flaMT13F11.120.vs.D_montana.ref_genome.unmasked.MD.bam && samtools index flaMT13F11.vs.D_montana.ref_genome.unmasked.MD.bam
picard AddOrReplaceReadGroups I=flaMT13F11.vs.D_montana.ref_genome.unmasked.MD.bam O=flaMT13F11.vs.D_montana.ref_genome.unmasked.MD.rg.bam RGID=flaMT13F11 RGLB=flaMT13F11 RGPL=ILLUMINA RGPU=flaMT13F11 RGSM=flaMT13F11
samtools index flaMT13F11.vs.D_montana.ref_genome.unmasked.MD.rg.bam

bwa mem -R "@RG\tID:flaVAN14F20.112\tSM:flaVAN14F20\tPL:ILLUMINA\tPU:flaVAN14F20.112\tLB:flaVAN14F20.112\tDS:flaVAN14F20.112" -t 16 D_montana.ref_genome.unmasked.fa /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/flaVAN14F20.112.1.trim.fq.gz /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/flaVAN14F20.112.2.trim.fq.gz | samtools sort -@16 -T /scratch/npoikela/flaVAN14F20.112.mapping.temp5 -o flaVAN14F20.112.vs.D_montana.ref_genome.unmasked.bam
sambamba markdup --tmpdir=/scratch/npoikela/flaVAN14F20.112.markdup.temp5 -t 16 flaVAN14F20.112.vs.D_montana.ref_genome.unmasked.bam flaVAN14F20.112.vs.D_montana.ref_genome.unmasked.MD.bam
bwa mem -R "@RG\tID:flaVAN14F20.120\tSM:flaVAN14F20\tPL:ILLUMINA\tPU:flaVAN14F20.120\tLB:flaVAN14F20.120\tDS:flaVAN14F20.120" -t 16 D_montana.ref_genome.unmasked.fa /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/flaVAN14F20.120.1.trim.fq.gz /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/flaVAN14F20.120.2.trim.fq.gz | samtools sort -@16 -T /scratch/npoikela/flaVAN14F20.120.mapping.temp5 -o flaVAN14F20.120.vs.D_montana.ref_genome.unmasked.bam
sambamba markdup --tmpdir=/scratch/npoikela/flaVAN14F20.120.markdup.temp5 -t 16 flaVAN14F20.120.vs.D_montana.ref_genome.unmasked.bam flaVAN14F20.120.vs.D_montana.ref_genome.unmasked.MD.bam
samtools merge flaVAN14F20.vs.D_montana.ref_genome.unmasked.MD.bam flaVAN14F20.112.vs.D_montana.ref_genome.unmasked.MD.bam flaVAN14F20.120.vs.D_montana.ref_genome.unmasked.MD.bam && samtools index flaVAN14F20.vs.D_montana.ref_genome.unmasked.MD.bam
picard AddOrReplaceReadGroups I=flaVAN14F20.vs.D_montana.ref_genome.unmasked.MD.bam O=flaVAN14F20.vs.D_montana.ref_genome.unmasked.MD.rg.bam RGID=flaVAN14F20 RGLB=flaVAN14F20 RGPL=ILLUMINA RGPU=flaVAN14F20 RGSM=flaVAN14F20
samtools index flaVAN14F20.vs.D_montana.ref_genome.unmasked.MD.rg.bam

bwa mem -R "@RG\tID:monAF15F28.112\tSM:monAF15F28\tPL:ILLUMINA\tPU:monAF15F28.112\tLB:monAF15F28.112\tDS:monAF15F28.112" -t 16 D_montana.ref_genome.unmasked.fa /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/monAF15F28.112.1.trim.fq.gz /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/monAF15F28.112.2.trim.fq.gz | samtools sort -@16 -T /scratch/npoikela/monAF15F28.112.mapping.temp5 -o monAF15F28.112.vs.D_montana.ref_genome.unmasked.bam
sambamba markdup --tmpdir=/scratch/npoikela/monAF15F28.112.markdup.temp5 -t 16 monAF15F28.112.vs.D_montana.ref_genome.unmasked.bam monAF15F28.112.vs.D_montana.ref_genome.unmasked.MD.bam
bwa mem -R "@RG\tID:monAF15F28.120\tSM:monAF15F28\tPL:ILLUMINA\tPU:monAF15F28.120\tLB:monAF15F28.120\tDS:monAF15F28.120" -t 16 D_montana.ref_genome.unmasked.fa /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/monAF15F28.120.1.trim.fq.gz /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/monAF15F28.120.2.trim.fq.gz | samtools sort -@16 -T /scratch/npoikela/monAF15F28.120.mapping.temp5 -o monAF15F28.120.vs.D_montana.ref_genome.unmasked.bam
sambamba markdup --tmpdir=/scratch/npoikela/monAF15F28.120.markdup.temp5 -t 16 monAF15F28.120.vs.D_montana.ref_genome.unmasked.bam monAF15F28.120.vs.D_montana.ref_genome.unmasked.MD.bam
samtools merge monAF15F28.vs.D_montana.ref_genome.unmasked.MD.bam monAF15F28.112.vs.D_montana.ref_genome.unmasked.MD.bam monAF15F28.120.vs.D_montana.ref_genome.unmasked.MD.bam && samtools index monAF15F28.vs.D_montana.ref_genome.unmasked.MD.bam
picard AddOrReplaceReadGroups I=monAF15F28.vs.D_montana.ref_genome.unmasked.MD.bam O=monAF15F28.vs.D_montana.ref_genome.unmasked.MD.rg.bam RGID=monAF15F28 RGLB=monAF15F28 RGPL=ILLUMINA RGPU=monAF15F28 RGSM=monAF15F28
samtools index monAF15F28.vs.D_montana.ref_genome.unmasked.MD.rg.bam

bwa mem -R "@RG\tID:monASH13F13.112\tSM:monASH13F13\tPL:ILLUMINA\tPU:monASH13F13.112\tLB:monASH13F13.112\tDS:monASH13F13.112" -t 16 D_montana.ref_genome.unmasked.fa /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/monASH13F13.112.1.trim.fq.gz /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/monASH13F13.112.2.trim.fq.gz | samtools sort -@16 -T /scratch/npoikela/monASH13F13.112.mapping.temp5 -o monASH13F13.112.vs.D_montana.ref_genome.unmasked.bam
sambamba markdup --tmpdir=/scratch/npoikela/monASH13F13.112.markdup.temp5 -t 16 monASH13F13.112.vs.D_montana.ref_genome.unmasked.bam monASH13F13.112.vs.D_montana.ref_genome.unmasked.MD.bam
bwa mem -R "@RG\tID:monASH13F13.120\tSM:monASH13F13\tPL:ILLUMINA\tPU:monASH13F13.120\tLB:monASH13F13.120\tDS:monASH13F13.120" -t 16 D_montana.ref_genome.unmasked.fa /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/monASH13F13.120.1.trim.fq.gz /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/monASH13F13.120.2.trim.fq.gz | samtools sort -@16 -T /scratch/npoikela/monASH13F13.120.mapping.temp5 -o monASH13F13.120.vs.D_montana.ref_genome.unmasked.bam
sambamba markdup --tmpdir=/scratch/npoikela/monASH13F13.120.markdup.temp5 -t 16 monASH13F13.120.vs.D_montana.ref_genome.unmasked.bam monASH13F13.120.vs.D_montana.ref_genome.unmasked.MD.bam
samtools merge monASH13F13.vs.D_montana.ref_genome.unmasked.MD.bam monASH13F13.112.vs.D_montana.ref_genome.unmasked.MD.bam monASH13F13.120.vs.D_montana.ref_genome.unmasked.MD.bam && samtools index monASH13F13.vs.D_montana.ref_genome.unmasked.MD.bam
picard AddOrReplaceReadGroups I=monASH13F13.vs.D_montana.ref_genome.unmasked.MD.bam O=monASH13F13.vs.D_montana.ref_genome.unmasked.MD.rg.bam RGID=monASH13F13 RGLB=monASH13F13 RGPL=ILLUMINA RGPU=monASH13F13 RGSM=monASH13F13
samtools index monASH13F13.vs.D_montana.ref_genome.unmasked.MD.rg.bam

bwa mem -R "@RG\tID:monJX13F48.112\tSM:monJX13F48\tPL:ILLUMINA\tPU:monJX13F48.112\tLB:monJX13F48.112\tDS:monJX13F48.112" -t 16 D_montana.ref_genome.unmasked.fa /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/monJX13F48.112.1.trim.fq.gz /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/monJX13F48.112.2.trim.fq.gz | samtools sort -@16 -T /scratch/npoikela/monJX13F48.112.mapping.temp5 -o monJX13F48.112.vs.D_montana.ref_genome.unmasked.bam
sambamba markdup --tmpdir=/scratch/npoikela/monJX13F48.112.markdup.temp5 -t 16 monJX13F48.112.vs.D_montana.ref_genome.unmasked.bam monJX13F48.112.vs.D_montana.ref_genome.unmasked.MD.bam
bwa mem -R "@RG\tID:monJX13F48.120\tSM:monJX13F48\tPL:ILLUMINA\tPU:monJX13F48.120\tLB:monJX13F48.120\tDS:monJX13F48.120" -t 16 D_montana.ref_genome.unmasked.fa /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/monJX13F48.120.1.trim.fq.gz /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/monJX13F48.120.2.trim.fq.gz | samtools sort -@16 -T /scratch/npoikela/monJX13F48.120.mapping.temp5 -o monJX13F48.120.vs.D_montana.ref_genome.unmasked.bam
sambamba markdup --tmpdir=/scratch/npoikela/monJX13F48.120.markdup.temp5 -t 16 monJX13F48.120.vs.D_montana.ref_genome.unmasked.bam monJX13F48.120.vs.D_montana.ref_genome.unmasked.MD.bam
samtools merge monJX13F48.vs.D_montana.ref_genome.unmasked.MD.bam monJX13F48.112.vs.D_montana.ref_genome.unmasked.MD.bam monJX13F48.120.vs.D_montana.ref_genome.unmasked.MD.bam && samtools index monJX13F48.vs.D_montana.ref_genome.unmasked.MD.bam
picard AddOrReplaceReadGroups I=monJX13F48.vs.D_montana.ref_genome.unmasked.MD.bam O=monJX13F48.vs.D_montana.ref_genome.unmasked.MD.rg.bam RGID=monJX13F48 RGLB=monJX13F48 RGPL=ILLUMINA RGPU=monJX13F48 RGSM=monJX13F48
samtools index monJX13F48.vs.D_montana.ref_genome.unmasked.MD.rg.bam

bwa mem -R "@RG\tID:monVAN14F1.112\tSM:monVAN14F1\tPL:ILLUMINA\tPU:monVAN14F1.112\tLB:monVAN14F1.112\tDS:monVAN14F1.112" -t 16 D_montana.ref_genome.unmasked.fa /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/monVAN14F1.112.1.trim.fq.gz /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/monVAN14F1.112.2.trim.fq.gz | samtools sort -@16 -T /scratch/npoikela/monVAN14F1.112.mapping.temp5 -o monVAN14F1.112.vs.D_montana.ref_genome.unmasked.bam
sambamba markdup --tmpdir=/scratch/npoikela/monVAN14F1.112.markdup.temp5 -t 16 monVAN14F1.112.vs.D_montana.ref_genome.unmasked.bam monVAN14F1.112.vs.D_montana.ref_genome.unmasked.MD.bam
bwa mem -R "@RG\tID:monVAN14F1.120\tSM:monVAN14F1\tPL:ILLUMINA\tPU:monVAN14F1.120\tLB:monVAN14F1.120\tDS:monVAN14F1.120" -t 16 D_montana.ref_genome.unmasked.fa /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/monVAN14F1.120.1.trim.fq.gz /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/monVAN14F1.120.2.trim.fq.gz | samtools sort -@16 -T /scratch/npoikela/monVAN14F1.120.mapping.temp5 -o monVAN14F1.120.vs.D_montana.ref_genome.unmasked.bam
sambamba markdup --tmpdir=/scratch/npoikela/monVAN14F1.120.markdup.temp5 -t 16 monVAN14F1.120.vs.D_montana.ref_genome.unmasked.bam monVAN14F1.120.vs.D_montana.ref_genome.unmasked.MD.bam
samtools merge monVAN14F1.vs.D_montana.ref_genome.unmasked.MD.bam monVAN14F1.112.vs.D_montana.ref_genome.unmasked.MD.bam monVAN14F1.120.vs.D_montana.ref_genome.unmasked.MD.bam && samtools index monVAN14F1.vs.D_montana.ref_genome.unmasked.MD.bam
picard AddOrReplaceReadGroups I=monVAN14F1.vs.D_montana.ref_genome.unmasked.MD.bam O=monVAN14F1.vs.D_montana.ref_genome.unmasked.MD.rg.bam RGID=monVAN14F1 RGLB=monVAN14F1 RGPL=ILLUMINA RGPU=monVAN14F1 RGSM=monVAN14F1
samtools index monVAN14F1.vs.D_montana.ref_genome.unmasked.MD.rg.bam

bwa mem -R "@RG\tID:fla3Fall\tSM:fla3Fall\tPL:ILLUMINA\tPU:fla3Fall\tLB:fla3Fall\tDS:fla3Fall" -t 16 D_montana.ref_genome.unmasked.fa /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/fla3Fall.1.trim.fq.gz /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/fla3Fall.2.trim.fq.gz | samtools sort -@16 -T /scratch/npoikela/fla3Fall.mapping.temp5 -o fla3Fall.vs.D_montana.ref_genome.unmasked.bam
sambamba markdup --tmpdir=/scratch/npoikela/fla3Fall.markdup.temp5 -t 16 fla3Fall.vs.D_montana.ref_genome.unmasked.bam fla3Fall.vs.D_montana.ref_genome.unmasked.MD.bam && samtools index fla3Fall.vs.D_montana.ref_genome.unmasked.MD.bam

bwa mem -R "@RG\tID:flaCRAN14F7\tSM:flaCRAN14F7\tPL:ILLUMINA\tPU:flaCRAN14F7\tLB:flaCRAN14F7\tDS:flaCRAN14F7" -t 16 D_montana.ref_genome.unmasked.fa /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/flaCRAN14F7.1.trim.fq.gz /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/flaCRAN14F7.2.trim.fq.gz | samtools sort -@16 -T /scratch/npoikela/flaCRAN14F7.mapping.temp5 -o flaCRAN14F7.vs.D_montana.ref_genome.unmasked.bam
sambamba markdup --tmpdir=/scratch/npoikela/flaCRAN14F7.markdup.temp5 -t 16 flaCRAN14F7.vs.D_montana.ref_genome.unmasked.bam flaCRAN14F7.vs.D_montana.ref_genome.unmasked.MD.bam && samtools index flaCRAN14F7.vs.D_montana.ref_genome.unmasked.MD.bam

bwa mem -R "@RG\tID:flaMB14F10\tSM:flaMB14F10\tPL:ILLUMINA\tPU:flaMB14F10\tLB:flaMB14F10\tDS:flaMB14F10" -t 16 D_montana.ref_genome.unmasked.fa /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/flaMB14F10.1.trim.fq.gz /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/flaMB14F10.2.trim.fq.gz | samtools sort -@16 -T /scratch/npoikela/flaMB14F10.mapping.temp5 -o flaMB14F10.vs.D_montana.ref_genome.unmasked.bam
sambamba markdup --tmpdir=/scratch/npoikela/flaMB14F10.markdup.temp5 -t 16 flaMB14F10.vs.D_montana.ref_genome.unmasked.bam flaMB14F10.vs.D_montana.ref_genome.unmasked.MD.bam && samtools index flaMB14F10.vs.D_montana.ref_genome.unmasked.MD.bam

bwa mem -R "@RG\tID:flaTER14F5\tSM:flaTER14F5\tPL:ILLUMINA\tPU:flaTER14F5\tLB:flaTER14F5\tDS:flaTER14F5" -t 16 D_montana.ref_genome.unmasked.fa /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/flaTER14F5.1.trim.fq.gz /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/flaTER14F5.2.trim.fq.gz | samtools sort -@16 -T /scratch/npoikela/flaTER14F5.mapping.temp5 -o flaTER14F5.vs.D_montana.ref_genome.unmasked.bam
sambamba markdup --tmpdir=/scratch/npoikela/flaTER14F5.markdup.temp5 -t 16 flaTER14F5.vs.D_montana.ref_genome.unmasked.bam flaTER14F5.vs.D_montana.ref_genome.unmasked.MD.bam && samtools index flaTER14F5.vs.D_montana.ref_genome.unmasked.MD.bam

bwa mem -R "@RG\tID:mon4Fall\tSM:mon4Fall\tPL:ILLUMINA\tPU:mon4Fall\tLB:mon4Fall\tDS:mon4Fall" -t 16 D_montana.ref_genome.unmasked.fa /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/mon4Fall.1.trim.fq.gz /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/mon4Fall.2.trim.fq.gz | samtools sort -@16 -T /scratch/npoikela/mon4Fall.mapping.temp5 -o mon4Fall.vs.D_montana.ref_genome.unmasked.bam
sambamba markdup --tmpdir=/scratch/npoikela/mon4Fall.markdup.temp5 -t 16 mon4Fall.vs.D_montana.ref_genome.unmasked.bam mon4Fall.vs.D_montana.ref_genome.unmasked.MD.bam && samtools index mon4Fall.vs.D_montana.ref_genome.unmasked.MD.bam

bwa mem -R "@RG\tID:monAZA2\tSM:monAZA2\tPL:ILLUMINA\tPU:monAZA2\tLB:monAZA2\tDS:monAZA2" -t 16 D_montana.ref_genome.unmasked.fa /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/monAZA2.1.trim.fq.gz /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/monAZA2.2.trim.fq.gz | samtools sort -@16 -T /scratch/npoikela/monAZA2.mapping.temp5 -o monAZA2.vs.D_montana.ref_genome.unmasked.bam
sambamba markdup --tmpdir=/scratch/npoikela/monAZA2.markdup.temp5 -t 16 monAZA2.vs.D_montana.ref_genome.unmasked.bam monAZA2.vs.D_montana.ref_genome.unmasked.MD.bam && samtools index monAZA2.vs.D_montana.ref_genome.unmasked.MD.bam

bwa mem -R "@RG\tID:monCRAN14F16\tSM:monCRAN14F16\tPL:ILLUMINA\tPU:monCRAN14F16\tLB:monCRAN14F16\tDS:monCRAN14F16" -t 16 D_montana.ref_genome.unmasked.fa /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/monCRAN14F16.1.trim.fq.gz /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/monCRAN14F16.2.trim.fq.gz | samtools sort -@16 -T /scratch/npoikela/monCRAN14F16.mapping.temp5 -o monCRAN14F16.vs.D_montana.ref_genome.unmasked.bam
sambamba markdup --tmpdir=/scratch/npoikela/monCRAN14F16.markdup.temp5 -t 16 monCRAN14F16.vs.D_montana.ref_genome.unmasked.bam monCRAN14F16.vs.D_montana.ref_genome.unmasked.MD.bam && samtools index monCRAN14F16.vs.D_montana.ref_genome.unmasked.MD.bam

bwa mem -R "@RG\tID:monFA13F2\tSM:monFA13F2\tPL:ILLUMINA\tPU:monFA13F2\tLB:monFA13F2\tDS:monFA13F2" -t 16 D_montana.ref_genome.unmasked.fa /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/monFA13F2.1.trim.fq.gz /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/monFA13F2.2.trim.fq.gz | samtools sort -@16 -T /scratch/npoikela/monFA13F2.mapping.temp5 -o monFA13F2.vs.D_montana.ref_genome.unmasked.bam
sambamba markdup --tmpdir=/scratch/npoikela/monFA13F2.markdup.temp5 -t 16 monFA13F2.vs.D_montana.ref_genome.unmasked.bam monFA13F2.vs.D_montana.ref_genome.unmasked.MD.bam && samtools index monFA13F2.vs.D_montana.ref_genome.unmasked.MD.bam

bwa mem -R "@RG\tID:monHO13F3\tSM:monHO13F3\tPL:ILLUMINA\tPU:monHO13F3\tLB:monHO13F3\tDS:monHO13F3" -t 16 D_montana.ref_genome.unmasked.fa /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/monHO13F3.1.trim.fq.gz /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/monHO13F3.2.trim.fq.gz | samtools sort -@16 -T /scratch/npoikela/monHO13F3.mapping.temp5 -o monHO13F3.vs.D_montana.ref_genome.unmasked.bam
sambamba markdup --tmpdir=/scratch/npoikela/monHO13F3.markdup.temp5 -t 16 monHO13F3.vs.D_montana.ref_genome.unmasked.bam monHO13F3.vs.D_montana.ref_genome.unmasked.MD.bam && samtools index monHO13F3.vs.D_montana.ref_genome.unmasked.MD.bam

bwa mem -R "@RG\tID:monMB14F1\tSM:monMB14F1\tPL:ILLUMINA\tPU:monMB14F1\tLB:monMB14F1\tDS:monMB14F1" -t 16 D_montana.ref_genome.unmasked.fa /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/monMB14F1.1.trim.fq.gz /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/monMB14F1.2.trim.fq.gz | samtools sort -@16 -T /scratch/npoikela/monMB14F1.mapping.temp5 -o monMB14F1.vs.D_montana.ref_genome.unmasked.bam
sambamba markdup --tmpdir=/scratch/npoikela/monMB14F1.markdup.temp5 -t 16 monMB14F1.vs.D_montana.ref_genome.unmasked.bam monMB14F1.vs.D_montana.ref_genome.unmasked.MD.bam && samtools index monMB14F1.vs.D_montana.ref_genome.unmasked.MD.bam

bwa mem -R "@RG\tID:monTER14F11\tSM:monTER14F11\tPL:ILLUMINA\tPU:monTER14F11\tLB:monTER14F11\tDS:monTER14F11" -t 16 D_montana.ref_genome.unmasked.fa /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/monTER14F11.1.trim.fq.gz /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/monTER14F11.2.trim.fq.gz | samtools sort -@16 -T /scratch/npoikela/monTER14F11.mapping.temp5 -o monTER14F11.vs.D_montana.ref_genome.unmasked.bam
sambamba markdup --tmpdir=/scratch/npoikela/monTER14F11.markdup.temp5 -t 16 monTER14F11.vs.D_montana.ref_genome.unmasked.bam monTER14F11.vs.D_montana.ref_genome.unmasked.MD.bam && samtools index monTER14F11.vs.D_montana.ref_genome.unmasked.MD.bam

bwa mem -R "@RG\tID:monSE13F37\tSM:monSE13F37\tPL:ILLUMINA\tPU:monSE13F37\tLB:monSE13F37\tDS:monSE13F37" -t 16 D_montana.ref_genome.unmasked.fa /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/monSE13F37.1.trim.fq.gz /ceph/users/npoikela/analyses/0_reads/trimmed_wildcaught/monSE13F37.2.trim.fq.gz | samtools sort -@16 -T /scratch/npoikela/monSE13F37.mapping.temp5 -o monSE13F37.vs.D_montana.ref_genome.unmasked.bam
sambamba markdup --hash-table-size=400000 --overflow-list-size=400000 --tmpdir=/scratch/npoikela/monSE13F37.markdup.temp5 -t 16 monSE13F37.vs.D_montana.ref_genome.unmasked.bam monSE13F37.vs.D_montana.ref_genome.unmasked.MD.bam && samtools index monSE13F37.vs.D_montana.ref_genome.unmasked.MD.bam

## Variant calling

fasta_generate_regions.py D_montana.ref_genome.unmasked.fa.fai 100000 > regions.txt
TMPDIR=freebayes_temp freebayes-parallel <(fasta_generate_regions.py D_montana.ref_genome.unmasked.fa.fai 100000) 30 -f D_montana.ref_genome.unmasked.fa --no-population-priors --hwe-priors-off --use-mapping-quality --ploidy 2 --theta 0.02 --haplotype-length -1 --use-best-n-alleles 2 --bam 1_mapping/monHO13F3.vs.D_montana.ref_genome.unmasked.MD.bam --bam 1_mapping/monFA13F2.vs.D_montana.ref_genome.unmasked.MD.bam --bam 1_mapping/monSE13F37.vs.D_montana.ref_genome.unmasked.MD.bam --bam 1_mapping/monTER14F11.vs.D_montana.ref_genome.unmasked.MD.bam --bam 1_mapping/monVAN14F1.vs.D_montana.ref_genome.unmasked.MD.rg.bam --bam 1_mapping/monASH13F13.vs.D_montana.ref_genome.unmasked.MD.rg.bam --bam 1_mapping/mon4Fall.vs.D_montana.ref_genome.unmasked.MD.bam --bam 1_mapping/monAZA2.vs.D_montana.ref_genome.unmasked.MD.bam --bam 1_mapping/monMB14F1.vs.D_montana.ref_genome.unmasked.MD.bam --bam 1_mapping/monCRAN14F16.vs.D_montana.ref_genome.unmasked.MD.bam --bam 1_mapping/monJX13F48.vs.D_montana.ref_genome.unmasked.MD.rg.bam --bam 1_mapping/monAF15F28.vs.D_montana.ref_genome.unmasked.MD.rg.bam --bam 1_mapping/flaTER14F5.vs.D_montana.ref_genome.unmasked.MD.bam --bam 1_mapping/flaVAN14F20.vs.D_montana.ref_genome.unmasked.MD.rg.bam --bam 1_mapping/flaASH13F2.vs.D_montana.ref_genome.unmasked.MD.rg.bam --bam 1_mapping/fla3Fall.vs.D_montana.ref_genome.unmasked.MD.bam --bam 1_mapping/flaMB14F10.vs.D_montana.ref_genome.unmasked.MD.bam --bam 1_mapping/flaCRAN14F7.vs.D_montana.ref_genome.unmasked.MD.bam --bam 1_mapping/flaMT13F11.vs.D_montana.ref_genome.unmasked.MD.rg.bam --bam 1_mapping/flaJX13F31.vs.D_montana.ref_genome.unmasked.MD.rg.bam --bam 1_mapping/flaLB15F3.vs.D_montana.ref_genome.unmasked.MD.rg.bam > 2_variant_calling/montana.flavomontana.vs.D_montana.ref_genome.unmasked.vcf


##############################################################################################################################################################################
## modify BED file

sconda myenv
conda install genometools-genometools
conda install -c conda-forge parallel

gt gff3 -sort -tidy -retainids -fixregionboundaries D_montana.ref_genome.braker.gff3 > D_montana.ref_genome.braker.gt.gff3

# generate BED file from braker GFF3
gff2bed < D_montana.ref_genome.braker.gt.gff3 > D_montana.ref_genome.braker.gt.bed

# generate BED file from repeatmasker GFF 
gff2bed < D_montana.ref_genome.unmasked.fa.out.gff > D_montana.ref_genome.repeatmasker.out.bed

# divide braker BED
awk '$8=="exon"' D_montana.ref_genome.braker.gt.bed > D_montana.ref_genome.braker.gt.exons.bed
awk '$8=="intron"' D_montana.ref_genome.braker.gt.bed > D_montana.ref_genome.braker.gt.introns.bed
awk '$8=="gene"' D_montana.ref_genome.braker.gt.bed > D_montana.ref_genome.braker.gt.genes.bed
awk '$8=="CDS"' D_montana.ref_genome.braker.gt.bed > D_montana.ref_genome.braker.gt.CDS.bed

# make genomefile (SEQID\tLENGTH)
samtools faidx D_montana.ref_genome.unmasked.fa
awk -v OFS='\t' {'print $1,$2'} D_montana.ref_genome.unmasked.fa.fai > D_montana.ref_genome.unmasked.fa.genomefile
sort -k1,1V -k2,2n D_montana.ref_genome.unmasked.fa.genomefile > D_montana.ref_genome.unmasked.fa.sorted.genomefile

# Merge BED file (neighbouring intervals are merged)
bedtools merge -i D_montana.ref_genome.repeatmasker.out.bed > D_montana.ref_genome.repeatmasker.merged.bed

# Merge intervals within other BED files
parallel -j1 'bedtools merge -i {} > {.}.merged.bed' ::: D_montana.ref_genome.braker.gt.genes.bed D_montana.ref_genome.braker.gt.exons.bed D_montana.ref_genome.braker.gt.introns.bed D_montana.ref_genome.braker.gt.CDS.bed

# Length of BED intervals 
for file in *.merged.bed; do echo -n $file " " && awk -F'\t' 'BEGIN{SUM=0}{ SUM+=$3-$2 }END{print SUM}' $file; done

D_montana.ref_genome.braker.gt.CDS.merged.bed  20920951
D_montana.ref_genome.braker.gt.exons.merged.bed  20920951
D_montana.ref_genome.braker.gt.genes.merged.bed  61039096
D_montana.ref_genome.braker.gt.introns.merged.bed  40246990
D_montana.ref_genome.repeatmasker.merged.bed  24462290

# Complement repeat BED
bedtools complement -i D_montana.ref_genome.repeatmasker.merged.bed -g D_montana.ref_genome.unmasked.fa.sorted.genomefile > D_montana.ref_genome.non_repeats.bed

# non-repeat + CDS, non-repeat + genic or non-repear + introns
bedtools intersect -a D_montana.ref_genome.braker.gt.CDS.bed -b D_montana.ref_genome.non_repeats.bed > D_montana.ref_genome.non_repeats.CDS.bed
bedtools intersect -a D_montana.ref_genome.braker.gt.genes.bed -b D_montana.ref_genome.non_repeats.bed > D_montana.ref_genome.non_repeats.genic.bed
bedtools intersect -a D_montana.ref_genome.braker.gt.introns.bed -b D_montana.ref_genome.non_repeats.bed > D_montana.ref_genome.non_repeats.introns.bed
sort -k1,1V -k2,2n D_montana.ref_genome.non_repeats.CDS.bed | cut -f1,2,3 > D_montana.ref_genome.non_repeats.CDS.sorted.bed
sort -k1,1V -k2,2n D_montana.ref_genome.non_repeats.genic.bed | cut -f1,2,3 > D_montana.ref_genome.non_repeats.genic.sorted.bed
sort -k1,1V -k2,2n D_montana.ref_genome.non_repeats.introns.bed | cut -f1,2,3 > D_montana.ref_genome.non_repeats.introns.sorted.bed

# Merge intervals
bedtools merge -i D_montana.ref_genome.non_repeats.CDS.sorted.bed > D_montana.ref_genome.non_repeats.CDS.sorted.merged.bed
bedtools merge -i D_montana.ref_genome.non_repeats.genic.sorted.bed > D_montana.ref_genome.non_repeats.genic.sorted.merged.bed
bedtools merge -i D_montana.ref_genome.non_repeats.introns.sorted.bed > D_montana.ref_genome.non_repeats.introns.sorted.merged.bed

# create intergenic BED
bedtools complement -i D_montana.ref_genome.braker.gt.genes.bed -g D_montana.ref_genome.unmasked.fa.sorted.genomefile > D_montana.ref_genome.braker.gt.intergenic.bed

# non-repeat + intergenic
bedtools intersect -a D_montana.ref_genome.braker.gt.intergenic.bed -b D_montana.ref_genome.non_repeats.bed > D_montana.ref_genome.non_repeats.intergenic.bed
sort -k1,1V -k2,2n D_montana.ref_genome.non_repeats.intergenic.bed > D_montana.ref_genome.non_repeats.intergenic.sorted.bed

##############################################################################################################################################################################

## gIMble v0.7.1

# https://github.com/LohseLab/gIMble

# gimble preprocess
gIMble/./gIMble preprocess -f D_montana.ref_genome.unmasked.fa -v 2_variant_calling/montana.flavomontana.vs.D_montana.ref_genome.unmasked.vcf.gz -b 1_mapping/ -g 2 -m 8 -M 2 -t 16 -o /scratch/npoikela/gimble2

[=] ========================================================================================================
                                                 bam_f read_group_id  cov_mean  cov_sd  depth_min  depth_max
   monTER14F11.vs.D_montana.ref_genome.unmasked.MD.bam   monTER14F11     68.33  220.06          8        136
     monMB14F1.vs.D_montana.ref_genome.unmasked.MD.bam     monMB14F1     54.11  222.93          8        108
  monCRAN14F16.vs.D_montana.ref_genome.unmasked.MD.bam  monCRAN14F16     76.78  259.28          8        152
  flaLB15F3.vs.D_montana.ref_genome.unmasked.MD.rg.bam     flaLB15F3     98.74  875.02          8        196
 monAF15F28.vs.D_montana.ref_genome.unmasked.MD.rg.bam    monAF15F28     87.92  210.53          8        174
    flaMB14F10.vs.D_montana.ref_genome.unmasked.MD.bam    flaMB14F10     67.94  642.73          8        134
   flaCRAN14F7.vs.D_montana.ref_genome.unmasked.MD.bam   flaCRAN14F7     67.87  553.03          8        134
 flaASH13F2.vs.D_montana.ref_genome.unmasked.MD.rg.bam    flaASH13F2     58.06  926.86          8        116
 flaJX13F31.vs.D_montana.ref_genome.unmasked.MD.rg.bam    flaJX13F31    106.84 1054.83          8        212
      fla3Fall.vs.D_montana.ref_genome.unmasked.MD.bam      fla3Fall     70.33  673.49          8        140
 monVAN14F1.vs.D_montana.ref_genome.unmasked.MD.rg.bam    monVAN14F1     71.50  205.57          8        142
    monSE13F37.vs.D_montana.ref_genome.unmasked.MD.bam    monSE13F37    449.12 1226.87          8        898
       monAZA2.vs.D_montana.ref_genome.unmasked.MD.bam       monAZA2     72.18  265.50          8        144
    flaTER14F5.vs.D_montana.ref_genome.unmasked.MD.bam    flaTER14F5     69.02  670.61          8        138
     monHO13F3.vs.D_montana.ref_genome.unmasked.MD.bam     monHO13F3     74.41  213.77          8        148
      mon4Fall.vs.D_montana.ref_genome.unmasked.MD.bam      mon4Fall     83.77  281.61          8        166
 flaMT13F11.vs.D_montana.ref_genome.unmasked.MD.rg.bam    flaMT13F11     73.15  754.04          8        146
     monFA13F2.vs.D_montana.ref_genome.unmasked.MD.bam     monFA13F2     81.75  268.97          8        162
 monJX13F48.vs.D_montana.ref_genome.unmasked.MD.rg.bam    monJX13F48     85.27  261.07          8        170
flaVAN14F20.vs.D_montana.ref_genome.unmasked.MD.rg.bam   flaVAN14F20     88.63  564.95          8        176
monASH13F13.vs.D_montana.ref_genome.unmasked.MD.rg.bam   monASH13F13     98.04  238.96          8        196
[=] ========================================================================================================


## Genomic PCA using plink
# http://zzz.bwh.harvard.edu/plink/thresh.shtml

## All samples
# remove missing genotypes
sed '/\.\/\./d' gimble2.vcf > gimble2.callable.vcf

# number of snps
wc -l gimble2.callable.vcf
9102309

# plink
plink --vcf gimble2.callable.vcf --double-id --allow-extra-chr --indep-pairwise 50 10 0.1 --out gimble2.montana_flavomontana
plink --vcf gimble2.callable.vcf --double-id --allow-extra-chr --make-bed --pca 'header' 'tabs' --out gimble2.montana_flavomontana


## gIMble continues
# sample file: manually add population IDs (sample_id, population_id)

nano gimble.samples.montana.flavomontana.sympatric.csv
# mon vs fla
fla3Fall,flavomontana
flaASH13F2,flavomontana
flaCRAN14F7,flavomontana
flaJX13F31,flavomontana
flaLB15F3,flavomontana
flaMB14F10,flavomontana
flaMT13F11,flavomontana
flaTER14F5,flavomontana
flaVAN14F20,flavomontana
mon4Fall,montana
monAF15F28,montana
monASH13F13,montana
monAZA2,montana
monCRAN14F16,montana
monJX13F48,montana
monMB14F1,montana
monTER14F11,montana
monVAN14F1,montana

nano gimble.samples.montana.flavomontana.allopatric.csv
fla3Fall,flavomontana
flaASH13F2,flavomontana
flaCRAN14F7,flavomontana
flaJX13F31,flavomontana
flaLB15F3,flavomontana
flaMB14F10,flavomontana
flaMT13F11,flavomontana
flaTER14F5,flavomontana
flaVAN14F20,flavomontana
monFA13F2,montana
monHO13F3,montana
monSE13F37,montana

nano gimble.samples.montana.allopatric.sympatric.csv
# intraspecific
mon4Fall,sympatry
monAF15F28,sympatry
monASH13F13,sympatry
monAZA2,sympatry
monCRAN14F16,sympatry
monJX13F48,sympatry
monMB14F1,sympatry
monTER14F11,sympatry
monVAN14F1,sympatry
monFA13F2,allopatry
monHO13F3,allopatry
monSE13F37,allopatry


## Model selection

# modify bed file

bedtools intersect -a gimble2.bed -b D_montana.ref_genome.non_repeats.intergenic.sorted.bed > gimble2.D_montana.ref_genome.non_repeats.intergenic.bed
sort -k1,1V -k2,2n gimble2.D_montana.ref_genome.non_repeats.intergenic.bed > gimble2.D_montana.ref_genome.non_repeats.intergenic.sorted.bed

bedtools intersect -a gimble2.D_montana.ref_genome.non_repeats.intergenic.sorted.bed -b autosomes_collinear.bed > gimble2.D_montana.ref_genome.non_repeats.intergenic.autosomes_collinear.bed
sort -k1,1V -k2,2n gimble2.D_montana.ref_genome.non_repeats.intergenic.autosomes_collinear.bed > gimble2.D_montana.ref_genome.non_repeats.intergenic.autosomes_collinear.sorted.bed

# create zarr storage
gIMble/./gIMble measure -f -g gimble2.autosomes.genomefile -b gimble2.D_montana.ref_genome.non_repeats.intergenic.autosomes_collinear.sorted.bed -s gimble2.samples.montana.flavomontana.sympatric.csv -v gimble2.vcf.gz -z /scratch/npoikela/2montana.flavomontana.sympatric.intergenic.autosomes_collinear.64bp
gIMble/./gIMble measure -f -g gimble2.autosomes.genomefile -b gimble2.D_montana.ref_genome.non_repeats.intergenic.autosomes_collinear.sorted.bed -s gimble2.samples.montana.flavomontana.allopatric.csv -v gimble2.vcf.gz -z /scratch/npoikela/2montana.flavomontana.allopatric.intergenic.autosomes_collinear.64bp
gIMble/./gIMble measure -f -g gimble2.autosomes.genomefile -b gimble2.D_montana.ref_genome.non_repeats.intergenic.autosomes_collinear.sorted.bed -s gimble2.samples.montana.allopatric.sympatric.csv -v gimble2.vcf.gz -z /scratch/npoikela/2montana.allopatric.sympatric.intergenic.autosomes_collinear.64bp

## blocks (64 bp)
gIMble/./gIMble blocks -z /scratch/npoikela/2montana.flavomontana.sympatric.intergenic.autosomes_collinear.64bp.z -l 64 -f
gIMble/./gIMble blocks -z /scratch/npoikela/2montana.flavomontana.allopatric.intergenic.autosomes_collinear.64bp.z -l 64 -f
gIMble/./gIMble blocks -z /scratch/npoikela/2montana.allopatric.sympatric.intergenic.autosomes_collinear.64bp.z -l 64 -f

## Tally
## Sympatric comparisons
gIMble/./gIMble tally -z /scratch/npoikela/2montana.flavomontana.sympatric.intergenic.autosomes_collinear.64bp.z -d blocks -l sympatric.intergenic.autosomes_collinear.64bp.kmax2.DIV_model1 -k 2,2,2,2 -S gimble2.autosomes.genomefile
[%] Preparing data...: 100%|██████████████████████████████████████| 405/405 [00:00<00:00, 13.3kit/s]
[+] Found 44,460,704 blocks on 5 sequence(s).
[+] Percentage of blocks treated as marginals (w/ kmax = [2 2 2 2]) = 26.24%
[+] Tally'ing variation data ...
[+] Tally saved under label 'sympatric.intergenic.autosomes_collinear.64bp.kmax2.DIV_model1' (use this for optimize/gridsearch).
[+] Tally is accessible with the key 'tally/sympatric.intergenic.autosomes_collinear.64bp.kmax2.DIV_model1' (use this for query).
[*] Total runtime was 00h:01m:11.462s

gIMble/./gIMble tally -z /scratch/npoikela/2montana.flavomontana.sympatric.intergenic.autosomes_collinear.64bp.z -d blocks -l sympatric.intergenic.autosomes_collinear.64bp.kmax2.IM_AB_model4 -k 2,2,2,2 -S gimble2.autosomes.genomefile
[%] Preparing data...: 100%|██████████████████████████████████████| 405/405 [00:00<00:00, 12.6kit/s]
[+] Found 44,460,704 blocks on 5 sequence(s).
[+] Percentage of blocks treated as marginals (w/ kmax = [2 2 2 2]) = 26.24%
[+] Tally'ing variation data ...
[+] Tally saved under label 'sympatric.intergenic.autosomes_collinear.64bp.kmax2.IM_AB_model4' (use this for optimize/gridsearch).
[+] Tally is accessible with the key 'tally/sympatric.intergenic.autosomes_collinear.64bp.kmax2.IM_AB_model4' (use this for query).
[*] Total runtime was 00h:01m:10.458s

gIMble/./gIMble tally -z /scratch/npoikela/2montana.flavomontana.sympatric.intergenic.autosomes_collinear.64bp.z -d blocks -l sympatric.intergenic.autosomes_collinear.64bp.kmax2.IM_BA_model5 -k 2,2,2,2 -S gimble2.autosomes.genomefile
[%] Preparing data...: 100%|██████████████████████████████████████| 405/405 [00:00<00:00, 13.1kit/s]
[+] Found 44,460,704 blocks on 5 sequence(s).
[+] Percentage of blocks treated as marginals (w/ kmax = [2 2 2 2]) = 26.24%
[+] Tally'ing variation data ...
[+] Tally saved under label 'sympatric.intergenic.autosomes_collinear.64bp.kmax2.IM_BA_model5' (use this for optimize/gridsearch).
[+] Tally is accessible with the key 'tally/sympatric.intergenic.autosomes_collinear.64bp.kmax2.IM_BA_model5' (use this for query).
[*] Total runtime was 00h:01m:07.583s



## Allopatric comparisons
gIMble/./gIMble tally -z /scratch/npoikela/2montana.flavomontana.allopatric.intergenic.autosomes_collinear.64bp.z -d blocks -l allopatric.intergenic.autosomes_collinear.64bp.kmax2.DIV_model1 -k 2,2,2,2 -S gimble2.autosomes.genomefile
[%] Preparing data...: 100%|██████████████████████████████████████| 135/135 [00:00<00:00, 12.2kit/s]
[+] Found 14,883,686 blocks on 5 sequence(s).
[+] Percentage of blocks treated as marginals (w/ kmax = [2 2 2 2]) = 26.47%
[+] Tally'ing variation data ...
[+] Tally saved under label 'allopatric.intergenic.autosomes_collinear.64bp.kmax2.DIV_model1' (use this for optimize/gridsearch).
[+] Tally is accessible with the key 'tally/allopatric.intergenic.autosomes_collinear.64bp.kmax2.DIV_model1' (use this for query).
[*] Total runtime was 00h:00m:23.604s

gIMble/./gIMble tally -z /scratch/npoikela/2montana.flavomontana.allopatric.intergenic.autosomes_collinear.64bp.z -d blocks -l allopatric.intergenic.autosomes_collinear.64bp.kmax2.IM_AB_model4 -k 2,2,2,2 -S gimble2.autosomes.genomefile
[%] Preparing data...: 100%|██████████████████████████████████████| 135/135 [00:00<00:00, 8.32kit/s]
[+] Found 14,883,686 blocks on 5 sequence(s).
[+] Percentage of blocks treated as marginals (w/ kmax = [2 2 2 2]) = 26.47%
[+] Tally'ing variation data ...
[+] Tally saved under label 'allopatric.intergenic.autosomes_collinear.64bp.kmax2.IM_AB_model4' (use this for optimize/gridsearch).
[+] Tally is accessible with the key 'tally/allopatric.intergenic.autosomes_collinear.64bp.kmax2.IM_AB_model4' (use this for query).
[*] Total runtime was 00h:00m:21.844s

gIMble/./gIMble tally -z /scratch/npoikela/2montana.flavomontana.allopatric.intergenic.autosomes_collinear.64bp.z -d blocks -l allopatric.intergenic.autosomes_collinear.64bp.kmax2.IM_BA_model5 -k 2,2,2,2 -S gimble2.autosomes.genomefile
[%] Preparing data...: 100%|██████████████████████████████████████| 135/135 [00:00<00:00, 7.28kit/s]
[+] Found 14,883,686 blocks on 5 sequence(s).
[+] Percentage of blocks treated as marginals (w/ kmax = [2 2 2 2]) = 26.47%
[+] Tally'ing variation data ...
[+] Tally saved under label 'allopatric.intergenic.autosomes_collinear.64bp.kmax2.IM_BA_model5' (use this for optimize/gridsearch).
[+] Tally is accessible with the key 'tally/allopatric.intergenic.autosomes_collinear.64bp.kmax2.IM_BA_model5' (use this for query).
[*] Total runtime was 00h:00m:21.604s



## Intraspecific comparisons
# third separate ancestral population
gIMble/./gIMble tally -z /scratch/npoikela/2montana.allopatric.sympatric.intergenic.autosomes_collinear.64bp.z -d blocks -l intraspecific.intergenic.autosomes_collinear.64bp.kmax2.DIV_model1 -k 2,2,2,2 -S gimble2.autosomes.genomefile
[%] Preparing data...: 100%|██████████████████████████████████████| 135/135 [00:00<00:00, 12.2kit/s]
[+] Found 15,544,363 blocks on 5 sequence(s).
[+] Percentage of blocks treated as marginals (w/ kmax = [2 2 2 2]) = 9.76%
[+] Tally'ing variation data ...
[+] Tally saved under label 'intraspecific.intergenic.autosomes_collinear.64bp.kmax2.DIV_model1' (use this for optimize/gridsearch).
[+] Tally is accessible with the key 'tally/intraspecific.intergenic.autosomes_collinear.64bp.kmax2.DIV_model1' (use this for query).
[*] Total runtime was 00h:00m:23.640s

gIMble/./gIMble tally -z /scratch/npoikela/2montana.allopatric.sympatric.intergenic.autosomes_collinear.64bp.z -d blocks -l intraspecific.intergenic.autosomes_collinear.64bp.kmax2.IM_AB_model4 -k 2,2,2,2 -S gimble2.autosomes.genomefile
[%] Preparing data...: 100%|██████████████████████████████████████| 135/135 [00:00<00:00, 8.33kit/s]
[+] Found 15,544,363 blocks on 5 sequence(s).
[+] Percentage of blocks treated as marginals (w/ kmax = [2 2 2 2]) = 9.76%
[+] Tally'ing variation data ...
[+] Tally saved under label 'intraspecific.intergenic.autosomes_collinear.64bp.kmax2.IM_AB_model4' (use this for optimize/gridsearch).
[+] Tally is accessible with the key 'tally/intraspecific.intergenic.autosomes_collinear.64bp.kmax2.IM_AB_model4' (use this for query).
[*] Total runtime was 00h:00m:23.002s

gIMble/./gIMble tally -z /scratch/npoikela/2montana.allopatric.sympatric.intergenic.autosomes_collinear.64bp.z -d blocks -l intraspecific.intergenic.autosomes_collinear.64bp.kmax2.IM_BA_model5 -k 2,2,2,2 -S gimble2.autosomes.genomefile
[%] Preparing data...: 100%|██████████████████████████████████████| 135/135 [00:00<00:00, 7.43kit/s]
[+] Found 15,544,363 blocks on 5 sequence(s).
[+] Percentage of blocks treated as marginals (w/ kmax = [2 2 2 2]) = 9.76%
[+] Tally'ing variation data ...
[+] Tally saved under label 'intraspecific.intergenic.autosomes_collinear.64bp.kmax2.IM_BA_model5' (use this for optimize/gridsearch).
[+] Tally is accessible with the key 'tally/intraspecific.intergenic.autosomes_collinear.64bp.kmax2.IM_BA_model5' (use this for query).
[*] Total runtime was 00h:00m:22.702s




## Create config files
# mu = 2.8e-9
gIMble/./gIMble makeconfig -l sympatric.intergenic.autosomes_collinear.64bp.kmax2.model1 -t optimize -m 1
[+] Wrote INI file 'gimble.optimize.DIV.sympatric.intergenic.autosomes_collinear.64bp.kmax2.model1.config.ini'. Please fill in values before starting 'optimize'.
[*] Total runtime was 00h:00m:00.005s

[parameters]
# Model parameters and their values/ranges:
# A) Fixed : value
# B) Range : min, max
# Effective population size of A
Ne_A = 200000, 500000
# Effective population size of B
Ne_B = 500000, 1000000
# Effective population size of A_B
Ne_A_B = 800000, 1700000
# Split time (in generations)
T = 1500000, 3000000

gIMble/./gIMble makeconfig -l allopatric.intergenic.autosomes_collinear.64bp.kmax2.model1 -t optimize -m 1
[+] Wrote INI file 'gimble.optimize.DIV.allopatric.intergenic.autosomes_collinear.64bp.kmax2.model1.config.ini'. Please fill in values before starting 'optimize'.
[*] Total runtime was 00h:00m:00.004s

[parameters]
# Model parameters and their values/ranges:
# A) Fixed : value
# B) Range : min, max
# Effective population size of A
Ne_A = 200000, 500000
# Effective population size of B
Ne_B = 500000, 1000000
# Effective population size of A_B
Ne_A_B = 800000, 1700000
# Split time (in generations)
T = 1500000, 4000000

gIMble/./gIMble makeconfig -l intraspecific.intergenic.autosomes_collinear.64bp.kmax2.model1 -t optimize -m 1
[+] Wrote INI file 'gimble.optimize.DIV.intraspecific.intergenic.autosomes_collinear.64bp.kmax2.model1.config.ini'. Please fill in values before starting 'optimize'.
[*] Total runtime was 00h:00m:00.004s

[parameters]
# Model parameters and their values/ranges:
# A) Fixed : value
# B) Range : min, max
# Effective population size of A
Ne_A = 500000, 1900000
# Effective population size of B
Ne_B = 900000, 2500000
# Effective population size of A_B
Ne_A_B = 300000, 1500000
# Split time (in generations)
T = 100000, 500000


# mu = 2.8e-9
gIMble/./gIMble makeconfig -l sympatric.intergenic.autosomes_collinear.64bp.kmax2.model4 -t optimize -m 4
[+] Wrote INI file 'gimble.optimize.IM_AB.sympatric.intergenic.autosomes_collinear.64bp.kmax2.model4.config.ini'. Please fill in values before starting 'optimize'.
[*] Total runtime was 00h:00m:00.005s

[parameters]
# Model parameters and their values/ranges:
# A) Fixed : value
# B) Range : min, max
# Effective population size of A
Ne_A = 200000, 500000
# Effective population size of B
Ne_B = 500000, 1000000
# Effective population size of A_B
Ne_A_B = 200000, 1700000
# Split time (in generations)
T = 2000000, 3500000
# Migration rate (migrants/generation) from A to B (backwards in time)
me = 1e-18, 1e-07

gIMble/./gIMble makeconfig -l allopatric.intergenic.autosomes_collinear.64bp.kmax2.model4 -t optimize -m 4
[+] Wrote INI file 'gimble.optimize.IM_AB.allopatric.intergenic.autosomes_collinear.64bp.kmax2.model4.config.ini'. Please fill in values before starting 'optimize'.
[*] Total runtime was 00h:00m:00.027s

[parameters]
# Model parameters and their values/ranges:
# A) Fixed : value
# B) Range : min, max
# Effective population size of A
Ne_A = 200000, 500000
# Effective population size of B
Ne_B = 500000, 1000000
# Effective population size of A_B
Ne_A_B = 200000, 1700000
# Split time (in generations)
T = 2000000, 3500000
# Migration rate (migrants/generation) from A to B (backwards in time)
me = 1e-18, 1e-07

gIMble/./gIMble makeconfig -l intraspecific.intergenic.autosomes_collinear.64bp.kmax2.model4 -t optimize -m 4
[+] Wrote INI file 'gimble.optimize.IM_AB.intraspecific.intergenic.autosomes_collinear.64bp.kmax2.model4.config.ini'. Please fill in values before starting 'optimize'.
[*] Total runtime was 00h:00m:00.004s

[parameters]
# Model parameters and their values/ranges:
# A) Fixed : value
# B) Range : min, max
# Effective population size of A
Ne_A = 400000, 1500000
# Effective population size of B
Ne_B = 1300000, 2500000
# Effective population size of A_B
Ne_A_B = 300000, 1100000
# Split time (in generations)
T = 50000, 500000
# Migration rate (migrants/generation) from A to B (backwards in time)
me = 1e-16, 1e-05


# mu = 2.8e-9
gIMble/./gIMble makeconfig -l sympatric.intergenic.autosomes_collinear.64bp.kmax2.model5 -t optimize -m 5
[+] Wrote INI file 'gimble.optimize.IM_BA.sympatric.intergenic.autosomes_collinear.64bp.kmax2.model5.config.ini'. Please fill in values before starting 'optimize'.
[*] Total runtime was 00h:00m:00.004s

[parameters]
# Model parameters and their values/ranges:
# A) Fixed : value
# B) Range : min, max
# Effective population size of A
Ne_A = 200000, 500000
# Effective population size of B
Ne_B = 500000, 900000
# Effective population size of A_B
Ne_A_B = 500000, 1700000
# Split time (in generations)
T = 1800000, 3500000
# Migration rate (migrants/generation) from B to A (backwards in time)
me = 1e-18, 1e-7

gIMble/./gIMble makeconfig -l allopatric.intergenic.autosomes_collinear.64bp.kmax2.model5 -t optimize -m 5
[+] Wrote INI file 'gimble.optimize.IM_BA.allopatric.intergenic.autosomes_collinear.64bp.kmax2.model5.config.ini'. Please fill in values before starting 'optimize'.
[*] Total runtime was 00h:00m:00.005s

[parameters]
# Model parameters and their values/ranges:
# A) Fixed : value
# B) Range : min, max
# Effective population size of A
Ne_A = 200000, 500000
# Effective population size of B
Ne_B = 500000, 900000
# Effective population size of A_B
Ne_A_B = 500000, 1700000
# Split time (in generations)
T = 1800000, 3500000
# Migration rate (migrants/generation) from B to A (backwards in time)
me = 1e-18, 1e-7

gIMble/./gIMble makeconfig -l intraspecific.intergenic.autosomes_collinear.64bp.kmax2.model5 -t optimize -m 5
[+] Wrote INI file 'gimble.optimize.IM_BA.intraspecific.intergenic.autosomes_collinear.64bp.kmax2.model5.config.ini'. Please fill in values before starting 'optimize'.
[*] Total runtime was 00h:00m:00.004s

[parameters]
# Model parameters and their values/ranges:
# A) Fixed : value
# B) Range : min, max
# Effective population size of A
Ne_A = 400000, 2200000
# Effective population size of B
Ne_B = 600000, 3200000
# Effective population size of A_B
Ne_A_B = 200000, 1200000
# Split time (in generations)
T = 100000, 1500000
# Migration rate (migrants/generation) from B to A (backwards in time)
me = 1e-14, 1e-04



######################################################################################################################################################################################
#### OPTIMIZE DATA ####

## Strict divergence (DIV) model
# A = flavomontana, B = montana
gIMble/./gIMble optimize -z /scratch/npoikela/2montana.flavomontana.sympatric.intergenic.autosomes_collinear.64bp.z -c gimble.optimize.DIV.sympatric.intergenic.autosomes_collinear.64bp.kmax2.model1.config.ini -t sympatric.intergenic.autosomes_collinear.64bp.kmax2.DIV_model1 -i 1000 --xtol 0.000000000000001 --ftol 0.000000000000001 -f

results: gimble.optimize.sympatric.intergenic.autosomes_collinear.64bp.kmax2.model1.0.20221220_203513.log

dataset_idx,iteration,block_length,likelihood,Ne_A_unscaled,Ne_B_unscaled,Ne_A_B_unscaled,T_unscaled,Ne_A_scaled,Ne_B_scaled,Ne_A_B_scaled,T_scaled
0,205,64,-136875658.94552153,1.0,0.545032259955938,0.26895262104151263,2.985902983013366,392311.364372064,719794.7593116409,1458663.4733390869,2342807.346297179
0,206,64,-136875658.9455218,1.0,0.5450322527644816,0.26895263228309724,2.985903303538381,392311.35945006215,719794.7597783485,1458663.3940697727,2342807.5683951476
0,207,64,-136875658.94552153,1.0,0.5450322309607343,0.2689525865810886,2.985902842773494,392311.35464964295,719794.7797657974,1458663.6240858831,2342807.1782013783
0,208,64,-136875658.94552177,1.0,0.5450323117755225,0.2689526017076558,2.985902669745468,392311.37772161514,719794.7153694492,1458663.6278315203,2342807.1802209867
0,209,64,-136875658.9455216,1.0,0.5450322180249548,0.26895259803344784,2.985903039618803,392311.3504817896,719794.7892024014,1458663.546477437,2342807.307761066

# A = flavomontana, B = montana
gIMble/./gIMble optimize -z /scratch/npoikela/2montana.flavomontana.allopatric.intergenic.autosomes_collinear.64bp.z -c gimble.optimize.DIV.allopatric.intergenic.autosomes_collinear.64bp.kmax2.model1.config.ini -t allopatric.intergenic.autosomes_collinear.64bp.kmax2.DIV_model1 -i 1000 --xtol 0.000000000000001 --ftol 0.000000000000001 -f

results: gimble.optimize.allopatric.intergenic.autosomes_collinear.64bp.kmax2.model1.0.20221220_203756.log

dataset_idx,iteration,block_length,likelihood,Ne_A_unscaled,Ne_B_unscaled,Ne_A_B_unscaled,T_unscaled,Ne_A_scaled,Ne_B_scaled,Ne_A_B_scaled,T_scaled
0,256,64,-45651204.71039195,1.0,0.5706751650484152,0.2699210133874017,3.0089465220406573,395249.6788906297,692600.1043993167,1464316.0750265527,2378570.2932712934
0,257,64,-45651204.71039195,1.0,0.5706751620825466,0.2699210141747716,3.0089465205451886,395249.67823022336,692600.1068416073,1464316.0683084219,2378570.288114872
0,258,64,-45651204.7103919,1.0,0.5706751628100519,0.26992101395630363,3.00894652365345,395249.67836507986,692600.1061949807,1464316.069993221,2378570.2913835025
0,259,64,-45651204.71039195,1.0,0.5706751609075178,0.26992101437272054,3.008946532289162,395249.67784646817,692600.1075952232,1464316.0658128215,2378570.2950890777
0,260,64,-45651204.71039191,1.0,0.5706751640131908,0.2699210136337314,3.0089465246027833,395249.67862958927,692600.1051982933,1464316.07272312,2378570.2937257392


# A = allopatry, B = sympatry
gIMble/./gIMble optimize -z /scratch/npoikela/2montana.allopatric.sympatric.intergenic.autosomes_collinear.64bp.z -c gimble.optimize.DIV.intraspecific.intergenic.autosomes_collinear.64bp.kmax2.model1.config.ini -t intraspecific.intergenic.autosomes_collinear.64bp.kmax2.DIV_model1 -i 1000 --xtol 0.000000000000001 --ftol 0.000000000000001 -f

results: gimble.optimize.intraspecific.intergenic.autosomes_collinear.64bp.kmax2.model1.0.20230118_101235.log

dataset_idx,iteration,block_length,likelihood,Ne_A_unscaled,Ne_B_unscaled,Ne_A_B_unscaled,T_unscaled,Ne_A_scaled,Ne_B_scaled,Ne_A_B_scaled,T_scaled
0,432,64,-39887381.71762067,1.0,0.6963276851670493,1.26567855722928,0.09648041426856205,1086549.1698983847,1560399.210089889,858471.6582992205,209661.42806991673
0,433,64,-39887381.71762057,1.0,0.6963276851667716,1.2656785572274485,0.09648041426858459,1086549.1698970064,1560399.210088532,858471.6582993737,209661.42806969973
0,434,64,-39887381.71762059,1.0,0.6963276851662159,1.265678557223785,0.09648041426862972,1086549.1698942492,1560399.2100858176,858471.6582996801,209661.4280692658
0,435,64,-39887381.717621274,1.0,0.6963276851666327,1.2656785572265326,0.09648041426859585,1086549.1698963172,1560399.2100878535,858471.6582994503,209661.42806959123
0,436,64,-39887381.71762082,1.0,0.6963276851666511,1.2656785572262605,0.09648041426855448,1086549.1698961125,1560399.2100875182,858471.6582994731,209661.42806946186



## 4th model; Isolation with migration, gene flow from D. montana (B) to D. flavomontana (A)
## 4th model; Isolation with migration, gene flow from sympatry (B) to allopatry (A)

gIMble/./gIMble optimize -z /scratch/npoikela/2montana.flavomontana.sympatric.intergenic.autosomes_collinear.64bp.z -c gimble.optimize.IM_AB.sympatric.intergenic.autosomes_collinear.64bp.kmax2.model4.config.ini -t sympatric.intergenic.autosomes_collinear.64bp.kmax2.IM_AB_model4 -i 1000 --xtol 0.00000000000000001 --ftol 0.00000000000000001 -f -n 30

results: gimble.optimize.sympatric.intergenic.autosomes_collinear.64bp.kmax2.model4.0.20221221_180636.log

dataset_idx,iteration,block_length,likelihood,Ne_A_unscaled,Ne_B_unscaled,Ne_A_B_unscaled,T_unscaled,me_unscaled,Ne_A_scaled,Ne_B_scaled,Ne_A_B_scaled,T_scaled,me_scaled
0,489,64,-136827868.9880551,1.0,0.5126339214043363,0.2716157560044848,3.350901045377642,0.00972863874964794,376922.98455979466,735267.3493147548,1387706.6268334268,2526063.2459765533,1.2905340279274745e-08
0,490,64,-136827868.98805523,1.0,0.512633921404346,0.2716157560045253,3.3509010453776926,0.009728638749654137,376922.9845598217,735267.3493147935,1387706.6268333192,2526063.245976773,1.2905340279282037e-08
0,491,64,-136827868.9880553,1.0,0.5126339214042915,0.2716157560042998,3.3509010453780403,0.009728638749630645,376922.9845596689,735267.3493145737,1387706.6268339087,2526063.2459760113,1.2905340279256107e-08
0,492,64,-136827868.98805517,1.0,0.5126339214043814,0.27161575600464316,3.3509010453775803,0.009728638749664831,376922.98455989873,735267.3493148931,1387706.6268330007,2526063.2459772043,1.2905340279293588e-08
0,493,64,-136827868.98805523,1.0,0.5126339214043408,0.27161575600446486,3.3509010453778822,0.009728638749645621,376922.9845597768,735267.3493147134,1387706.6268334626,2526063.2459766148,1.290534027927228e-08


gIMble/./gIMble optimize -z /scratch/npoikela/2montana.flavomontana.allopatric.intergenic.autosomes_collinear.64bp.z -c gimble.optimize.IM_AB.allopatric.intergenic.autosomes_collinear.64bp.kmax2.model4.config.ini -t allopatric.intergenic.autosomes_collinear.64bp.kmax2.IM_AB_model4 -i 1000 --xtol 0.00000000000000001 --ftol 0.00000000000000001 -f -n 30

results: gimble.optimize.allopatric.intergenic.autosomes_collinear.64bp.kmax2.model4.0.20221220_205458.log

dataset_idx,iteration,block_length,likelihood,Ne_A_unscaled,Ne_B_unscaled,Ne_A_B_unscaled,T_unscaled,me_unscaled,Ne_A_scaled,Ne_B_scaled,Ne_A_B_scaled,T_scaled,me_scaled
0,538,64,-45638336.03470967,1.0,0.5417173529003718,0.2724019985744229,3.3222142485771067,0.008343743677709665,382052.5698063279,705261.82659796,1402532.1833383958,2538520.9822321646,1.0919627738584927e-08
0,539,64,-45638336.03470971,1.0,0.5417173529006435,0.2724019985747094,3.3222142485762105,0.008343743677702832,382052.56980659976,705261.826598108,1402532.1833379185,2538520.982233286,1.0919627738568214e-08
0,540,64,-45638336.03470966,1.0,0.5417173529004398,0.27240199857449454,3.3222142485768824,0.008343743677707958,382052.5698063959,705261.826597997,1402532.1833382766,2538520.982232445,1.091962773858075e-08
0,541,64,-45638336.03470962,1.0,0.5417173529005755,0.2724019985746378,3.3222142485764348,0.008343743677704539,382052.56980653177,705261.826598071,1402532.1833380377,2538520.9822330056,1.0919627738572391e-08
0,542,64,-45638336.03470966,1.0,0.5417173529003394,0.27240199857448766,3.3222142485776174,0.00834374367770578,382052.5698063366,705261.8265980182,1402532.1833380943,2538520.9822326126,1.0919627738579595e-08


gIMble/./gIMble optimize -z /scratch/npoikela/2montana.allopatric.sympatric.intergenic.autosomes_collinear.64bp.z -c gimble.optimize.IM_AB.intraspecific.intergenic.autosomes_collinear.64bp.kmax2.model4.config.ini -t intraspecific.intergenic.autosomes_collinear.64bp.kmax2.IM_AB_model4 -i -1 --xtol 0.00000000000000001 --ftol 0.00000000000000001 -f -n 30

dataset_idx,iteration,block_length,likelihood,Ne_A_unscaled,Ne_B_unscaled,Ne_A_B_unscaled,T_unscaled,me_unscaled,Ne_A_scaled,Ne_B_scaled,Ne_A_B_scaled,T_scaled,me_scaled
results: gimble.optimize.intraspecific.intergenic.autosomes_collinear.64bp.kmax2.model4.0.20230406_150854.log

0,1000,64,-39887381.71765783,1.0,0.6963297432643922,1.265713348344145,0.09647873513098756,3.2662459868433465e-09,1086577.1264063576,1560434.7464930718,858470.1487330127,209663.17355589714,1.5029977658584713e-15
0,1001,64,-39887381.71765799,1.0,0.6963297432643922,1.2657133483441447,0.09647873513098756,3.266245986848993e-09,1086577.1264063576,1560434.7464930718,858470.1487330128,209663.17355589714,1.5029977658610695e-15
0,1002,64,-39887381.71765799,1.0,0.6963297432643922,1.2657133483441447,0.09647873513098756,3.2662459868443313e-09,1086577.1264063576,1560434.7464930718,858470.1487330128,209663.17355589714,1.5029977658589244e-15
0,1003,64,-39887381.71765799,1.0,0.6963297432643922,1.2657133483441447,0.09647873513098756,3.266245986844735e-09,1086577.1264063576,1560434.7464930718,858470.1487330128,209663.17355589714,1.5029977658591101e-15
0,1004,64,-39887381.71765836,1.0,0.6963297432643922,1.2657133483441447,0.09647873513098759,3.266245986845441e-09,1086577.1264063576,1560434.7464930718,858470.1487330128,209663.1735558972,1.5029977658594351e-15

qsub -cwd -l h=bigfoot -N gIMble -V -pe smp64 30 gimble_commands.txt





## 5th model; Isolation with migration, gene flow from D. flavomontana (A) to D. montana (B)
## 5th model; Isolation with migration, gene flow from allopatry (A) to sympatry (B)

gIMble/./gIMble optimize -z /scratch/npoikela/2montana.flavomontana.sympatric.intergenic.autosomes_collinear.64bp.z -c gimble.optimize.IM_BA.sympatric.intergenic.autosomes_collinear.64bp.kmax2.model5.config.ini -t sympatric.intergenic.autosomes_collinear.64bp.kmax2.IM_BA_model5 -i 1000 --xtol 0.00000000000000001 --ftol 0.00000000000000001 -f -n 30

results: gimble.optimize.sympatric.intergenic.autosomes_collinear.64bp.kmax2.model5.0.20221220_205441.log

dataset_idx,iteration,block_length,likelihood,Ne_A_unscaled,Ne_B_unscaled,Ne_A_B_unscaled,T_unscaled,me_unscaled,Ne_A_scaled,Ne_B_scaled,Ne_A_B_scaled,T_scaled,me_scaled
0,528,64,-136873721.96761483,1.0,0.5470845035293749,0.27160363724949976,3.0215166032380925,0.0016751928401874722,393103.33289856825,718542.2551042174,1447341.9313507085,2375536.49428251,2.130728360702705e-09
0,529,64,-136873721.96761492,1.0,0.5470845035293698,0.2716036372495071,3.0215166032381573,0.001675192840188842,393103.3328985699,718542.2551042272,1447341.9313506754,2375536.4942825707,2.1307283607044385e-09
0,530,64,-136873721.9676148,1.0,0.5470845035293942,0.27160363724951014,3.021516603237946,0.0016751928401860527,393103.3328985857,718542.2551042241,1447341.9313507176,2375536.4942825004,2.130728360700805e-09
0,531,64,-136873721.96761492,1.0,0.5470845035293799,0.2716036372495178,3.021516603238092,0.0016751928401882628,393103.3328985827,718542.2551042372,1447341.9313506656,2375536.4942825967,2.1307283607036324e-09
0,532,64,-136873721.9676148,1.0,0.5470845035293581,0.27160363724951486,3.021516603238253,0.0016751928401892559,393103.3328985694,718542.2551042417,1447341.9313506323,2375536.4942826433,2.1307283607049674e-09


gIMble/./gIMble optimize -z /scratch/npoikela/2montana.flavomontana.allopatric.intergenic.autosomes_collinear.64bp.z -c gimble.optimize.IM_BA.allopatric.intergenic.autosomes_collinear.64bp.kmax2.model5.config.ini -t allopatric.intergenic.autosomes_collinear.64bp.kmax2.IM_BA_model5 -i 1000 --xtol 0.00000000000000001 --ftol 0.00000000000000001 -f -n 30

results: gimble.optimize.allopatric.intergenic.autosomes_collinear.64bp.kmax2.model5.0.20221221_010703.log

dataset_idx,iteration,block_length,likelihood,Ne_A_unscaled,Ne_B_unscaled,Ne_A_B_unscaled,T_unscaled,me_unscaled,Ne_A_scaled,Ne_B_scaled,Ne_A_B_scaled,T_scaled,me_scaled
0,455,64,-45650952.12919153,1.0,0.5719043740953308,0.27150745935490306,3.030107927477359,0.0009555048504105222,395700.1136550092,691899.0858934222,1457418.9401469326,2398028.1025794707,1.20735983821776e-09
0,456,64,-45650952.12919155,1.0,0.5719043740952203,0.27150745935508525,3.0301079274788996,0.0009555048504557674,395700.11365513015,691899.0858937674,1457418.9401464001,2398028.102581423,1.2073598382745618e-09
0,457,64,-45650952.129191525,1.0,0.5719043740953135,0.27150745935501286,3.0301079274780283,0.0009555048504370071,395700.1136551016,691899.0858936049,1457418.9401466837,2398028.1025805604,1.2073598382509437e-09
0,458,64,-45650952.12919153,1.0,0.5719043740954467,0.27150745935505755,3.0301079274778036,0.0009555048504410684,395700.1136551568,691899.0858935402,1457418.940146647,2398028.102580717,1.2073598382559072e-09
0,459,64,-45650952.12919149,1.0,0.5719043740953482,0.2715074593550144,3.0301079274781104,0.0009555048504418909,395700.11365512526,691899.0858936042,1457418.9401467624,2398028.1025807685,1.2073598382570427e-09


gIMble/./gIMble optimize -z /scratch/npoikela/2montana.allopatric.sympatric.intergenic.autosomes_collinear.64bp.z -c gimble.optimize.IM_BA.intraspecific.intergenic.autosomes_collinear.64bp.kmax2.model5.config.ini -t intraspecific.intergenic.autosomes_collinear.64bp.kmax2.IM_BA_model5 -i -1 --xtol 0.00000000000000001 --ftol 0.00000000000000001 -f -n 30

results: gimble.optimize.intraspecific.intergenic.autosomes_collinear.64bp.kmax2.model5.0.20230123_105959.log

dataset_idx,iteration,block_length,likelihood,Ne_A_unscaled,Ne_B_unscaled,Ne_A_B_unscaled,T_unscaled,me_unscaled,Ne_A_scaled,Ne_B_scaled,Ne_A_B_scaled,T_scaled,me_scaled
0,775,64,-39887408.45252496,1.0,0.748605784910926,1.257644015608494,0.1003846384732206,0.7159863299692446,1079042.6919568828,1441403.0905268444,857987.3784353855,216638.62105852485,3.317692317950727e-07
0,776,64,-39887408.45252444,1.0,0.7486057849109572,1.2576440156082727,0.10038463847321562,0.7159863299696646,1079042.691956657,1441403.0905264826,857987.3784353569,216638.62105846877,3.3176923179533675e-07
0,777,64,-39887408.45252483,1.0,0.74860578491075,1.2576440156085051,0.10038463847322643,0.7159863299686904,1079042.6919568987,1441403.0905272043,857987.3784353905,216638.6210585406,3.31769231794811e-07
0,778,64,-39887408.452524185,1.0,0.7486057849110052,1.2576440156082855,0.1003846384732143,0.7159863299697928,1079042.6919566686,1441403.0905264057,857987.3784353575,216638.62105846824,3.317692317953926e-07
0,779,64,-39887408.45252499,1.0,0.7486057849109021,1.2576440156084487,0.10038463847322061,0.715986329969237,1079042.6919568377,1441403.09052683,857987.3784353804,216638.6210585158,3.3176923179508307e-07


######################################################################################################################################################################################



######################################################################################################################################################################################
######################################################################################################################################################################################
######################################################################################################################################################################################
#### SIMULATE AND OPTIMIZE SIMULATED DATA (test uncertainty in model fit) ####

## Fit simulated data under the corrent strict divergence model
# mu = 2.8e-9
# recombination_rate = 1.76E-8 / 2 --> 8.9E-9
gIMble/./gIMble makeconfig -l sympatric.intergenic.autosomes_collinear.64bp.kmax2.DIV_model1 -t simulate -m 1
[+] Wrote INI file 'gimble.simulate.DIV.sympatric.intergenic.autosomes_collinear.64bp.kmax2.DIV_model1.config.ini'. Please fill in values before starting 'simulate'.
[*] Total runtime was 00h:00m:00.004s

gIMble/./gIMble makeconfig -l allopatric.intergenic.autosomes_collinear.64bp.kmax2.DIV_model1 -t simulate -m 1
[+] Wrote INI file 'gimble.simulate.DIV.allopatric.intergenic.autosomes_collinear.64bp.kmax2.DIV_model1.config.ini'. Please fill in values before starting 'simulate'.
[*] Total runtime was 00h:00m:00.004s

# blocks: 44460704 / 81 = 548898
gIMble/./gIMble simulate -o /scratch/npoikela/simulate.montana.flavomontana.sympatric.intergenic.autosomes_collinear.64bp.DIV_model1 -c gimble.simulate.DIV.sympatric.intergenic.autosomes_collinear.64bp.kmax2.DIV_model1.config.ini -t 30

# blocks: 14883686 / 27 = 551248
gIMble/./gIMble simulate -o /scratch/npoikela/simulate.montana.flavomontana.allopatric.intergenic.autosomes_collinear.64bp.DIV_model1 -c gimble.simulate.DIV.allopatric.intergenic.autosomes_collinear.64bp.kmax2.DIV_model1.config.ini -t 30


gIMble/./gIMble optimize -z /scratch/npoikela/simulate.montana.flavomontana.sympatric.intergenic.autosomes_collinear.64bp.DIV_model1.z -c gimble.optimize.DIV.sympatric.intergenic.autosomes_collinear.64bp.kmax2.model1.config.ini -s sympatric.intergenic.autosomes_collinear.64bp.kmax2.DIV_model1 -i 1000 --xtol 0.000000000000001 --ftol 0.000000000000001 -n 30 -f

results: gimble.optimize.sympatric.intergenic.autosomes_collinear.64bp.kmax2.model1.0.20230117_210619.log

# fetching the final iterations for each replicate
awk -F, '$2 > max[$1] { max[$1] = $2; m[$1] = $0 }
     END { for (i in m) { print m[i] } }' gimble.optimize.sympatric.intergenic.autosomes_collinear.64bp.kmax2.model1.0.20230117_210619.log > gimble.optimize.sympatric.intergenic.autosomes_collinear.64bp.kmax2.model1.0.20230117_210619.final_iterations.log


gIMble/./gIMble optimize -z /scratch/npoikela/simulate.montana.flavomontana.allopatric.intergenic.autosomes_collinear.64bp.DIV_model1.z -c gimble.optimize.DIV.allopatric.intergenic.autosomes_collinear.64bp.kmax2.model1.config.ini -s allopatric.intergenic.autosomes_collinear.64bp.kmax2.DIV_model1 -i 1000 --xtol 0.000000000000001 --ftol 0.000000000000001 -n 30 -f

results: gimble.optimize.allopatric.intergenic.autosomes_collinear.64bp.kmax2.model1.0.20230117_211950.log

# fetching the final iterations for each replicate
awk -F, '$2 > max[$1] { max[$1] = $2; m[$1] = $0 }
     END { for (i in m) { print m[i] } }' gimble.optimize.allopatric.intergenic.autosomes_collinear.64bp.kmax2.model1.0.20230117_211950.log > gimble.optimize.allopatric.intergenic.autosomes_collinear.64bp.kmax2.model1.0.20230117_211950.final_iterations.log


## Fitting Simulated DIV data under the best IM model
gIMble/./gIMble optimize -z /scratch/npoikela/simulate.montana.flavomontana.sympatric.intergenic.autosomes_collinear.64bp.DIV_model1.z -c gimble.optimize.IM_AB.sympatric.intergenic.autosomes_collinear.64bp.kmax2.model4.config.ini -s sympatric.intergenic.autosomes_collinear.64bp.kmax2.DIV_model1 -i 1000 --xtol 0.000000000000001 --ftol 0.000000000000001 -n 30 -f

results: gimble.optimize.sympatric.intergenic.autosomes_collinear.64bp.kmax2.model4.0.20230118_115607.log

# fetching the final iterations for each replicate
awk -F, '$2 > max[$1] { max[$1] = $2; m[$1] = $0 }
     END { for (i in m) { print m[i] } }' gimble.optimize.sympatric.intergenic.autosomes_collinear.64bp.kmax2.model4.0.20230118_115607.log >gimble.optimize.sympatric.intergenic.autosomes_collinear.64bp.kmax2.model4.0.20230118_115607.final_iteration.log


gIMble/./gIMble optimize -z /scratch/npoikela/simulate.montana.flavomontana.allopatric.intergenic.autosomes_collinear.64bp.DIV_model1.z -c gimble.optimize.IM_AB.allopatric.intergenic.autosomes_collinear.64bp.kmax2.model4.config.ini -s allopatric.intergenic.autosomes_collinear.64bp.kmax2.DIV_model1 -i 1000 --xtol 0.000000000000001 --ftol 0.000000000000001 -n 30 -f

results: gimble.optimize.allopatric.intergenic.autosomes_collinear.64bp.kmax2.model4.0.20230118_115610.log

# fetching the final iterations for each replicate
awk -F, '$2 > max[$1] { max[$1] = $2; m[$1] = $0 }
     END { for (i in m) { print m[i] } }' gimble.optimize.allopatric.intergenic.autosomes_collinear.64bp.kmax2.model4.0.20230118_115610.log >gimble.optimize.allopatric.intergenic.autosomes_collinear.64bp.kmax2.model4.0.20230118_115610.final_iteration.log


######################################################################################################################################################################################
######################################################################################################################################################################################
######################################################################################################################################################################################
######################################################################################################################################################################################
######################################################################################################################################################################################



#### Separate regions of the genome ####

##################################################################################################################################################################################

### autosomes, collinear, intergenic
bedtools intersect -a gimble2.D_montana.ref_genome.non_repeats.intergenic.sorted.bed -b autosomes_collinear.bed > gimble2.D_montana.ref_genome.non_repeats.intergenic.autosomes_collinear.bed
sort -k1,1V -k2,2n -k3,3n gimble2.D_montana.ref_genome.non_repeats.intergenic.autosomes_collinear.bed > gimble2.D_montana.ref_genome.non_repeats.intergenic.autosomes_collinear.sorted.bed

## measure
gIMble/./gIMble measure -f -g gimble2.autosomes.genomefile -b gimble2.D_montana.ref_genome.non_repeats.intergenic.autosomes_collinear.sorted.bed -s gimble2.samples.montana.flavomontana.sympatric.csv -v gimble2.vcf.gz -z /scratch/npoikela/2montana.flavomontana.sympatric.intergenic.autosomes_collinear.64bp

gIMble/./gIMble measure -f -g gimble2.autosomes.genomefile -b gimble2.D_montana.ref_genome.non_repeats.intergenic.autosomes_collinear.sorted.bed -s gimble2.samples.montana.flavomontana.allopatric.csv -v gimble2.vcf.gz -z /scratch/npoikela/2montana.flavomontana.allopatric.intergenic.autosomes_collinear.64bp

## blocks
gIMble/./gIMble blocks -z /scratch/npoikela/2montana.flavomontana.sympatric.intergenic.autosomes_collinear.64bp.z -l 64 -f
gIMble/./gIMble blocks -z /scratch/npoikela/2montana.flavomontana.allopatric.intergenic.autosomes_collinear.64bp.z -l 64 -f

## tally
gIMble/./gIMble tally -z /scratch/npoikela/2montana.flavomontana.sympatric.intergenic.autosomes_collinear.64bp.z -d blocks -l sympatric.intergenic.autosomes_collinear.64bp.kmax2.IM_model4 -k 2,2,2,2 -S gimble2.autosomes.genomefile --overwrite
[+] Found 44,460,704 blocks on 5 sequence(s).
[+] Percentage of blocks treated as marginals (w/ kmax = [2 2 2 2]) = 26.24%
[+] Tally'ing variation data ...
[+] Tally saved under label 'sympatric.intergenic.autosomes_collinear.64bp.kmax2.IM_model4' (use this for optimize/gridsearch).
[+] Tally is accessible with the key 'tally/sympatric.intergenic.autosomes_collinear.64bp.kmax2.IM_model4' (use this for query).
[*] Total runtime was 00h:03m:08.917s

gIMble/./gIMble tally -z /scratch/npoikela/2montana.flavomontana.allopatric.intergenic.autosomes_collinear.64bp.z -d blocks -l allopatric.intergenic.autosomes_collinear.64bp.kmax2.IM_model4 -k 2,2,2,2 -S gimble2.autosomes.genomefile --overwrite
[+] Found 14,883,686 blocks on 5 sequence(s).
[+] Percentage of blocks treated as marginals (w/ kmax = [2 2 2 2]) = 26.47%
[+] Tally'ing variation data ...
[+] Tally saved under label 'allopatric.intergenic.autosomes_collinear.64bp.kmax2.IM_model4' (use this for optimize/gridsearch).
[+] Tally is accessible with the key 'tally/allopatric.intergenic.autosomes_collinear.64bp.kmax2.IM_model4' (use this for query).


# mu = 2.8e-9
gIMble/./gIMble makeconfig -l sympatric.intergenic.autosomes_collinear.64bp.kmax2.model4 -t optimize -m 4
[+] Wrote INI file 'gimble.optimize.IM_AB.sympatric.intergenic.autosomes_collinear.64bp.kmax2.model4.config.ini'. Please fill in values before starting 'optimize'.
[*] Total runtime was 00h:00m:00.005s

[parameters]
# Model parameters and their values/ranges:
# A) Fixed : value
# B) Range : min, max
# Effective population size of A
Ne_A = 200000, 500000
# Effective population size of B
Ne_B = 500000, 1000000
# Effective population size of A_B
Ne_A_B = 200000, 1700000
# Split time (in generations)
T = 2000000, 3500000
# Migration rate (migrants/generation) from A to B (backwards in time)
me = 1e-18, 1e-07

gIMble/./gIMble makeconfig -l allopatric.intergenic.autosomes_collinear.64bp.kmax2.model4 -t optimize -m 4
[+] Wrote INI file 'gimble.optimize.IM_AB.allopatric.intergenic.autosomes_collinear.64bp.kmax2.model4.config.ini'. Please fill in values before starting 'optimize'.
[*] Total runtime was 00h:00m:00.027s

[parameters]
# Model parameters and their values/ranges:
# A) Fixed : value
# B) Range : min, max
# Effective population size of A
Ne_A = 200000, 500000
# Effective population size of B
Ne_B = 500000, 1000000
# Effective population size of A_B
Ne_A_B = 200000, 1700000
# Split time (in generations)
T = 2000000, 3500000
# Migration rate (migrants/generation) from A to B (backwards in time)
me = 1e-18, 1e-07

gIMble/./gIMble optimize -z /scratch/npoikela/2montana.flavomontana.sympatric.intergenic.autosomes_collinear.64bp.z -c gimble.optimize.IM_AB.sympatric.intergenic.autosomes_collinear.64bp.kmax2.model4.config.ini -t sympatric.intergenic.autosomes_collinear.64bp.kmax2.IM_model4 -i 1000 --xtol 0.00000000000000001 --ftol 0.00000000000000001 -f -n 30

results: gimble.optimize.sympatric.intergenic.autosomes_collinear.64bp.kmax2.model4.0.20230207_114108.log

dataset_idx,iteration,block_length,likelihood,Ne_A_unscaled,Ne_B_unscaled,Ne_A_B_unscaled,T_unscaled,me_unscaled,Ne_A_scaled,Ne_B_scaled,Ne_A_B_scaled,T_scaled,me_scaled
0,489,64,-136827868.9880551,1.0,0.5126339214043363,0.2716157560044848,3.350901045377642,0.00972863874964794,376922.98455979466,735267.3493147548,1387706.6268334268,2526063.2459765533,1.2905340279274745e-08
0,490,64,-136827868.98805523,1.0,0.512633921404346,0.2716157560045253,3.3509010453776926,0.009728638749654137,376922.9845598217,735267.3493147935,1387706.6268333192,2526063.245976773,1.2905340279282037e-08
0,491,64,-136827868.9880553,1.0,0.5126339214042915,0.2716157560042998,3.3509010453780403,0.009728638749630645,376922.9845596689,735267.3493145737,1387706.6268339087,2526063.2459760113,1.2905340279256107e-08
0,492,64,-136827868.98805517,1.0,0.5126339214043814,0.27161575600464316,3.3509010453775803,0.009728638749664831,376922.98455989873,735267.3493148931,1387706.6268330007,2526063.2459772043,1.2905340279293588e-08
0,493,64,-136827868.98805523,1.0,0.5126339214043408,0.27161575600446486,3.3509010453778822,0.009728638749645621,376922.9845597768,735267.3493147134,1387706.6268334626,2526063.2459766148,1.290534027927228e-08

 
gIMble/./gIMble optimize -z /scratch/npoikela/2montana.flavomontana.allopatric.intergenic.autosomes_collinear.64bp.z -c gimble.optimize.IM_AB.allopatric.intergenic.autosomes_collinear.64bp.kmax2.model4.config.ini -t allopatric.intergenic.autosomes_collinear.64bp.kmax2.IM_model4 -i 1000 --xtol 0.00000000000000001 --ftol 0.00000000000000001 -f -n 30

results: gimble.optimize.allopatric.intergenic.autosomes_collinear.64bp.kmax2.model4.0.20230207_114047.log

dataset_idx,iteration,block_length,likelihood,Ne_A_unscaled,Ne_B_unscaled,Ne_A_B_unscaled,T_unscaled,me_unscaled,Ne_A_scaled,Ne_B_scaled,Ne_A_B_scaled,T_scaled,me_scaled
0,538,64,-45638336.03470967,1.0,0.5417173529003718,0.2724019985744229,3.3222142485771067,0.008343743677709665,382052.5698063279,705261.82659796,1402532.1833383958,2538520.9822321646,1.0919627738584927e-08
0,539,64,-45638336.03470971,1.0,0.5417173529006435,0.2724019985747094,3.3222142485762105,0.008343743677702832,382052.56980659976,705261.826598108,1402532.1833379185,2538520.982233286,1.0919627738568214e-08
0,540,64,-45638336.03470966,1.0,0.5417173529004398,0.27240199857449454,3.3222142485768824,0.008343743677707958,382052.5698063959,705261.826597997,1402532.1833382766,2538520.982232445,1.091962773858075e-08
0,541,64,-45638336.03470962,1.0,0.5417173529005755,0.2724019985746378,3.3222142485764348,0.008343743677704539,382052.56980653177,705261.826598071,1402532.1833380377,2538520.9822330056,1.0919627738572391e-08
0,542,64,-45638336.03470966,1.0,0.5417173529003394,0.27240199857448766,3.3222142485776174,0.00834374367770578,382052.5698063366,705261.8265980182,1402532.1833380943,2538520.9822326126,1.0919627738579595e-08



## simulate optimize data
# mu = 2.8e-9
# recombination_rate = 1.76E-8 / 2 = 8.9E-9

gIMble/./gIMble makeconfig -l sympatric.intergenic.autosomes_collinear.64bp.kmax2.model4.sims -t simulate -m 4
[+] Wrote INI file 'gimble.simulate.IM_AB.sympatric.intergenic.autosomes_collinear.64bp.kmax2.model4.sims.config.ini'. Please fill in values before starting 'simulate'.
[*] Total runtime was 00h:00m:00.004s

gIMble/./gIMble makeconfig -l allopatric.intergenic.autosomes_collinear.64bp.kmax2.model4.sims -t simulate -m 4
[+] Wrote INI file 'gimble.simulate.IM_AB.allopatric.intergenic.autosomes_collinear.64bp.kmax2.model4.sims.config.ini'. Please fill in values before starting 'simulate'.
[*] Total runtime was 00h:00m:00.005s

# blocks: 44460704 / 81 = 548898
gIMble/./gIMble simulate -o /scratch/npoikela/2simulate.montana.flavomontana.sympatric.intergenic.autosomes_collinear.64bp.IM_AB_model4 -c gimble.simulate.IM_AB.sympatric.intergenic.autosomes_collinear.64bp.kmax2.model4.sims.config.ini -t 30

# blocks: 14883686 / 27 = 551248
gIMble/./gIMble simulate -o /scratch/npoikela/2simulate.montana.flavomontana.allopatric.intergenic.autosomes_collinear.64bp.IM_AB_model4 -c gimble.simulate.IM_AB.allopatric.intergenic.autosomes_collinear.64bp.kmax2.model4.sims.config.ini -t 30

gIMble/./gIMble optimize -z /scratch/npoikela/2simulate.montana.flavomontana.sympatric.intergenic.autosomes_collinear.64bp.IM_AB_model4.z -c gimble.optimize.IM_AB.sympatric.intergenic.autosomes_collinear.64bp.kmax2.model4.config.ini -s sympatric.intergenic.autosomes_collinear.64bp.kmax2.model4.sims -i 1000 --xtol 0.000000000000001 --ftol 0.000000000000001 -n 30 -f

results: gimble.optimize.sympatric.intergenic.autosomes_collinear.64bp.kmax2.model4.0.20230215_132814.log

# fetching the final iterations for each replicate
awk -F, '$2 > max[$1] { max[$1] = $2; m[$1] = $0 }
     END { for (i in m) { print m[i] } }' gimble.optimize.sympatric.intergenic.autosomes_collinear.64bp.kmax2.model4.0.20230215_132814.log > gimble.optimize.sympatric.intergenic.autosomes_collinear.64bp.kmax2.model4.0.20230215_132814.final_iteration.log


gIMble/./gIMble optimize -z /scratch/npoikela/2simulate.montana.flavomontana.allopatric.intergenic.autosomes_collinear.64bp.IM_AB_model4.z -c gimble.optimize.IM_AB.allopatric.intergenic.autosomes_collinear.64bp.kmax2.model4.config.ini -s allopatric.intergenic.autosomes_collinear.64bp.kmax2.model4.sims -i 1000 --xtol 0.000000000000001 --ftol 0.000000000000001 -n 30 -f

results: gimble.optimize.allopatric.intergenic.autosomes_collinear.64bp.kmax2.model4.0.20230215_130345.log

# fetching the final iterations for each replicate
awk -F, '$2 > max[$1] { max[$1] = $2; m[$1] = $0 }
     END { for (i in m) { print m[i] } }' gimble.optimize.allopatric.intergenic.autosomes_collinear.64bp.kmax2.model4.0.20230215_130345.log > gimble.optimize.allopatric.intergenic.autosomes_collinear.64bp.kmax2.model4.0.20230215_130345.final_iteration.log





### 4 inverted, intergenic
bedtools intersect -a gimble2.D_montana.ref_genome.non_repeats.intergenic.sorted.bed -b 4_inverted.bed > gimble2.D_montana.ref_genome.non_repeats.intergenic.4_inverted.bed
sort -k1,1V -k2,2n -k3,3n gimble2.D_montana.ref_genome.non_repeats.intergenic.4_inverted.bed > gimble2.D_montana.ref_genome.non_repeats.intergenic.4_inverted.sorted.bed

## measure
gIMble/./gIMble measure -f -g gimble2.4.genomefile -b gimble2.D_montana.ref_genome.non_repeats.intergenic.4_inverted.sorted.bed -s gimble2.samples.montana.flavomontana.sympatric.csv -v gimble2.vcf.gz -z /scratch/npoikela/2montana.flavomontana.sympatric.intergenic.4_inverted.64bp

gIMble/./gIMble measure -f -g gimble2.4.genomefile -b gimble2.D_montana.ref_genome.non_repeats.intergenic.4_inverted.sorted.bed -s gimble2.samples.montana.flavomontana.allopatric.csv -v gimble2.vcf.gz -z /scratch/npoikela/2montana.flavomontana.allopatric.intergenic.4_inverted.64bp


## blocks
gIMble/./gIMble blocks -z /scratch/npoikela/2montana.flavomontana.sympatric.intergenic.4_inverted.64bp.z -l 64 -f
gIMble/./gIMble blocks -z /scratch/npoikela/2montana.flavomontana.allopatric.intergenic.4_inverted.64bp.z -l 64 -f

## tally
gIMble/./gIMble tally -z /scratch/npoikela/2montana.flavomontana.sympatric.intergenic.4_inverted.64bp.z -d blocks -l sympatric.intergenic.4_inverted.64bp.kmax2.IM_model4 -k 2,2,2,2 -s 4_chromosome --overwrite
[+] Found 8,024,216 blocks on 1 sequence(s).
[+] Percentage of blocks treated as marginals (w/ kmax = [2 2 2 2]) = 32.36%
[+] Tally'ing variation data ...
[+] Tally saved under label 'sympatric.intergenic.4_inverted.64bp.kmax2.IM_model4' (use this for optimize/gridsearch).
[+] Tally is accessible with the key 'tally/sympatric.intergenic.4_inverted.64bp.kmax2.IM_model4' (use this for query).
[*] Total runtime was 00h:00m:25.808s

gIMble/./gIMble tally -z /scratch/npoikela/2montana.flavomontana.allopatric.intergenic.4_inverted.64bp.z -d blocks -l allopatric.intergenic.4_inverted.64bp.kmax2.IM_model4 -k 2,2,2,2 -s 4_chromosome --overwrite
[+] Found 2,691,199 blocks on 1 sequence(s).
[+] Percentage of blocks treated as marginals (w/ kmax = [2 2 2 2]) = 32.54%
[+] Tally'ing variation data ...
[+] Tally saved under label 'allopatric.intergenic.4_inverted.64bp.kmax2.IM_model4' (use this for optimize/gridsearch).
[+] Tally is accessible with the key 'tally/allopatric.intergenic.4_inverted.64bp.kmax2.IM_model4' (use this for query).
[*] Total runtime was 00h:00m:07.658s


# mu = 2.8e-9
gIMble/./gIMble makeconfig -l sympatric.intergenic.4_inverted.64bp.kmax2.model4 -t optimize -m 4
[+] Wrote INI file 'gimble.optimize.IM_AB.sympatric.intergenic.4_inverted.64bp.kmax2.model4.config.ini'. Please fill in values before starting 'optimize'.
[*] Total runtime was 00h:00m:00.005s

[parameters]
# Model parameters and their values/ranges:
# A) Fixed : value
# B) Range : min, max
# Effective population size of A
Ne_A = 200000, 500000
# Effective population size of B
Ne_B = 200000, 1600000
# Effective population size of A_B
Ne_A_B = 200000, 2500000
# Split time (in generations)
T = 1500000, 4200000
# Migration rate (migrants/generation) from A to B (backwards in time)
me = 1e-18, 1e-07

gIMble/./gIMble makeconfig -l allopatric.intergenic.4_inverted.64bp.kmax2.model4 -t optimize -m 4
[+] Wrote INI file 'gimble.optimize.IM_AB.allopatric.intergenic.4_inverted.64bp.kmax2.model4.config.ini'. Please fill in values before starting 'optimize'.
[*] Total runtime was 00h:00m:00.027s

[parameters]
# Model parameters and their values/ranges:
# A) Fixed : value
# B) Range : min, max
# Effective population size of A
Ne_A = 200000, 700000
# Effective population size of B
Ne_B = 200000, 1600000
# Effective population size of A_B
Ne_A_B = 200000, 2500000
# Split time (in generations)
T = 1500000, 4200000
# Migration rate (migrants/generation) from A to B (backwards in time)
me = 1e-18, 1e-07

gIMble/./gIMble optimize -z /scratch/npoikela/2montana.flavomontana.sympatric.intergenic.4_inverted.64bp.z -c gimble.optimize.IM_AB.sympatric.intergenic.4_inverted.64bp.kmax2.model4.config.ini -t sympatric.intergenic.4_inverted.64bp.kmax2.IM_model4 -i 1000 --xtol 0.00000000000000001 --ftol 0.00000000000000001 -f -n 30

results: gimble.optimize.sympatric.intergenic.4_inverted.64bp.kmax2.model4.0.20221106_004105.log

dataset_idx,iteration,block_length,likelihood,Ne_A_unscaled,Ne_B_unscaled,Ne_A_B_unscaled,T_unscaled,me_unscaled,Ne_A_scaled,Ne_B_scaled,Ne_A_B_scaled,T_scaled,me_scaled
0,552,64,-26119236.897643976,1.0,0.5426609915815799,0.2930281044387314,3.1815309661372755,0.006698794327724608,469592.6531669105,865351.7766189303,1602551.5848262147,2988047.1350421747,7.132558700128992e-09
0,553,64,-26119236.897643965,1.0,0.5426609915816806,0.29302810443877814,3.1815309661368274,0.0066987943277123894,469592.65316694736,865351.7766188376,1602551.5848260848,2988047.1350419885,7.132558700115423e-09
0,554,64,-26119236.89764399,1.0,0.5426609915815147,0.29302810443868543,3.1815309661376086,0.006698794327710484,469592.6531668301,865351.776618886,1602551.5848261914,2988047.1350419754,7.132558700115175e-09
0,555,64,-26119236.897643976,1.0,0.5426609915818842,0.2930281044388286,3.1815309661361155,0.006698794327736963,469592.65316707175,865351.7766187422,1602551.5848262333,2988047.1350421114,7.132558700139698e-09
0,556,64,-26119236.897643972,1.0,0.5426609915817918,0.2930281044387928,3.181530966136489,0.006698794327730342,469592.65316701133,865351.7766187781,1602551.5848262229,2988047.1350420774,7.1325587001335665e-09

gIMble/./gIMble optimize -z /scratch/npoikela/2montana.flavomontana.allopatric.intergenic.4_inverted.64bp.z -c gimble.optimize.IM_AB.allopatric.intergenic.4_inverted.64bp.kmax2.model4.config.ini -t allopatric.intergenic.4_inverted.64bp.kmax2.IM_model4 -i 1000 --xtol 0.00000000000000001 --ftol 0.00000000000000001 -f -n 30

results: gimble.optimize.allopatric.intergenic.4_inverted.64bp.kmax2.model4.0.20221106_003806.log

dataset_idx,iteration,block_length,likelihood,Ne_A_unscaled,Ne_B_unscaled,Ne_A_B_unscaled,T_unscaled,me_unscaled,Ne_A_scaled,Ne_B_scaled,Ne_A_B_scaled,T_scaled,me_scaled
0,518,64,-8680117.071231417,1.0,0.5945915116263324,0.2884324204272443,3.100345009163891,0.004931096675618611,474266.8948847616,797634.8225818803,1644291.214497481,2940782.0011352524,5.198651570247992e-09
0,519,64,-8680117.071231415,1.0,0.594591511626302,0.28843242042727396,3.100345009164044,0.004931096675618154,474266.894884776,797634.8225819452,1644291.2144973618,2940782.001135487,5.198651570247353e-09
0,520,64,-8680117.071231415,1.0,0.5945915116263012,0.2884324204272914,3.1003450091640286,0.0049310966756160686,474266.8948847905,797634.8225819707,1644291.214497313,2940782.0011355625,5.198651570244995e-09
0,521,64,-8680117.071231417,1.0,0.5945915116263042,0.28843242042727,3.1003450091640588,0.004931096675619743,474266.8948847731,797634.8225819374,1644291.2144973744,2940782.0011354834,5.198651570249059e-09
0,522,64,-8680117.071231414,1.0,0.5945915116263084,0.28843242042728273,3.100345009164036,0.004931096675617604,474266.8948847822,797634.822581947,1644291.2144973334,2940782.001135518,5.198651570246705e-09


## simulate real data
# mu = 2.8e-9
# recombination_rate = 1.76E-8 / 2 = 8.9E-9

gIMble/./gIMble makeconfig -l sympatric.intergenic.4_inverted.64bp.kmax2.model4.sims -t simulate -m 4
[+] Wrote INI file 'gimble.simulate.IM_AB.sympatric.intergenic.4_inverted.64bp.kmax2.model4.sims.config.ini'. Please fill in values before starting 'simulate'.
[*] Total runtime was 00h:00m:00.004s

gIMble/./gIMble makeconfig -l allopatric.intergenic.4_inverted.64bp.kmax2.model4.sims -t simulate -m 4
[+] Wrote INI file 'gimble.simulate.IM_AB.allopatric.intergenic.4_inverted.64bp.kmax2.model4.sims.config.ini'. Please fill in values before starting 'simulate'.
[*] Total runtime was 00h:00m:00.005s


# blocks: 8024216 / 81 = 99064
gIMble/./gIMble simulate -o /scratch/npoikela/2simulate.montana.flavomontana.sympatric.intergenic.4_inverted.64bp.IM_AB_model4 -c gimble.simulate.IM_AB.sympatric.intergenic.4_inverted.64bp.kmax2.model4.sims.config.ini -t 30

# blocks: 2691199 / 27 = 99674
gIMble/./gIMble simulate -o /scratch/npoikela/2simulate.montana.flavomontana.allopatric.intergenic.4_inverted.64bp.IM_AB_model4 -c gimble.simulate.IM_AB.allopatric.intergenic.4_inverted.64bp.kmax2.model4.sims.config.ini -t 30


gIMble/./gIMble optimize -z /scratch/npoikela/2simulate.montana.flavomontana.sympatric.intergenic.4_inverted.64bp.IM_AB_model4.z -c gimble.optimize.IM_AB.sympatric.intergenic.4_inverted.64bp.kmax2.model4.config.ini -s sympatric.intergenic.4_inverted.64bp.kmax2.model4.sims -i 1000 --xtol 0.000000000000001 --ftol 0.000000000000001 -n 30 -f

results: gimble.optimize.sympatric.intergenic.4_inverted.64bp.kmax2.model4.0.20221106_120121.log

# fetching the final iterations for each replicate
awk -F, '$2 > max[$1] { max[$1] = $2; m[$1] = $0 }
     END { for (i in m) { print m[i] } }' gimble.optimize.sympatric.intergenic.4_inverted.64bp.kmax2.model4.0.20221106_120121.log > gimble.optimize.sympatric.intergenic.4_inverted.64bp.kmax2.model4.0.20221106_120121.final_iteration.log


gIMble/./gIMble optimize -z /scratch/npoikela/2simulate.montana.flavomontana.allopatric.intergenic.4_inverted.64bp.IM_AB_model4.z -c gimble.optimize.IM_AB.allopatric.intergenic.4_inverted.64bp.kmax2.model4.config.ini -s allopatric.intergenic.4_inverted.64bp.kmax2.model4.sims -i 1000 --xtol 0.000000000000001 --ftol 0.000000000000001 -n 30 -f

results: gimble.optimize.allopatric.intergenic.4_inverted.64bp.kmax2.model4.0.20221106_115526.log

# fetching the final iterations for each replicate
awk -F, '$2 > max[$1] { max[$1] = $2; m[$1] = $0 }
     END { for (i in m) { print m[i] } }' gimble.optimize.allopatric.intergenic.4_inverted.64bp.kmax2.model4.0.20221106_115526.log > gimble.optimize.allopatric.intergenic.4_inverted.64bp.kmax2.model4.0.20221106_115526.final_iteration.log



### 5 inverted, intergenic
bedtools intersect -a gimble2.D_montana.ref_genome.non_repeats.intergenic.sorted.bed -b 5_inverted.bed > gimble2.D_montana.ref_genome.non_repeats.intergenic.5_inverted.bed
sort -k1,1V -k2,2n -k3,3n gimble2.D_montana.ref_genome.non_repeats.intergenic.5_inverted.bed > gimble2.D_montana.ref_genome.non_repeats.intergenic.5_inverted.sorted.bed

## measure
gIMble/./gIMble measure -f -g gimble2.5.genomefile -b gimble2.D_montana.ref_genome.non_repeats.intergenic.5_inverted.sorted.bed -s gimble2.samples.montana.flavomontana.sympatric.csv -v gimble2.vcf.gz -z /scratch/npoikela/2montana.flavomontana.sympatric.intergenic.5_inverted.64bp

gIMble/./gIMble measure -f -g gimble2.5.genomefile -b gimble2.D_montana.ref_genome.non_repeats.intergenic.5_inverted.sorted.bed -s gimble2.samples.montana.flavomontana.allopatric.csv -v gimble2.vcf.gz -z /scratch/npoikela/2montana.flavomontana.allopatric.intergenic.5_inverted.64bp


## blocks
gIMble/./gIMble blocks -z /scratch/npoikela/2montana.flavomontana.sympatric.intergenic.5_inverted.64bp.z -l 64 -f
gIMble/./gIMble blocks -z /scratch/npoikela/2montana.flavomontana.allopatric.intergenic.5_inverted.64bp.z -l 64 -f

## tally
gIMble/./gIMble tally -z /scratch/npoikela/2montana.flavomontana.sympatric.intergenic.5_inverted.64bp.z -d blocks -l sympatric.intergenic.5_inverted.64bp.kmax2.IM_model4 -k 2,2,2,2 -s 5_chromosome --overwrite
[+] Found 4,767,237 blocks on 1 sequence(s).
[+] Percentage of blocks treated as marginals (w/ kmax = [2 2 2 2]) = 27.00%
[+] Tally'ing variation data ...
[+] Tally saved under label 'sympatric.intergenic.5_inverted.64bp.kmax2.IM_model4' (use this for optimize/gridsearch).
[+] Tally is accessible with the key 'tally/sympatric.intergenic.5_inverted.64bp.kmax2.IM_model4' (use this for query).
[*] Total runtime was 00h:00m:13.865s

gIMble/./gIMble tally -z /scratch/npoikela/2montana.flavomontana.allopatric.intergenic.5_inverted.64bp.z -d blocks -l allopatric.intergenic.5_inverted.64bp.kmax2.IM_model4 -k 2,2,2,2 -s 5_chromosome --overwrite
[+] Found 1,596,050 blocks on 1 sequence(s).
[+] Percentage of blocks treated as marginals (w/ kmax = [2 2 2 2]) = 27.37%
[+] Tally'ing variation data ...
[+] Tally saved under label 'allopatric.intergenic.5_inverted.64bp.kmax2.IM_model4' (use this for optimize/gridsearch).
[+] Tally is accessible with the key 'tally/allopatric.intergenic.5_inverted.64bp.kmax2.IM_model4' (use this for query).
[*] Total runtime was 00h:00m:04.144s


# mu = 2.8e-9
gIMble/./gIMble makeconfig -l sympatric.intergenic.5_inverted.64bp.kmax2.model4 -t optimize -m 4
[+] Wrote INI file 'gimble.optimize.IM_AB.sympatric.intergenic.5_inverted.64bp.kmax2.model4.config.ini'. Please fill in values before starting 'optimize'.
[*] Total runtime was 00h:00m:00.005s

[parameters]
# Model parameters and their values/ranges:
# A) Fixed : value
# B) Range : min, max
# Effective population size of A
Ne_A = 200000, 700000
# Effective population size of B
Ne_B = 200000, 1600000
# Effective population size of A_B
Ne_A_B = 200000, 2500000
# Split time (in generations)
T = 1500000, 4200000
# Migration rate (migrants/generation) from A to B (backwards in time)
me = 1e-18, 1e-07

gIMble/./gIMble makeconfig -l allopatric.intergenic.5_inverted.64bp.kmax2.model4 -t optimize -m 4
[+] Wrote INI file 'gimble.optimize.IM_AB.allopatric.intergenic.5_inverted.64bp.kmax2.model4.config.ini'. Please fill in values before starting 'optimize'.
[*] Total runtime was 00h:00m:00.027s

[parameters]
# Model parameters and their values/ranges:
# A) Fixed : value
# B) Range : min, max
# Effective population size of A
Ne_A = 200000, 700000
# Effective population size of B
Ne_B = 200000, 1600000
# Effective population size of A_B
Ne_A_B = 200000, 2500000
# Split time (in generations)
T = 1500000, 4200000
# Migration rate (migrants/generation) from A to B (backwards in time)
me = 1e-18, 1e-07


gIMble/./gIMble optimize -z /scratch/npoikela/2montana.flavomontana.sympatric.intergenic.5_inverted.64bp.z -c gimble.optimize.IM_AB.sympatric.intergenic.5_inverted.64bp.kmax2.model4.config.ini -t sympatric.intergenic.5_inverted.64bp.kmax2.IM_model4 -i 1000 --xtol 0.00000000000000001 --ftol 0.00000000000000001 -f -n 30

results: gimble.optimize.sympatric.intergenic.5_inverted.64bp.kmax2.model4.0.20221105_223521.log

dataset_idx,iteration,block_length,likelihood,Ne_A_unscaled,Ne_B_unscaled,Ne_A_B_unscaled,T_unscaled,me_unscaled,Ne_A_scaled,Ne_B_scaled,Ne_A_B_scaled,T_scaled,me_scaled
0,513,64,-14790999.169163194,1.0,0.5220589008193044,0.297061260568171,3.5961444847559503,0.007647211606439567,392452.0707368556,751739.0664558203,1321114.9443930737,2822628.6994227907,9.742860563942756e-09
0,514,64,-14790999.169163184,1.0,0.5220589008192584,0.29706126056825755,3.5961444847570445,0.0076472116064508384,392452.0707368376,751739.066455852,1321114.944392628,2822628.69942352,9.742860563957564e-09
0,515,64,-14790999.169163203,1.0,0.5220589008193014,0.2970612605682088,3.5961444847558366,0.007647211606439894,392452.07073689986,751739.0664559095,1321114.9443930546,2822628.69942302,9.742860563942074e-09
0,516,64,-14790999.169163207,1.0,0.5220589008192917,0.2970612605681917,3.596144484756291,0.007647211606450482,392452.07073683804,751739.066455805,1321114.9443929226,2822628.6994229318,9.742860563957099e-09
0,517,64,-14790999.169163182,1.0,0.5220589008193053,0.29706126056821036,3.5961444847559205,0.007647211606445444,392452.0707368711,751739.0664558487,1321114.9443929507,2822628.6994228787,9.74286056394986e-09

gIMble/./gIMble optimize -z /scratch/npoikela/2montana.flavomontana.allopatric.intergenic.5_inverted.64bp.z -c gimble.optimize.IM_AB.allopatric.intergenic.5_inverted.64bp.kmax2.model4.config.ini -t allopatric.intergenic.5_inverted.64bp.kmax2.IM_model4 -i 1000 --xtol 0.00000000000000001 --ftol 0.00000000000000001 -f -n 30

results: gimble.optimize.allopatric.intergenic.5_inverted_64bp.kmax2.model4.0.20221105_223434.log

dataset_idx,iteration,block_length,likelihood,Ne_A_unscaled,Ne_B_unscaled,Ne_A_B_unscaled,T_unscaled,me_unscaled,Ne_A_scaled,Ne_B_scaled,Ne_A_B_scaled,T_scaled,me_scaled
0,520,64,-4923952.036766272,1.0,0.5513090787708229,0.29018223589482106,3.5073487685955302,0.0060291916671171555,395822.4664545801,717968.3442490923,1364047.8895408649,2776574.880603834,7.616030137350723e-09
0,521,64,-4923952.036766275,1.0,0.5513090787709826,0.2901822358954045,3.507348768595954,0.006029191667062526,395822.4664548471,717968.3442493686,1364047.8895390425,2776574.880606042,7.616030137276578e-09
0,522,64,-4923952.036766274,1.0,0.5513090787710001,0.2901822358952397,3.5073487685952935,0.006029191667068994,395822.4664547964,717968.3442492539,1364047.8895396423,2776574.880605164,7.616030137285725e-09
0,523,64,-4923952.036766278,1.0,0.5513090787710351,0.2901822358949102,3.5073487685939733,0.006029191667081932,395822.466454695,717968.3442490243,1364047.8895408418,2776574.8806034075,7.616030137304019e-09
0,524,64,-4923952.036766277,1.0,0.5513090787710088,0.29018223589515735,3.507348768594964,0.006029191667072229,395822.466454771,717968.3442491965,1364047.8895399421,2776574.880604725,7.6160301372903e-09



## simulate real data
# mu = 2.8e-9
# recombination_rate = 1.76E-8 / 2 = 8.9E-9

gIMble/./gIMble makeconfig -l sympatric.intergenic.5_inverted.64bp.kmax2.model4.sims -t simulate -m 4
[+] Wrote INI file 'gimble.simulate.IM_AB.sympatric.intergenic.5_inverted.64bp.kmax2.model4.sims.config.ini'. Please fill in values before starting 'simulate'.
[*] Total runtime was 00h:00m:00.004s

gIMble/./gIMble makeconfig -l allopatric.intergenic.5_inverted.64bp.kmax2.model4.sims -t simulate -m 4
[+] Wrote INI file 'gimble.simulate.IM_AB.allopatric.intergenic.5_inverted.64bp.kmax2.model4.sims.config.ini'. Please fill in values before starting 'simulate'.
[*] Total runtime was 00h:00m:00.005s

# blocks: 4767237 / 81 = 58855
gIMble/./gIMble simulate -o /scratch/npoikela/2simulate.montana.flavomontana.sympatric.intergenic.5_inverted.64bp.IM_AB_model4 -c gimble.simulate.IM_AB.sympatric.intergenic.5_inverted.64bp.kmax2.model4.sims.config.ini -t 30

# blocks: 1596050 / 27 = 59113
gIMble/./gIMble simulate -o /scratch/npoikela/2simulate.montana.flavomontana.allopatric.intergenic.5_inverted.64bp.IM_AB_model4 -c gimble.simulate.IM_AB.allopatric.intergenic.5_inverted.64bp.kmax2.model4.sims.config.ini -t 30


gIMble/./gIMble optimize -z /scratch/npoikela/2simulate.montana.flavomontana.sympatric.intergenic.5_inverted.64bp.IM_AB_model4.z -c gimble.optimize.IM_AB.sympatric.intergenic.5_inverted.64bp.kmax2.model4.config.ini -s sympatric.intergenic.5_inverted.64bp.kmax2.model4.sims -i 1000 --xtol 0.000000000000001 --ftol 0.000000000000001 -n 30 -f

results: gimble.optimize.sympatric.intergenic.5_inverted.64bp.kmax2.model4.0.20221107_232020.log

# fetching the final iterations for each replicate
awk -F, '$2 > max[$1] { max[$1] = $2; m[$1] = $0 }
     END { for (i in m) { print m[i] } }' gimble.optimize.sympatric.intergenic.5_inverted.64bp.kmax2.model4.0.20221107_232020.log > gimble.optimize.sympatric.intergenic.5_inverted.64bp.kmax2.model4.0.20221107_232020.final_iteration.log


gIMble/./gIMble optimize -z /scratch/npoikela/2simulate.montana.flavomontana.allopatric.intergenic.5_inverted.64bp.IM_AB_model4.z -c gimble.optimize.IM_AB.allopatric.intergenic.5_inverted.64bp.kmax2.model4.config.ini -s allopatric.intergenic.5_inverted.64bp.kmax2.model4.sims -i 1000 --xtol 0.000000000000001 --ftol 0.000000000000001 -n 30 -f

results: gimble.optimize.allopatric.intergenic.5_inverted_64bp.kmax2.model4.0.20221108_024641.log

# fetching the final iterations for each replicate
awk -F, '$2 > max[$1] { max[$1] = $2; m[$1] = $0 }
     END { for (i in m) { print m[i] } }' gimble.optimize.allopatric.intergenic.5_inverted_64bp.kmax2.model4.0.20221108_024641.log > gimble.optimize.allopatric.intergenic.5_inverted_64bp.kmax2.model4.0.20221108_024641.final_iteration.log





### X inverted, intergenic
bedtools intersect -a gimble2.D_montana.ref_genome.non_repeats.intergenic.sorted.bed -b X_inverted.bed > gimble2.D_montana.ref_genome.non_repeats.intergenic.X_inverted.bed
sort -k1,1V -k2,2n -k3,3n gimble2.D_montana.ref_genome.non_repeats.intergenic.X_inverted.bed > gimble2.D_montana.ref_genome.non_repeats.intergenic.X_inverted.sorted.bed

## measure
gIMble/./gIMble measure -f -g gimble2.X.genomefile -b gimble2.D_montana.ref_genome.non_repeats.intergenic.X_inverted.sorted.bed -s gimble2.samples.montana.flavomontana.sympatric.csv -v gimble2.vcf.gz -z /scratch/npoikela/2montana.flavomontana.sympatric.intergenic.X_inverted.64bp

gIMble/./gIMble measure -f -g gimble2.X.genomefile -b gimble2.D_montana.ref_genome.non_repeats.intergenic.X_inverted.sorted.bed -s gimble2.samples.montana.flavomontana.allopatric.csv -v gimble2.vcf.gz -z /scratch/npoikela/2montana.flavomontana.allopatric.intergenic.X_inverted.64bp

## blocks
gIMble/./gIMble blocks -z /scratch/npoikela/2montana.flavomontana.sympatric.intergenic.X_inverted.64bp.z -l 64 -f
gIMble/./gIMble blocks -z /scratch/npoikela/2montana.flavomontana.allopatric.intergenic.X_inverted.64bp.z -l 64 -f

## tally
gIMble/./gIMble tally -z /scratch/npoikela/2montana.flavomontana.sympatric.intergenic.X_inverted.64bp.z -d blocks -l sympatric.intergenic.X_inverted.64bp.kmax2.IM_model4 -k 2,2,2,2 -s X_chromosome --overwrite
[+] Found 7,787,904 blocks on 1 sequence(s).
[+] Percentage of blocks treated as marginals (w/ kmax = [2 2 2 2]) = 33.29%
[+] Tally'ing variation data ...
[+] Tally saved under label 'sympatric.intergenic.X_inverted.64bp.kmax2.IM_model4' (use this for optimize/gridsearch).
[+] Tally is accessible with the key 'tally/sympatric.intergenic.X_inverted.64bp.kmax2.IM_model4' (use this for query).
[*] Total runtime was 00h:00m:20.042s


gIMble/./gIMble tally -z /scratch/npoikela/2montana.flavomontana.allopatric.intergenic.X_inverted.64bp.z -d blocks -l allopatric.intergenic.X_inverted.64bp.kmax2.IM_model4 -k 2,2,2,2 -s X_chromosome --overwrite
[+] Found 2,605,017 blocks on 1 sequence(s).
[+] Percentage of blocks treated as marginals (w/ kmax = [2 2 2 2]) = 34.30%
[+] Tally'ing variation data ...
[+] Tally saved under label 'allopatric.intergenic.X_inverted.64bp.kmax2.IM_model4' (use this for optimize/gridsearch).
[+] Tally is accessible with the key 'tally/allopatric.intergenic.X_inverted.64bp.kmax2.IM_model4' (use this for query).
[*] Total runtime was 00h:00m:06.255s



# mu = 2.8e-9
gIMble/./gIMble makeconfig -l sympatric.intergenic.X_inverted.64bp.kmax2.model4 -t optimize -m 4
[+] Wrote INI file 'gimble.optimize.IM_AB.sympatric.intergenic.X_inverted.64bp.kmax2.model4.config.ini'. Please fill in values before starting 'optimize'.
[*] Total runtime was 00h:00m:00.005s

[parameters]
# Model parameters and their values/ranges:
# A) Fixed : value
# B) Range : min, max
# Effective population size of A
Ne_A = 200000, 700000
# Effective population size of B
Ne_B = 200000, 1500000
# Effective population size of A_B
Ne_A_B = 200000, 2000000
# Split time (in generations)
T = 2000000, 4600000
# Migration rate (migrants/generation) from A to B (backwards in time)
me = 1e-12, 1e-07

gIMble/./gIMble makeconfig -l allopatric.intergenic.X_inverted.64bp.kmax2.model4 -t optimize -m 4
[+] Wrote INI file 'gimble.optimize.IM_AB.allopatric.intergenic.X_inverted.64bp.kmax2.model4.config.ini'. Please fill in values before starting 'optimize'.
[*] Total runtime was 00h:00m:00.027s

[parameters]
# Model parameters and their values/ranges:
# A) Fixed : value
# B) Range : min, max
# Effective population size of A
Ne_A = 200000, 700000
# Effective population size of B
Ne_B = 200000, 1500000
# Effective population size of A_B
Ne_A_B = 200000, 2000000
# Split time (in generations)
T = 2000000, 4200000
# Migration rate (migrants/generation) from A to B (backwards in time)
me = 1e-12, 1e-07

gIMble/./gIMble optimize -z /scratch/npoikela/2montana.flavomontana.sympatric.intergenic.X_inverted.64bp.z -c gimble.optimize.IM_AB.sympatric.intergenic.X_inverted.64bp.kmax2.model4.config.ini -t sympatric.intergenic.X_inverted.64bp.kmax2.IM_model4 -i 1000 --xtol 0.00000000000000001 --ftol 0.00000000000000001 -f -n 30

results: gimble.optimize.sympatric.intergenic.X_inverted.64bp.kmax2.model4.0.20230210_120337.log

dataset_idx,iteration,block_length,likelihood,Ne_A_unscaled,Ne_B_unscaled,Ne_A_B_unscaled,T_unscaled,me_unscaled,Ne_A_scaled,Ne_B_scaled,Ne_A_B_scaled,T_scaled,me_scaled
0,529,64,-23194869.68103574,1.0,0.6007667713863101,0.22914115566638935,4.5559404432581045,0.007839435078924496,364502.37220745743,606728.5834839758,1590732.8875400405,3321302.1984069487,1.0753613250097946e-08
0,530,64,-23194869.681035727,1.0,0.6007667713862725,0.22914115566642196,4.555940443258844,0.007839435078928243,364502.3722074465,606728.5834839955,1590732.8875397663,3321302.198407388,1.0753613250103409e-08
0,531,64,-23194869.681035735,1.0,0.6007667713863607,0.229141155666423,4.555940443257714,0.00783943507892068,364502.3722074812,606728.5834839642,1590732.8875399104,3321302.19840688,1.075361325009201e-08
0,532,64,-23194869.681035742,1.0,0.6007667713862981,0.22914115566638144,4.555940443257983,0.007839435078918211,364502.3722074557,606728.583483985,1590732.8875400878,3321302.198406844,1.0753613250089377e-08
0,533,64,-23194869.681035742,1.0,0.6007667713863316,0.22914115566640536,4.555940443257912,0.0078394350789209,364502.37220746797,606728.5834839715,1590732.8875399753,3321302.198406904,1.0753613250092704e-08


gIMble/./gIMble optimize -z /scratch/npoikela/2montana.flavomontana.allopatric.intergenic.X_inverted.64bp.z -c gimble.optimize.IM_AB.allopatric.intergenic.X_inverted.64bp.kmax2.model4.config.ini -t allopatric.intergenic.X_inverted.64bp.kmax2.IM_model4 -i 1000 --xtol 0.00000000000000001 --ftol 0.00000000000000001 -f -n 30

results: gimble.optimize.allopatric.intergenic.X_inverted.64bp.kmax2.model4.0.20230210_120155.log

dataset_idx,iteration,block_length,likelihood,Ne_A_unscaled,Ne_B_unscaled,Ne_A_B_unscaled,T_unscaled,me_unscaled,Ne_A_scaled,Ne_B_scaled,Ne_A_B_scaled,T_scaled,me_scaled
0,595,64,-7354951.263164715,1.0,0.8351102798020111,0.1931640144337775,3.8450969387142617,0.003817856765341403,367866.21961236536,440500.1692705537,1904424.1790619912,2828962.5497757886,5.189191833602477e-09
0,596,64,-7354951.263164714,1.0,0.8351102798019676,0.19316401443371373,3.8450969387144203,0.0038178567653373175,367866.21961230773,440500.16927050764,1904424.1790623218,2828962.549775462,5.1891918335977365e-09
0,597,64,-7354951.263164716,1.0,0.8351102798019733,0.19316401443365794,3.8450969387141822,0.00381785676533285,367866.2196122727,440500.1692704627,1904424.1790626904,2828962.5497750174,5.189191833592159e-09
0,598,64,-7354951.263164716,1.0,0.835110279802015,0.19316401443373804,3.845096938713943,0.0038178567653382716,367866.21961234795,440500.1692705308,1904424.1790622903,2828962.54977542,5.189191833598466e-09
0,599,64,-7354951.26316472,1.0,0.8351102798019623,0.19316401443371273,3.8450969387144602,0.0038178567653367303,367866.2196123063,440500.1692705087,1904424.179062324,2828962.5497754803,5.189191833596959e-09



## simulate real data
# mu = 2.8e-9
# recombination_rate = 1.76E-8 / 2 = 8.9E-9

gIMble/./gIMble makeconfig -l sympatric.intergenic.X_inverted.64bp.kmax2.model4.sims -t simulate -m 4
[+] Wrote INI file 'gimble.simulate.IM_AB.sympatric.intergenic.X_inverted.64bp.kmax2.model4.sims.config.ini'. Please fill in values before starting 'simulate'.
[*] Total runtime was 00h:00m:00.004s

gIMble/./gIMble makeconfig -l allopatric.intergenic.X_inverted.64bp.kmax2.model4.sims -t simulate -m 4
[+] Wrote INI file 'gimble.simulate.IM_AB.allopatric.intergenic.X_inverted.64bp.kmax2.model4.sims.config.ini'. Please fill in values before starting 'simulate'.
[*] Total runtime was 00h:00m:00.005s

# blocks: 7787904 / 81 = 96147
gIMble/./gIMble simulate -o /scratch/npoikela/2simulate.montana.flavomontana.sympatric.intergenic.X_inverted.64bp.IM_AB_model4 -c gimble.simulate.IM_AB.sympatric.intergenic.X_inverted.64bp.kmax2.model4.sims.config.ini -t 30

# blocks: 2605017 / 27 = 96482
gIMble/./gIMble simulate -o /scratch/npoikela/2simulate.montana.flavomontana.allopatric.intergenic.X_inverted.64bp.IM_AB_model4 -c gimble.simulate.IM_AB.allopatric.intergenic.X_inverted.64bp.kmax2.model4.sims.config.ini -t 30


gIMble/./gIMble optimize -z /scratch/npoikela/2simulate.montana.flavomontana.sympatric.intergenic.X_inverted.64bp.IM_AB_model4.z -c gimble.optimize.IM_AB.sympatric.intergenic.X_inverted.64bp.kmax2.model4.config.ini -s sympatric.intergenic.X_inverted.64bp.kmax2.model4.sims -i 1000 --xtol 0.000000000000001 --ftol 0.000000000000001 -n 30 -f

results: gimble.optimize.sympatric.intergenic.X_inverted.64bp.kmax2.model4.0.20230215_142140.log

# fetching the final iterations for each replicate
awk -F, '$2 > max[$1] { max[$1] = $2; m[$1] = $0 }
     END { for (i in m) { print m[i] } }' gimble.optimize.sympatric.intergenic.X_inverted.64bp.kmax2.model4.0.20230215_142140.log > gimble.optimize.sympatric.intergenic.X_inverted.64bp.kmax2.model4.0.20230215_142140.final_iteration.log


gIMble/./gIMble optimize -z /scratch/npoikela/2simulate.montana.flavomontana.allopatric.intergenic.X_inverted.64bp.IM_AB_model4.z -c gimble.optimize.IM_AB.allopatric.intergenic.X_inverted.64bp.kmax2.model4.config.ini -s allopatric.intergenic.X_inverted.64bp.kmax2.model4.sims -i 1000 --xtol 0.000000000000001 --ftol 0.000000000000001 -n 30 -f

results: gimble.optimize.allopatric.intergenic.X_inverted.64bp.kmax2.model4.0.20230215_142127.log

# fetching the final iterations for each replicate
awk -F, '$2 > max[$1] { max[$1] = $2; m[$1] = $0 }
     END { for (i in m) { print m[i] } }' gimble.optimize.allopatric.intergenic.X_inverted.64bp.kmax2.model4.0.20230215_142127.log > gimble.optimize.allopatric.intergenic.X_inverted.64bp.kmax2.model4.0.20230215_142127.final_iteration.log





### X colinear, intergenic
bedtools intersect -a gimble2.D_montana.ref_genome.non_repeats.intergenic.sorted.bed -b X_collinear.bed > gimble2.D_montana.ref_genome.non_repeats.intergenic.X_collinear.bed
sort -k1,1V -k2,2n -k3,3n gimble2.D_montana.ref_genome.non_repeats.intergenic.X_collinear.bed > gimble2.D_montana.ref_genome.non_repeats.intergenic.X_collinear.sorted.bed

## measure
gIMble/./gIMble measure -f -g gimble2.X.genomefile -b gimble2.D_montana.ref_genome.non_repeats.intergenic.X_collinear.sorted.bed -s gimble2.samples.montana.flavomontana.sympatric.csv -v gimble2.vcf.gz -z /scratch/npoikela/2montana.flavomontana.sympatric.intergenic.X_collinear.64bp

gIMble/./gIMble measure -f -g gimble2.X.genomefile -b gimble2.D_montana.ref_genome.non_repeats.intergenic.X_collinear.sorted.bed -s gimble2.samples.montana.flavomontana.allopatric.csv -v gimble2.vcf.gz -z /scratch/npoikela/2montana.flavomontana.allopatric.intergenic.X_collinear.64bp


## blocks
gIMble/./gIMble blocks -z /scratch/npoikela/2montana.flavomontana.sympatric.intergenic.X_collinear.64bp.z -l 64 -f
gIMble/./gIMble blocks -z /scratch/npoikela/2montana.flavomontana.allopatric.intergenic.X_collinear.64bp.z -l 64 -f

## tally
gIMble/./gIMble tally -z /scratch/npoikela/2montana.flavomontana.sympatric.intergenic.X_collinear.64bp.z -d blocks -l sympatric.intergenic.X_collinear.64bp.kmax2.IM_model4 -k 2,2,2,2 -s X_chromosome --overwrite
[+] Found 5,665,086 blocks on 1 sequence(s).
[+] Percentage of blocks treated as marginals (w/ kmax = [2 2 2 2]) = 29.62%
[+] Tally'ing variation data ...
[+] Tally saved under label 'sympatric.intergenic.X_collinear.64bp.kmax2.IM_model4' (use this for optimize/gridsearch).
[+] Tally is accessible with the key 'tally/sympatric.intergenic.X_collinear.64bp.kmax2.IM_model4' (use this for query).
[*] Total runtime was 00h:00m:15.370s

gIMble/./gIMble tally -z /scratch/npoikela/2montana.flavomontana.allopatric.intergenic.X_collinear.64bp.z -d blocks -l allopatric.intergenic.X_collinear.64bp.kmax2.IM_model4 -k 2,2,2,2 -s X_chromosome --overwrite
[+] Found 1,897,388 blocks on 1 sequence(s).
[+] Percentage of blocks treated as marginals (w/ kmax = [2 2 2 2]) = 30.01%
[+] Tally'ing variation data ...
[+] Tally saved under label 'allopatric.intergenic.X_collinear.64bp.kmax2.IM_model4' (use this for optimize/gridsearch).
[+] Tally is accessible with the key 'tally/allopatric.intergenic.X_collinear.64bp.kmax2.IM_model4' (use this for query).
[*] Total runtime was 00h:00m:04.856s


# mu = 2.8e-9
gIMble/./gIMble makeconfig -l sympatric.intergenic.X_collinear.64bp.kmax2.model4 -t optimize -m 4
[+] Wrote INI file 'gimble.optimize.IM_AB.sympatric.intergenic.X_collinear.64bp.kmax2.model4.config.ini'. Please fill in values before starting 'optimize'.
[*] Total runtime was 00h:00m:00.005s

[parameters]
# Model parameters and their values/ranges:
# A) Fixed : value
# B) Range : min, max
# Effective population size of A
Ne_A = 100000, 600000
# Effective population size of B
Ne_B = 100000, 900000
# Effective population size of A_B
Ne_A_B = 100000, 1800000
# Split time (in generations)
T = 1500000, 4500000
# Migration rate (migrants/generation) from A to B (backwards in time)
me = 1e-12, 1e-07

gIMble/./gIMble makeconfig -l allopatric.intergenic.X_collinear.64bp.kmax2.model4 -t optimize -m 4
[+] Wrote INI file 'gimble.optimize.IM_AB.allopatric.intergenic.X_collinear.64bp.kmax2.model4.config.ini'. Please fill in values before starting 'optimize'.
[*] Total runtime was 00h:00m:00.027s

[parameters]
# Model parameters and their values/ranges:
# A) Fixed : value
# B) Range : min, max
# Effective population size of A
Ne_A = 100000, 600000
# Effective population size of B
Ne_B = 100000, 900000
# Effective population size of A_B
Ne_A_B = 100000, 2200000
# Split time (in generations)
T = 1500000, 4500000
# Migration rate (migrants/generation) from A to B (backwards in time)
me = 1e-12, 1e-07


gIMble/./gIMble optimize -z /scratch/npoikela/2montana.flavomontana.sympatric.intergenic.X_collinear.64bp.z -c gimble.optimize.IM_AB.sympatric.intergenic.X_collinear.64bp.kmax2.model4.config.ini -t sympatric.intergenic.X_collinear.64bp.kmax2.IM_model4 -i 1000 --xtol 0.00000000000000001 --ftol 0.00000000000000001 -f -n 30

results: gimble.optimize.sympatric.intergenic.X_collinear.64bp.kmax2.model4.0.20230209_161217.log

dataset_idx,iteration,block_length,likelihood,Ne_A_unscaled,Ne_B_unscaled,Ne_A_B_unscaled,T_unscaled,me_unscaled,Ne_A_scaled,Ne_B_scaled,Ne_A_B_scaled,T_scaled,me_scaled
0,527,64,-15298703.069602082,1.0,0.4430374860107196,0.13727891614966825,6.334306912615685,0.008831084364316389,218532.96707719343,493260.6697571995,1591890.2421908549,2768509.7679829644,2.020538247027265e-08
0,528,64,-15298703.069602115,1.0,0.4430374860109308,0.13727891614963433,6.334306912612568,0.00883108436432329,218532.9670772497,493260.6697570913,1591890.242191658,2768509.7679823153,2.0205382470283238e-08
0,529,64,-15298703.069602078,1.0,0.44303748601109866,0.13727891614963816,6.334306912611143,0.008831084364334047,218532.96707728764,493260.66975699004,1591890.2421918898,2768509.767982173,2.020538247030434e-08
0,530,64,-15298703.069602063,1.0,0.44303748601146165,0.13727891614959226,6.334306912606211,0.008831084364348013,218532.96707738162,493260.6697567981,1591890.2421931068,2768509.767981208,2.0205382470327608e-08
0,531,64,-15298703.069602095,1.0,0.4430374860112278,0.13727891614960397,6.334306912608778,0.008831084364335946,218532.96707732507,493260.6697569308,1591890.242192559,2768509.767981613,2.0205382470305228e-08

 
gIMble/./gIMble optimize -z /scratch/npoikela/2montana.flavomontana.allopatric.intergenic.X_collinear.64bp.z -c gimble.optimize.IM_AB.allopatric.intergenic.X_collinear.64bp.kmax2.model4.config.ini -t allopatric.intergenic.X_collinear.64bp.kmax2.IM_model4 -i 1000 --xtol 0.00000000000000001 --ftol 0.00000000000000001 -f -n 30

results: gimble.optimize.allopatric.intergenic.X_collinear.64bp.kmax2.model4.0.20230209_161059.log

dataset_idx,iteration,block_length,likelihood,Ne_A_unscaled,Ne_B_unscaled,Ne_A_B_unscaled,T_unscaled,me_unscaled,Ne_A_scaled,Ne_B_scaled,Ne_A_B_scaled,T_scaled,me_scaled
0,600,64,-5043728.114321071,1.0,0.5065508651824914,0.13216532384512247,5.798523747631474,0.00741205629705936,224623.83530493057,443437.867239664,1699567.0934696556,2604973.2865994023,1.649881965330476e-08
0,601,64,-5043728.114321063,1.0,0.50655086518252,0.13216532384513174,5.798523747631289,0.007412056297058015,224623.8353049426,443437.8672396627,1699567.0934696272,2604973.286599458,1.649881965330088e-08
0,602,64,-5043728.114321059,1.0,0.5065508651824563,0.13216532384512159,5.79852374763164,0.007412056297060681,224623.83530492056,443437.867239675,1699567.0934695913,2604973.2865993604,1.6498819653308435e-08
0,603,64,-5043728.114321087,1.0,0.506550865182595,0.13216532384515614,5.79852374763102,0.007412056297055286,224623.83530497423,443437.86723965954,1699567.0934695532,2604973.286599704,1.6498819653292484e-08
0,604,64,-5043728.114321079,1.0,0.5065508651825187,0.13216532384511778,5.79852374763101,0.00741205629705706,224623.8353049358,443437.86723965046,1699567.0934697557,2604973.2865992542,1.6498819653299254e-08


## simulate real data
# mu = 2.8e-9
# recombination_rate = 1.76E-8 / 2 = 8.9E-9

gIMble/./gIMble makeconfig -l sympatric.intergenic.X_collinear.64bp.kmax2.model4.sims -t simulate -m 4
[+] Wrote INI file 'gimble.simulate.IM_AB.sympatric.intergenic.X_collinear.64bp.kmax2.model4.sims.config.ini'. Please fill in values before starting 'simulate'.
[*] Total runtime was 00h:00m:00.004s

gIMble/./gIMble makeconfig -l allopatric.intergenic.X_collinear.64bp.kmax2.model4.sims -t simulate -m 4
[+] Wrote INI file 'gimble.simulate.IM_AB.allopatric.intergenic.X_collinear.64bp.kmax2.model4.sims.config.ini'. Please fill in values before starting 'simulate'.
[*] Total runtime was 00h:00m:00.005s


# blocks: 5665086 / 81 = 69939
gIMble/./gIMble simulate -o /scratch/npoikela/2simulate.montana.flavomontana.sympatric.intergenic.X_collinear.64bp.IM_AB_model4 -c gimble.simulate.IM_AB.sympatric.intergenic.X_collinear.64bp.kmax2.model4.sims.config.ini -t 30

# blocks: 1897388 / 27 = 70274
gIMble/./gIMble simulate -o /scratch/npoikela/2simulate.montana.flavomontana.allopatric.intergenic.X_collinear.64bp.IM_AB_model4 -c gimble.simulate.IM_AB.allopatric.intergenic.X_collinear.64bp.kmax2.model4.sims.config.ini -t 30


gIMble/./gIMble optimize -z /scratch/npoikela/2simulate.montana.flavomontana.sympatric.intergenic.X_collinear.64bp.IM_AB_model4.z -c gimble.optimize.IM_AB.sympatric.intergenic.X_collinear.64bp.kmax2.model4.config.ini -s sympatric.intergenic.X_collinear.64bp.kmax2.model4.sims -i 1000 --xtol 0.000000000000001 --ftol 0.000000000000001 -n 30 -f

results: gimble.optimize.sympatric.intergenic.X_collinear.64bp.kmax2.model4.0.20230217_042828.log

# fetching the final iterations for each replicate
awk -F, '$2 > max[$1] { max[$1] = $2; m[$1] = $0 }
     END { for (i in m) { print m[i] } }' gimble.optimize.sympatric.intergenic.X_collinear.64bp.kmax2.model4.0.20230217_042828.log > gimble.optimize.sympatric.intergenic.X_collinear.64bp.kmax2.model4.0.20230217_042828.final_iteration.log


gIMble/./gIMble optimize -z /scratch/npoikela/2simulate.montana.flavomontana.allopatric.intergenic.X_collinear.64bp.IM_AB_model4.z -c gimble.optimize.IM_AB.allopatric.intergenic.X_collinear.64bp.kmax2.model4.config.ini -s allopatric.intergenic.X_collinear.64bp.kmax2.model4.sims -i 1000 --xtol 0.000000000000001 --ftol 0.000000000000001 -n 30 -f

results: gimble.optimize.allopatric.intergenic.X_collinear.64bp.kmax2.model4.0.20230216_192331.log

# fetching the final iterations for each replicate
awk -F, '$2 > max[$1] { max[$1] = $2; m[$1] = $0 }
     END { for (i in m) { print m[i] } }' gimble.optimize.allopatric.intergenic.X_collinear.64bp.kmax2.model4.0.20230216_192331.log > gimble.optimize.allopatric.intergenic.X_collinear.64bp.kmax2.model4.0.20230216_192331.final_iteration.log









#### Plotting intergenic regions ####

# modify bed file
bedtools intersect -a gimble2.bed -b D_montana.ref_genome.non_repeats.intergenic.sorted.bed > gimble2.D_montana.ref_genome.non_repeats.intergenic.bed
sort -k1,1V -k2,2n gimble2.D_montana.ref_genome.non_repeats.intergenic.bed > gimble2.D_montana.ref_genome.non_repeats.intergenic.sorted.bed

# create zarr storage
gIMble/./gIMble measure -f -g gimble2.genomefile -b gimble2.D_montana.ref_genome.non_repeats.intergenic.sorted.bed -s gimble2.samples.montana.flavomontana.sympatric.csv -v gimble2.vcf.gz -z /scratch/npoikela/2montana.flavomontana.sympatric.intergenic_regions_for_plotting.64bp
gIMble/./gIMble measure -f -g gimble2.genomefile -b gimble2.D_montana.ref_genome.non_repeats.intergenic.sorted.bed -s gimble2.samples.montana.flavomontana.allopatric.csv -v gimble2.vcf.gz -z /scratch/npoikela/2montana.flavomontana.allopatric.intergenic_regions_for_plotting.64bp
gIMble/./gIMble measure -f -g gimble2.genomefile -b gimble2.D_montana.ref_genome.non_repeats.intergenic.sorted.bed -s gimble2.samples.montana.allopatric.sympatric.csv -v gimble2.vcf.gz -z /scratch/npoikela/2montana.allopatric.sympatric.intergenic_regions_for_plotting.64bp

# blocks
gIMble/./gIMble blocks -f -z /scratch/npoikela/2montana.flavomontana.sympatric.intergenic_regions_for_plotting.64bp.z -l 64
gIMble/./gIMble blocks -f -z /scratch/npoikela/2montana.flavomontana.allopatric.intergenic_regions_for_plotting.64bp.z -l 64
gIMble/./gIMble blocks -f -z /scratch/npoikela/2montana.allopatric.sympatric.intergenic_regions_for_plotting.64bp.z -l 64

# windows
gIMble/./gIMble windows -z /scratch/npoikela/2montana.flavomontana.sympatric.intergenic_regions_for_plotting.64bp.z -w 405000 -s 40500 -f
gIMble/./gIMble windows -z /scratch/npoikela/2montana.flavomontana.allopatric.intergenic_regions_for_plotting.64bp.z -w 135000 -s 13500 -f
gIMble/./gIMble windows -z /scratch/npoikela/2montana.allopatric.sympatric.intergenic_regions_for_plotting.64bp.z -w 135000 -s 13500 -f

# fetch the windows
gIMble/./gIMble query -z /scratch/npoikela/2montana.flavomontana.sympatric.intergenic_regions_for_plotting.64bp.z -l windows
gIMble/./gIMble query -z /scratch/npoikela/2montana.flavomontana.allopatric.intergenic_regions_for_plotting.64bp.z -l windows
gIMble/./gIMble query -z /scratch/npoikela/2montana.allopatric.sympatric.intergenic_regions_for_plotting.64bp.z -l windows




#### Calculating Dxy, Fst and pi ####

bedtools intersect -a gimble2.bed -b D_montana.ref_genome.non_repeats.intergenic.sorted.bed > gimble2.D_montana.ref_genome.non_repeats.intergenic.bed
sort -k1,1V -k2,2n gimble2.D_montana.ref_genome.non_repeats.intergenic.bed > gimble2.D_montana.ref_genome.non_repeats.intergenic.sorted.bed

bedtools intersect -a gimble2.bed -b D_montana.ref_genome.non_repeats.introns.sorted.merged.bed > gimble2.D_montana.ref_genome.non_repeats.introns.bed
sort -k1,1V -k2,2n gimble2.D_montana.ref_genome.non_repeats.introns.bed > gimble2.D_montana.ref_genome.non_repeats.introns.sorted.merged.bed

bedtools intersect -a gimble2.bed -b D_montana.ref_genome.non_repeats.CDS.sorted.merged.bed > gimble2.D_montana.ref_genome.non_repeats.CDS.bed
sort -k1,1V -k2,2n gimble2.D_montana.ref_genome.non_repeats.CDS.bed > gimble2.D_montana.ref_genome.non_repeats.CDS.sorted.merged.bed


## sympatry, intergenic

# collinear autosomes

bedtools intersect -a gimble2.D_montana.ref_genome.non_repeats.intergenic.sorted.bed -b autosomes_collinear.bed > gimble2.D_montana.ref_genome.non_repeats.intergenic.autosomes_collinear.bed
sort -k1,1V -k2,2n -k3,3n gimble2.D_montana.ref_genome.non_repeats.intergenic.autosomes_collinear.bed > gimble2.D_montana.ref_genome.non_repeats.intergenic.autosomes_collinear.sorted.bed

gIMble/./gIMble measure -f -g gimble2.autosomes.genomefile -b gimble2.D_montana.ref_genome.non_repeats.intergenic.autosomes_collinear.sorted.bed -s gimble2.samples.montana.flavomontana.sympatric.csv -v gimble2.vcf.gz -z /scratch/npoikela/2montana.flavomontana.sympatric.intergenic.autosomes_collinear.64bp

gIMble/./gIMble blocks -z /scratch/npoikela/2montana.flavomontana.sympatric.intergenic.autosomes_collinear.64bp.z -l 64 -f

gIMble/./gIMble info -z /scratch/npoikela/2montana.flavomontana.sympatric.intergenic.autosomes_collinear.64bp.z

# gimble v0.7.1
[+] [ =========================================== Storage =========================================== ]
[+] 2montana.flavomontana.sympatric.intergenic.autosomes_collinear.64bp.z .......... 454.9 MB | 100.00%
[+] ├── blocks ..................................................................... 389.8 MB |  85.69%
[+] ├── seqs ........................................................................ 65.1 MB |  14.31%
[+] └── tally ........................................................................ 7.2 KB |   0.00%
[+] [ ========================================= Parsed data ========================================= ]
[+] seqs
[+] ├── genome .................................... 116,312,519 b in 5 sequence(s) (n50 = 26,508,887 b)
[+] ├── populations ....................................................... 18 samples in 2 populations
[+] │  ├── A = flavomontana                                                                           9
[+] │  └── B = montana                                                                                9
[+] ├── sample sets ............................................................................... 153
[+] │  ├── INTER-population sample-sets (X)                                                          81
[+] │  ├── INTRA-population sample-sets (A)                                                          36
[+] │  └── INTRA-population sample-sets (B)                                                          36
[+] ├── variants ........................................................... 3,045,138 (26.18 per 1 kb)
[+] │  │                                                                 HOMREF  HOMALT     HET    MISS
[+] │  ├── fla3Fall                                                      58.49%  30.32%   6.11%   5.08%
[+] │  ├── flaASH13F2                                                    57.40%  28.60%   6.20%   7.80%
[+] │  ├── flaCRAN14F7                                                   58.22%  29.92%   6.90%   4.96%
[+] │  ├── flaJX13F31                                                    57.93%  29.68%   6.87%   5.52%
[+] │  ├── flaLB15F3                                                     58.40%  29.89%   5.86%   5.85%
[+] │  ├── flaMB14F10                                                    58.60%  30.23%   6.17%   4.99%
[+] │  ├── flaMT13F11                                                    57.78%  29.21%   6.40%   6.61%
[+] │  ├── flaTER14F5                                                    58.61%  30.27%   6.14%   4.98%
[+] │  ├── flaVAN14F20                                                   58.26%  29.65%   6.58%   5.51%
[+] │  ├── mon4Fall                                                      80.92%   5.90%  12.06%   1.11%
[+] │  ├── monAF15F28                                                    80.27%   5.02%  13.41%   1.30%
[+] │  ├── monASH13F13                                                   80.49%   5.09%  12.89%   1.52%
[+] │  ├── monAZA2                                                       80.82%   5.92%  12.12%   1.15%
[+] │  ├── monCRAN14F16                                                  80.15%   5.55%  13.29%   1.01%
[+] │  ├── monJX13F48                                                    79.28%   5.05%  14.34%   1.33%
[+] │  ├── monMB14F1                                                     80.61%   4.63%  13.07%   1.70%
[+] │  ├── monTER14F11                                                   81.75%   5.36%  11.90%   0.99%
[+] │  └── monVAN14F1                                                    80.18%   4.85%  13.22%   1.76%
[+] └── intervals .......................... 1,356,755 intervals across 36,297,468 b (31.21% of genome)
[+] [ ============================================ Blocks =========================================== ]
[+] blocks
[+] ├── '-l 64 -m 128 -u 3 -i 3' .................................  79,515,551 blocks (0.16% discarded)
[+] │                                                                     X             A             B
[+] ├── BED interval sites in blocks (estimated %)                   90.76%        90.45%        94.79%
[+] ├── Total blocks                                             41,694,658    18,468,216    19,352,677
[+] ├── Invariant blocks                                             20.79%        61.44%        41.52%
[+] ├── Four-gamete-violation blocks                                  0.72%         0.22%         0.99%
[+] ├── Heterozygosity (population A)                               0.00541       0.00537             -
[+] ├── Heterozygosity (population B)                               0.01028             -       0.01076
[+] ├── D_xy                                                        0.03004             -             -
[+] ├── F_st                                                        0.58566             -             -
[+] ├── Pi                                                                -       0.00550       0.01127
[+] └── Watterson theta                                                   -       0.00548       0.01133
[+] [ =========================================== Windows =========================================== ]
[+] [ =========================================== Tallies =========================================== ]
[+] Tally
[+] └── 'tally/blocks_raw' .......................................................  shape (9, 9, 9, 9)




# 4 inversion

bedtools intersect -a gimble2.D_montana.ref_genome.non_repeats.intergenic.sorted.bed -b 4_inverted.bed > gimble2.D_montana.ref_genome.non_repeats.intergenic.4_inverted.bed
sort -k1,1V -k2,2n -k3,3n gimble2.D_montana.ref_genome.non_repeats.intergenic.4_inverted.bed > gimble2.D_montana.ref_genome.non_repeats.intergenic.4_inverted.sorted.bed

gIMble/./gIMble measure -f -g gimble.4.genomefile -b gimble.D_montana.ref_genome.non_repeats.intergenic.4_inverted.sorted.bed -s gimble.samples.montana.flavomontana.sympatric.csv -v gimble.vcf.gz -z /scratch/npoikela/montana.flavomontana.sympatric.intergenic.4_inverted.64bp

gIMble/./gIMble blocks -z /scratch/npoikela/montana.flavomontana.sympatric.intergenic.4_inverted.64bp.z -l 64 -f

gIMble/./gIMble info -z /scratch/npoikela/montana.flavomontana.sympatric.intergenic.4_inverted.64bp.z

# gimble v0.7.1
[+] [ =========================================== Storage =========================================== ]
[+] 2montana.flavomontana.sympatric.intergenic.4_inverted.64bp.z .................... 94.5 MB | 100.00%
[+] ├── blocks ...................................................................... 78.8 MB |  83.39%
[+] ├── seqs ........................................................................ 15.7 MB |  16.60%
[+] └── tally ........................................................................ 5.1 KB |   0.01%
[+] [ ========================================= Parsed data ========================================= ]
[+] seqs
[+] ├── genome ..................................... 32,544,174 b in 1 sequence(s) (n50 = 32,544,174 b)
[+] ├── populations ....................................................... 18 samples in 2 populations
[+] │  ├── A = flavomontana                                                                           9
[+] │  └── B = montana                                                                                9
[+] ├── sample sets ............................................................................... 153
[+] │  ├── INTER-population sample-sets (X)                                                          81
[+] │  ├── INTRA-population sample-sets (A)                                                          36
[+] │  └── INTRA-population sample-sets (B)                                                          36
[+] ├── variants ............................................................. 664,323 (20.41 per 1 kb)
[+] │  │                                                                 HOMREF  HOMALT     HET    MISS
[+] │  ├── fla3Fall                                                      56.13%  31.47%   6.46%   5.93%
[+] │  ├── flaASH13F2                                                    54.41%  28.84%   6.88%   9.87%
[+] │  ├── flaCRAN14F7                                                   56.28%  31.36%   6.46%   5.89%
[+] │  ├── flaJX13F31                                                    55.75%  30.79%   6.37%   7.09%
[+] │  ├── flaLB15F3                                                     55.95%  30.69%   6.22%   7.14%
[+] │  ├── flaMB14F10                                                    56.30%  31.33%   6.46%   5.91%
[+] │  ├── flaMT13F11                                                    55.14%  29.83%   6.66%   8.37%
[+] │  ├── flaTER14F5                                                    56.34%  31.36%   6.35%   5.96%
[+] │  ├── flaVAN14F20                                                   55.88%  30.44%   6.92%   6.76%
[+] │  ├── mon4Fall                                                      81.04%   6.46%  11.78%   0.72%
[+] │  ├── monAF15F28                                                    77.33%   6.17%  15.49%   1.01%
[+] │  ├── monASH13F13                                                   79.67%   6.05%  13.04%   1.24%
[+] │  ├── monAZA2                                                       79.99%   6.19%  13.19%   0.64%
[+] │  ├── monCRAN14F16                                                  77.31%   6.55%  15.36%   0.78%
[+] │  ├── monJX13F48                                                    76.94%   6.00%  15.88%   1.18%
[+] │  ├── monMB14F1                                                     79.79%   5.38%  13.19%   1.64%
[+] │  ├── monTER14F11                                                   82.07%  10.22%   6.42%   1.30%
[+] │  └── monVAN14F1                                                    80.14%   5.99%  12.02%   1.85%
[+] └── intervals ............................. 291,221 intervals across 7,099,504 b (21.81% of genome)
[+] [ ============================================ Blocks =========================================== ]
[+] blocks
[+] ├── '-l 64 -m 128 -u 3 -i 3' .................................  15,368,815 blocks (0.11% discarded)
[+] │                                                                     X             A             B
[+] ├── BED interval sites in blocks (estimated %)                   89.30%        88.73%        95.19%
[+] ├── Total blocks                                              8,024,216     3,543,358     3,801,241
[+] ├── Invariant blocks                                             17.03%        55.38%        35.74%
[+] ├── Four-gamete-violation blocks                                  0.75%         0.29%         0.86%
[+] ├── Heterozygosity (population A)                               0.00638       0.00631             -
[+] ├── Heterozygosity (population B)                               0.01148             -       0.01213
[+] ├── D_xy                                                        0.03495             -             -
[+] ├── F_st                                                        0.59295             -             -
[+] ├── Pi                                                                -       0.00656       0.01308
[+] └── Watterson theta                                                   -       0.00654       0.01307
[+] [ =========================================== Windows =========================================== ]
[+] [ =========================================== Tallies =========================================== ]
[+] Tally
[+] └── 'tally/blocks_raw' .......................................................  shape (9, 9, 9, 9)



# 5 inversion

bedtools intersect -a gimble2.D_montana.ref_genome.non_repeats.intergenic.sorted.bed -b 5_inverted.bed > gimble2.D_montana.ref_genome.non_repeats.intergenic.5_inverted.bed
sort -k1,1V -k2,2n -k3,3n gimble2.D_montana.ref_genome.non_repeats.intergenic.5_inverted.bed > gimble2.D_montana.ref_genome.non_repeats.intergenic.5_inverted.sorted.bed

gIMble/./gIMble measure -f -g gimble.5.genomefile -b gimble.D_montana.ref_genome.non_repeats.intergenic.5_inverted.sorted.bed -s gimble.samples.montana.flavomontana.sympatric.csv -v gimble.vcf.gz -z /scratch/npoikela/montana.flavomontana.sympatric.intergenic.5_inverted.64bp

gIMble/./gIMble blocks -z /scratch/npoikela/montana.flavomontana.sympatric.intergenic.5_inverted.64bp.z -l 64 -f

gIMble/./gIMble info -z /scratch/npoikela/montana.flavomontana.sympatric.intergenic.5_inverted.64bp.z

# gimble v0.7.1
[+] [ =========================================== Storage =========================================== ]
[+] 2montana.flavomontana.sympatric.intergenic.5_inverted.64bp.z .................... 53.0 MB | 100.00%
[+] ├── blocks ...................................................................... 45.7 MB |  86.27%
[+] ├── seqs ......................................................................... 7.3 MB |  13.72%
[+] └── tally ........................................................................ 4.4 KB |   0.01%
[+] [ ========================================= Parsed data ========================================= ]
[+] seqs
[+] ├── genome ..................................... 26,508,887 b in 1 sequence(s) (n50 = 26,508,887 b)
[+] ├── populations ....................................................... 18 samples in 2 populations
[+] │  ├── A = flavomontana                                                                           9
[+] │  └── B = montana                                                                                9
[+] ├── sample sets ............................................................................... 153
[+] │  ├── INTER-population sample-sets (X)                                                          81
[+] │  ├── INTRA-population sample-sets (A)                                                          36
[+] │  └── INTRA-population sample-sets (B)                                                          36
[+] ├── variants ............................................................. 345,062 (13.02 per 1 kb)
[+] │  │                                                                 HOMREF  HOMALT     HET    MISS
[+] │  ├── fla3Fall                                                      58.30%  31.45%   5.87%   4.38%
[+] │  ├── flaASH13F2                                                    57.16%  29.57%   6.46%   6.81%
[+] │  ├── flaCRAN14F7                                                   58.20%  31.37%   6.03%   4.40%
[+] │  ├── flaJX13F31                                                    57.94%  31.06%   6.08%   4.93%
[+] │  ├── flaLB15F3                                                     58.14%  31.03%   5.70%   5.14%
[+] │  ├── flaMB14F10                                                    58.30%  31.36%   5.98%   4.35%
[+] │  ├── flaMT13F11                                                    57.59%  30.40%   6.32%   5.69%
[+] │  ├── flaTER14F5                                                    58.26%  31.34%   5.99%   4.40%
[+] │  ├── flaVAN14F20                                                   58.06%  30.78%   6.44%   4.73%
[+] │  ├── mon4Fall                                                      83.07%   4.58%  11.99%   0.37%
[+] │  ├── monAF15F28                                                    82.69%   4.54%  12.12%   0.65%
[+] │  ├── monASH13F13                                                   82.52%   4.55%  12.06%   0.87%
[+] │  ├── monAZA2                                                       82.84%   4.68%  12.05%   0.43%
[+] │  ├── monCRAN14F16                                                  82.87%   4.59%  12.19%   0.36%
[+] │  ├── monJX13F48                                                    82.34%   4.46%  12.45%   0.76%
[+] │  ├── monMB14F1                                                     81.58%   4.38%  12.33%   1.70%
[+] │  ├── monTER14F11                                                   83.01%   4.44%  12.17%   0.38%
[+] │  └── monVAN14F1                                                    82.43%   4.39%  12.17%   1.01%
[+] └── intervals ............................. 138,253 intervals across 4,117,807 b (15.53% of genome)
[+] [ ============================================ Blocks =========================================== ]
[+] blocks
[+] ├── '-l 64 -m 128 -u 3 -i 3' ..................................  9,090,761 blocks (0.09% discarded)
[+] │                                                                     X             A             B
[+] ├── BED interval sites in blocks (estimated %)                   91.47%        91.22%        95.44%
[+] ├── Total blocks                                              4,767,237     2,112,827     2,210,697
[+] ├── Invariant blocks                                             19.87%        60.91%        41.58%
[+] ├── Four-gamete-violation blocks                                  0.55%         0.18%         0.79%
[+] ├── Heterozygosity (population A)                               0.00525       0.00521             -
[+] ├── Heterozygosity (population B)                               0.00969             -       0.01016
[+] ├── D_xy                                                        0.03092             -             -
[+] ├── F_st                                                        0.61096             -             -
[+] ├── Pi                                                                -       0.00536       0.01047
[+] └── Watterson theta                                                   -       0.00536       0.01058
[+] [ =========================================== Windows =========================================== ]
[+] [ =========================================== Tallies =========================================== ]
[+] Tally
[+] └── 'tally/blocks_raw' .......................................................  shape (9, 9, 9, 9)




# collinear X chromosome

bedtools intersect -a gimble.D_montana.ref_genome.non_repeats.intergenic.sorted.bed -b X_collinear.bed > gimble.D_montana.ref_genome.non_repeats.intergenic.X_collinear.bed
sort -k1,1V -k2,2n -k3,3n gimble.D_montana.ref_genome.non_repeats.intergenic.X_collinear.bed > gimble.D_montana.ref_genome.non_repeats.intergenic.X_collinear.sorted.bed

gIMble/./gIMble measure -f -g gimble.X.genomefile -b gimble.D_montana.ref_genome.non_repeats.intergenic.X_collinear.sorted.bed -s gimble.samples.montana.flavomontana.sympatric.csv -v gimble.vcf.gz -z /scratch/npoikela/montana.flavomontana.sympatric.intergenic.X_collinear.64bp

gIMble/./gIMble blocks -z /scratch/npoikela/montana.flavomontana.sympatric.intergenic.X_collinear.64bp.z -l 64 -f

gIMble/./gIMble info -z /scratch/npoikela/montana.flavomontana.sympatric.intergenic.X_collinear.64bp.z

# gimble v0.7.1
[+] [ =========================================== Storage =========================================== ]
[+] 2montana.flavomontana.sympatric.intergenic.X_collinear.64bp.z .................. 125.9 MB | 100.00%
[+] ├── blocks ..................................................................... 104.0 MB |  82.62%
[+] ├── seqs ........................................................................ 21.9 MB |  17.38%
[+] └── tally ........................................................................ 6.3 KB |   0.00%
[+] [ ========================================= Parsed data ========================================= ]
[+] seqs
[+] ├── genome ..................................... 29,140,820 b in 1 sequence(s) (n50 = 29,140,820 b)
[+] ├── populations ....................................................... 18 samples in 2 populations
[+] │  ├── A = flavomontana                                                                           9
[+] │  └── B = montana                                                                                9
[+] ├── sample sets ............................................................................... 153
[+] │  ├── INTER-population sample-sets (X)                                                          81
[+] │  ├── INTRA-population sample-sets (A)                                                          36
[+] │  └── INTRA-population sample-sets (B)                                                          36
[+] ├── variants ............................................................. 798,068 (27.39 per 1 kb)
[+] │  │                                                                 HOMREF  HOMALT     HET    MISS
[+] │  ├── fla3Fall                                                      43.27%  38.90%   7.40%  10.43%
[+] │  ├── flaASH13F2                                                    42.56%  37.43%   7.10%  12.91%
[+] │  ├── flaCRAN14F7                                                   43.23%  38.78%   7.55%  10.44%
[+] │  ├── flaJX13F31                                                    42.86%  38.58%   8.02%  10.54%
[+] │  ├── flaLB15F3                                                     43.02%  38.23%   8.27%  10.48%
[+] │  ├── flaMB14F10                                                    43.37%  38.74%   7.41%  10.48%
[+] │  ├── flaMT13F11                                                    42.60%  37.73%   8.43%  11.25%
[+] │  ├── flaTER14F5                                                    43.49%  38.86%   7.43%  10.23%
[+] │  ├── flaVAN14F20                                                   42.98%  38.02%   8.57%  10.43%
[+] │  ├── mon4Fall                                                      78.82%   4.16%  11.86%   5.16%
[+] │  ├── monAF15F28                                                    77.83%   4.04%  12.48%   5.65%
[+] │  ├── monASH13F13                                                   77.61%   4.01%  12.49%   5.89%
[+] │  ├── monAZA2                                                       78.82%   4.14%  11.97%   5.06%
[+] │  ├── monCRAN14F16                                                  78.70%   4.15%  12.04%   5.12%
[+] │  ├── monJX13F48                                                    77.55%   4.06%  12.58%   5.81%
[+] │  ├── monMB14F1                                                     78.54%   3.99%  13.55%   3.92%
[+] │  ├── monTER14F11                                                   78.76%   4.02%  12.06%   5.16%
[+] │  └── monVAN14F1                                                    77.57%   3.99%  12.55%   5.89%
[+] └── intervals ............................ 649,749 intervals across 11,751,252 b (40.33% of genome)
[+] [ ============================================ Blocks =========================================== ]
[+] blocks
[+] ├── '-l 64 -m 128 -u 3 -i 3' .................................  24,982,861 blocks (0.62% discarded)
[+] │                                                                     X             A             B
[+] ├── BED interval sites in blocks (estimated %)                   87.33%        87.17%        94.29%
[+] ├── Total blocks                                             12,988,091     5,762,055     6,232,715
[+] ├── Invariant blocks                                             19.93%        74.64%        55.30%
[+] ├── Four-gamete-violation blocks                                  0.79%         0.18%         0.47%
[+] ├── Heterozygosity (population A)                               0.00458       0.00458             -
[+] ├── Heterozygosity (population B)                               0.00725             -       0.00783
[+] ├── D_xy                                                        0.03194             -             -
[+] ├── F_st                                                        0.68757             -             -
[+] ├── Pi                                                                -       0.00421       0.00763
[+] └── Watterson theta                                                   -       0.00404       0.00760
[+] [ =========================================== Windows =========================================== ]
[+] [ =========================================== Tallies =========================================== ]
[+] Tally
[+] └── 'tally/blocks_raw' .......................................................  shape (9, 9, 9, 9)





# X inversions

bedtools intersect -a gimble2.D_montana.ref_genome.non_repeats.intergenic.sorted.bed -b X_inverted.bed > gimble2.D_montana.ref_genome.non_repeats.intergenic.X_inverted.bed
sort -k1,1V -k2,2n -k3,3n gimble2.D_montana.ref_genome.non_repeats.intergenic.X_inverted.bed > gimble2.D_montana.ref_genome.non_repeats.intergenic.X_inverted.sorted.bed

gIMble/./gIMble measure -f -g gimble2.X.genomefile -b gimble2.D_montana.ref_genome.non_repeats.intergenic.X_inverted.sorted.bed -s gimble2.samples.montana.flavomontana.sympatric.csv -v gimble2.vcf.gz -z /scratch/npoikela/2montana.flavomontana.sympatric.intergenic.X_inverted.64bp

gIMble/./gIMble blocks -z /scratch/npoikela/2montana.flavomontana.sympatric.intergenic.X_inverted.64bp.z -l 64 -f

gIMble/./gIMble info -z /scratch/npoikela/2montana.flavomontana.sympatric.intergenic.X_inverted.64bp.z

# gimble v0.7.1
[+] [ =========================================== Storage =========================================== ]
[+] 2montana.flavomontana.sympatric.intergenic.X_inverted.64bp.z ................... 175.5 MB | 100.00%
[+] ├── blocks ..................................................................... 145.8 MB |  83.08%
[+] ├── seqs ........................................................................ 29.7 MB |  16.91%
[+] └── tally ........................................................................ 5.8 KB |   0.00%
[+] [ ========================================= Parsed data ========================================= ]
[+] seqs
[+] ├── genome ..................................... 29,140,820 b in 1 sequence(s) (n50 = 29,140,820 b)
[+] ├── populations ....................................................... 18 samples in 2 populations
[+] │  ├── A = flavomontana                                                                           9
[+] │  └── B = montana                                                                                9
[+] ├── sample sets ............................................................................... 153
[+] │  ├── INTER-population sample-sets (X)                                                          81
[+] │  ├── INTRA-population sample-sets (A)                                                          36
[+] │  └── INTRA-population sample-sets (B)                                                          36
[+] ├── variants ........................................................... 1,161,612 (39.86 per 1 kb)
[+] │  │                                                                 HOMREF  HOMALT     HET    MISS
[+] │  ├── fla3Fall                                                      48.05%  39.96%   5.26%   6.74%
[+] │  ├── flaASH13F2                                                    46.95%  37.94%   5.41%   9.70%
[+] │  ├── flaCRAN14F7                                                   46.59%  38.76%   8.14%   6.51%
[+] │  ├── flaJX13F31                                                    46.41%  38.52%   8.25%   6.82%
[+] │  ├── flaLB15F3                                                     47.72%  39.33%   5.36%   7.58%
[+] │  ├── flaMB14F10                                                    46.71%  38.72%   8.27%   6.30%
[+] │  ├── flaMT13F11                                                    45.82%  37.57%   8.36%   8.24%
[+] │  ├── flaTER14F5                                                    48.10%  39.89%   5.30%   6.71%
[+] │  ├── flaVAN14F20                                                   47.67%  38.92%   6.07%   7.35%
[+] │  ├── mon4Fall                                                      82.31%   5.36%  11.07%   1.26%
[+] │  ├── monAF15F28                                                    81.64%   5.30%  11.26%   1.80%
[+] │  ├── monASH13F13                                                   81.34%   5.27%  11.07%   2.32%
[+] │  ├── monAZA2                                                       82.49%   5.52%  10.81%   1.17%
[+] │  ├── monCRAN14F16                                                  82.37%   5.40%  11.08%   1.15%
[+] │  ├── monJX13F48                                                    81.39%   5.35%  11.63%   1.63%
[+] │  ├── monMB14F1                                                     81.37%   5.19%  11.40%   2.03%
[+] │  ├── monTER14F11                                                   82.48%   5.33%  11.07%   1.12%
[+] │  └── monVAN14F1                                                    81.17%   5.20%  11.22%   2.41%
[+] └── intervals ............................ 674,102 intervals across 15,129,926 b (51.92% of genome)
[+] [ ============================================ Blocks =========================================== ]
[+] blocks
[+] ├── '-l 64 -m 128 -u 3 -i 3' .................................  33,510,876 blocks (0.35% discarded)
[+] │                                                                     X             A             B
[+] ├── BED interval sites in blocks (estimated %)                   91.36%        90.94%        97.26%
[+] ├── Total blocks                                             17,494,353     7,739,164     8,277,359
[+] ├── Invariant blocks                                             17.57%        65.50%        46.76%
[+] ├── Four-gamete-violation blocks                                  0.70%         0.21%         0.63%
[+] ├── Heterozygosity (population A)                               0.00518       0.00511             -
[+] ├── Heterozygosity (population B)                               0.00787             -       0.00849
[+] ├── D_xy                                                        0.03484             -             -
[+] ├── F_st                                                        0.68470             -             -
[+] ├── Pi                                                                -       0.00485       0.00870
[+] └── Watterson theta                                                   -       0.00479       0.00877
[+] [ =========================================== Windows =========================================== ]
[+] [ =========================================== Tallies =========================================== ]
[+] Tally
[+] └── 'tally/blocks_raw' .......................................................  shape (9, 9, 9, 9)






## sympatry, introns

# collinear autosomes

bedtools intersect -a gimble.D_montana.ref_genome.non_repeats.introns.sorted.merged.bed -b autosomes_collinear.bed > gimble.D_montana.ref_genome.non_repeats.introns.autosomes_collinear.bed
sort -k1,1V -k2,2n -k3,3n gimble.D_montana.ref_genome.non_repeats.introns.autosomes_collinear.bed > gimble.D_montana.ref_genome.non_repeats.introns.autosomes_collinear.sorted.bed

gIMble/./gIMble measure -f -g gimble.autosomes.genomefile -b gimble.D_montana.ref_genome.non_repeats.introns.autosomes_collinear.sorted.bed -s gimble.samples.montana.flavomontana.sympatric.csv -v gimble.vcf.gz -z /scratch/npoikela/montana.flavomontana.sympatric.introns.autosomes_collinear.64bp

gIMble/./gIMble blocks -z /scratch/npoikela/montana.flavomontana.sympatric.introns.autosomes_collinear.64bp.z -l 64 -f

gIMble/./gIMble info -z /scratch/npoikela/montana.flavomontana.sympatric.introns.autosomes_collinear.64bp.z

# gimble v0.7.1
[+] [ =========================================== Storage =========================================== ]
[+] 2montana.flavomontana.sympatric.introns.autosomes_collinear.64bp.z ............. 248.1 MB | 100.00%
[+] ├── blocks ..................................................................... 212.0 MB |  85.42%
[+] ├── seqs ........................................................................ 36.2 MB |  14.57%
[+] └── tally ........................................................................ 6.5 KB |   0.00%
[+] [ ========================================= Parsed data ========================================= ]
[+] seqs
[+] ├── genome .................................... 116,312,519 b in 5 sequence(s) (n50 = 26,508,887 b)
[+] ├── populations ....................................................... 18 samples in 2 populations
[+] │  ├── A = flavomontana                                                                           9
[+] │  └── B = montana                                                                                9
[+] ├── sample sets ............................................................................... 153
[+] │  ├── INTER-population sample-sets (X)                                                          81
[+] │  ├── INTRA-population sample-sets (A)                                                          36
[+] │  └── INTRA-population sample-sets (B)                                                          36
[+] ├── variants ........................................................... 1,671,519 (14.37 per 1 kb)
[+] │  │                                                                 HOMREF  HOMALT     HET    MISS
[+] │  ├── fla3Fall                                                      57.47%  31.56%   5.89%   5.08%
[+] │  ├── flaASH13F2                                                    56.58%  30.02%   5.81%   7.59%
[+] │  ├── flaCRAN14F7                                                   57.18%  31.12%   6.84%   4.86%
[+] │  ├── flaJX13F31                                                    56.93%  30.97%   6.71%   5.38%
[+] │  ├── flaLB15F3                                                     57.35%  31.21%   5.72%   5.72%
[+] │  ├── flaMB14F10                                                    57.56%  31.45%   6.01%   4.97%
[+] │  ├── flaMT13F11                                                    56.84%  30.58%   6.16%   6.43%
[+] │  ├── flaTER14F5                                                    57.62%  31.51%   5.94%   4.93%
[+] │  ├── flaVAN14F20                                                   57.28%  30.94%   6.33%   5.46%
[+] │  ├── mon4Fall                                                      80.86%   5.99%  12.16%   0.98%
[+] │  ├── monAF15F28                                                    80.29%   5.16%  13.50%   1.04%
[+] │  ├── monASH13F13                                                   80.45%   5.19%  13.02%   1.35%
[+] │  ├── monAZA2                                                       80.80%   5.95%  12.25%   0.99%
[+] │  ├── monCRAN14F16                                                  80.23%   5.62%  13.32%   0.83%
[+] │  ├── monJX13F48                                                    79.47%   5.17%  14.30%   1.07%
[+] │  ├── monMB14F1                                                     80.63%   4.85%  13.02%   1.50%
[+] │  ├── monTER14F11                                                   81.71%   5.45%  12.04%   0.79%
[+] │  └── monVAN14F1                                                    80.17%   4.91%  13.39%   1.54%
[+] └── intervals ............................ 726,823 intervals across 19,574,474 b (16.83% of genome)
[+] [ ============================================ Blocks =========================================== ]
[+] blocks
[+] ├── '-l 64 -m 128 -u 3 -i 3' .................................  40,971,450 blocks (0.16% discarded)
[+] │                                                                     X             A             B
[+] ├── BED interval sites in blocks (estimated %)                   86.66%        86.34%        90.78%
[+] ├── Total blocks                                             21,469,578     9,506,466     9,995,406
[+] ├── Invariant blocks                                             20.03%        61.47%        41.79%
[+] ├── Four-gamete-violation blocks                                  0.71%         0.23%         1.03%
[+] ├── Heterozygosity (population A)                               0.00536       0.00530             -
[+] ├── Heterozygosity (population B)                               0.01035             -       0.01087
[+] ├── D_xy                                                        0.03102             -             -
[+] ├── F_st                                                        0.59591             -             -
[+] ├── Pi                                                                -       0.00546       0.01140
[+] └── Watterson theta                                                   -       0.00544       0.01145
[+] [ =========================================== Windows =========================================== ]
[+] [ =========================================== Tallies =========================================== ]
[+] Tally
[+] └── 'tally/blocks_raw' .......................................................  shape (9, 9, 9, 9)





# 4 inversion

bedtools intersect -a gimble.D_montana.ref_genome.non_repeats.introns.sorted.merged.bed -b 4_inverted.bed > gimble.D_montana.ref_genome.non_repeats.introns.4_inverted.bed
sort -k1,1V -k2,2n -k3,3n gimble.D_montana.ref_genome.non_repeats.introns.4_inverted.bed > gimble.D_montana.ref_genome.non_repeats.introns.4_inverted.sorted.bed

gIMble/./gIMble measure -f -g gimble.4.genomefile -b gimble.D_montana.ref_genome.non_repeats.introns.4_inverted.sorted.bed -s gimble.samples.montana.flavomontana.sympatric.csv -v gimble.vcf.gz -z /scratch/npoikela/montana.flavomontana.sympatric.introns.4_inverted.64bp

gIMble/./gIMble blocks -z /scratch/npoikela/montana.flavomontana.sympatric.introns.4_inverted.64bp.z -l 64 -f

gIMble/./gIMble info -z /scratch/npoikela/montana.flavomontana.sympatric.introns.4_inverted.64bp.z

# gimble v0.7.1
[+] [ =========================================== Storage =========================================== ]
[+] 2montana.flavomontana.sympatric.introns.4_inverted.64bp.z ....................... 40.3 MB | 100.00%
[+] ├── blocks ...................................................................... 33.6 MB |  83.46%
[+] ├── seqs ......................................................................... 6.7 MB |  16.53%
[+] └── tally ........................................................................ 4.5 KB |   0.01%
[+] [ ========================================= Parsed data ========================================= ]
[+] seqs
[+] ├── genome ..................................... 32,544,174 b in 1 sequence(s) (n50 = 32,544,174 b)
[+] ├── populations ....................................................... 18 samples in 2 populations
[+] │  ├── A = flavomontana                                                                           9
[+] │  └── B = montana                                                                                9
[+] ├── sample sets ............................................................................... 153
[+] │  ├── INTER-population sample-sets (X)                                                          81
[+] │  ├── INTRA-population sample-sets (A)                                                          36
[+] │  └── INTRA-population sample-sets (B)                                                          36
[+] ├── variants .............................................................. 292,678 (8.99 per 1 kb)
[+] │  │                                                                 HOMREF  HOMALT     HET    MISS
[+] │  ├── fla3Fall                                                      55.58%  32.09%   6.33%   6.01%
[+] │  ├── flaASH13F2                                                    53.97%  29.67%   7.02%   9.34%
[+] │  ├── flaCRAN14F7                                                   55.59%  32.03%   6.32%   6.05%
[+] │  ├── flaJX13F31                                                    55.12%  31.60%   6.39%   6.89%
[+] │  ├── flaLB15F3                                                     55.46%  31.42%   6.26%   6.86%
[+] │  ├── flaMB14F10                                                    55.59%  31.99%   6.40%   6.02%
[+] │  ├── flaMT13F11                                                    54.69%  30.75%   6.54%   8.02%
[+] │  ├── flaTER14F5                                                    55.68%  32.07%   6.32%   5.93%
[+] │  ├── flaVAN14F20                                                   55.32%  31.16%   7.07%   6.45%
[+] │  ├── mon4Fall                                                      80.75%   6.26%  12.25%   0.74%
[+] │  ├── monAF15F28                                                    76.89%   6.15%  15.95%   1.01%
[+] │  ├── monASH13F13                                                   79.20%   6.17%  13.34%   1.29%
[+] │  ├── monAZA2                                                       79.42%   6.35%  13.41%   0.81%
[+] │  ├── monCRAN14F16                                                  76.86%   6.65%  15.60%   0.89%
[+] │  ├── monJX13F48                                                    76.24%   6.10%  16.43%   1.22%
[+] │  ├── monMB14F1                                                     79.46%   5.49%  13.44%   1.61%
[+] │  ├── monTER14F11                                                   81.44%  10.41%   6.58%   1.57%
[+] │  └── monVAN14F1                                                    79.47%   6.00%  12.69%   1.84%
[+] └── intervals .............................. 123,050 intervals across 3,028,337 b (9.31% of genome)
[+] [ ============================================ Blocks =========================================== ]
[+] blocks
[+] ├── '-l 64 -m 128 -u 3 -i 3' ..................................  6,270,169 blocks (0.10% discarded)
[+] │                                                                     X             A             B
[+] ├── BED interval sites in blocks (estimated %)                   85.31%        84.89%        91.26%
[+] ├── Total blocks                                              3,269,707     1,445,977     1,554,485
[+] ├── Invariant blocks                                             15.89%        54.58%        34.39%
[+] ├── Four-gamete-violation blocks                                  0.80%         0.29%         0.94%
[+] ├── Heterozygosity (population A)                               0.00662       0.00656             -
[+] ├── Heterozygosity (population B)                               0.01216             -       0.01286
[+] ├── D_xy                                                        0.03663             -             -
[+] ├── F_st                                                        0.59193             -             -
[+] ├── Pi                                                                -       0.00678       0.01381
[+] └── Watterson theta                                                   -       0.00676       0.01379
[+] [ =========================================== Windows =========================================== ]
[+] [ =========================================== Tallies =========================================== ]
[+] Tally
[+] └── 'tally/blocks_raw' .......................................................  shape (9, 9, 9, 9)




# 5 inversion

bedtools intersect -a gimble.D_montana.ref_genome.non_repeats.introns.sorted.merged.bed -b 5_inverted.bed > gimble.D_montana.ref_genome.non_repeats.introns.5_inverted.bed
sort -k1,1V -k2,2n -k3,3n gimble.D_montana.ref_genome.non_repeats.introns.5_inverted.bed > gimble.D_montana.ref_genome.non_repeats.introns.5_inverted.sorted.bed

gIMble/./gIMble measure -f -g gimble.5.genomefile -b gimble.D_montana.ref_genome.non_repeats.introns.5_inverted.sorted.bed -s gimble.samples.montana.flavomontana.sympatric.csv -v gimble.vcf.gz -z /scratch/npoikela/montana.flavomontana.sympatric.introns.5_inverted.64bp

gIMble/./gIMble blocks -z /scratch/npoikela/montana.flavomontana.sympatric.introns.5_inverted.64bp.z -l 64 -f

gIMble/./gIMble info -z /scratch/npoikela/montana.flavomontana.sympatric.introns.5_inverted.64bp.z

# gimble v0.7.1
[+] [ =========================================== Storage =========================================== ]
[+] 2montana.flavomontana.sympatric.introns.5_inverted.64bp.z ....................... 28.4 MB | 100.00%
[+] ├── blocks ...................................................................... 24.2 MB |  85.01%
[+] ├── seqs ......................................................................... 4.3 MB |  14.97%
[+] └── tally ........................................................................ 3.9 KB |   0.01%
[+] [ ========================================= Parsed data ========================================= ]
[+] seqs
[+] ├── genome ..................................... 26,508,887 b in 1 sequence(s) (n50 = 26,508,887 b)
[+] ├── populations ....................................................... 18 samples in 2 populations
[+] │  ├── A = flavomontana                                                                           9
[+] │  └── B = montana                                                                                9
[+] ├── sample sets ............................................................................... 153
[+] │  ├── INTER-population sample-sets (X)                                                          81
[+] │  ├── INTRA-population sample-sets (A)                                                          36
[+] │  └── INTRA-population sample-sets (B)                                                          36
[+] ├── variants .............................................................. 197,123 (7.44 per 1 kb)
[+] │  │                                                                 HOMREF  HOMALT     HET    MISS
[+] │  ├── fla3Fall                                                      57.59%  32.07%   5.77%   4.58%
[+] │  ├── flaASH13F2                                                    56.41%  30.38%   6.32%   6.89%
[+] │  ├── flaCRAN14F7                                                   57.51%  32.10%   5.86%   4.53%
[+] │  ├── flaJX13F31                                                    57.34%  31.99%   5.79%   4.89%
[+] │  ├── flaLB15F3                                                     57.56%  32.00%   5.36%   5.09%
[+] │  ├── flaMB14F10                                                    57.59%  32.04%   5.86%   4.51%
[+] │  ├── flaMT13F11                                                    56.91%  31.14%   6.14%   5.82%
[+] │  ├── flaTER14F5                                                    57.64%  32.05%   5.81%   4.49%
[+] │  ├── flaVAN14F20                                                   57.51%  31.65%   6.01%   4.83%
[+] │  ├── mon4Fall                                                      82.11%   4.73%  12.76%   0.40%
[+] │  ├── monAF15F28                                                    81.74%   4.81%  12.66%   0.79%
[+] │  ├── monASH13F13                                                   81.70%   4.61%  12.75%   0.93%
[+] │  ├── monAZA2                                                       82.17%   4.78%  12.59%   0.46%
[+] │  ├── monCRAN14F16                                                  82.25%   4.87%  12.50%   0.39%
[+] │  ├── monJX13F48                                                    81.50%   4.68%  13.15%   0.67%
[+] │  ├── monMB14F1                                                     80.53%   4.51%  13.20%   1.76%
[+] │  ├── monTER14F11                                                   82.14%   4.51%  12.91%   0.44%
[+] │  └── monVAN14F1                                                    81.58%   4.50%  12.89%   1.03%
[+] └── intervals ............................... 79,172 intervals across 2,210,464 b (8.34% of genome)
[+] [ ============================================ Blocks =========================================== ]
[+] blocks
[+] ├── '-l 64 -m 128 -u 3 -i 3' ..................................  4,569,020 blocks (0.12% discarded)
[+] │                                                                     X             A             B
[+] ├── BED interval sites in blocks (estimated %)                   85.50%        85.19%        89.90%
[+] ├── Total blocks                                              2,391,953     1,059,300     1,117,767
[+] ├── Invariant blocks                                             18.12%        60.13%        38.88%
[+] ├── Four-gamete-violation blocks                                  0.63%         0.20%         0.98%
[+] ├── Heterozygosity (population A)                               0.00541       0.00536             -
[+] ├── Heterozygosity (population B)                               0.01073             -       0.01119
[+] ├── D_xy                                                        0.03312             -             -
[+] ├── F_st                                                        0.60825             -             -
[+] ├── Pi                                                                -       0.00552       0.01153
[+] └── Watterson theta                                                   -       0.00551       0.01163
[+] [ =========================================== Windows =========================================== ]
[+] [ =========================================== Tallies =========================================== ]
[+] Tally
[+] └── 'tally/blocks_raw' .......................................................  shape (9, 9, 9, 9)




# collinear X chromosome

bedtools intersect -a gimble.D_montana.ref_genome.non_repeats.introns.sorted.merged.bed -b X_collinear.bed > gimble.D_montana.ref_genome.non_repeats.introns.X_collinear.bed
sort -k1,1V -k2,2n -k3,3n gimble.D_montana.ref_genome.non_repeats.introns.X_collinear.bed > gimble.D_montana.ref_genome.non_repeats.introns.X_collinear.sorted.bed

gIMble/./gIMble measure -f -g gimble.X.genomefile -b gimble.D_montana.ref_genome.non_repeats.introns.X_collinear.sorted.bed -s gimble.samples.montana.flavomontana.sympatric.csv -v gimble.vcf.gz -z /scratch/npoikela/montana.flavomontana.sympatric.introns.X_collinear.64bp

gIMble/./gIMble blocks -z /scratch/npoikela/montana.flavomontana.sympatric.introns.X_collinear.64bp.z -l 64 -f

gIMble/./gIMble info -z /scratch/npoikela/montana.flavomontana.sympatric.introns.X_collinear.64bp.z

# gimble v0.7.1
[+] [ =========================================== Storage =========================================== ]
[+] 2montana.flavomontana.sympatric.introns.X_collinear.64bp.z ...................... 38.1 MB | 100.00%
[+] ├── blocks ...................................................................... 32.3 MB |  84.56%
[+] ├── seqs ......................................................................... 5.9 MB |  15.43%
[+] └── tally ........................................................................ 5.0 KB |   0.01%
[+] [ ========================================= Parsed data ========================================= ]
[+] seqs
[+] ├── genome ..................................... 29,140,820 b in 1 sequence(s) (n50 = 29,140,820 b)
[+] ├── populations ....................................................... 18 samples in 2 populations
[+] │  ├── A = flavomontana                                                                           9
[+] │  └── B = montana                                                                                9
[+] ├── sample sets ............................................................................... 153
[+] │  ├── INTER-population sample-sets (X)                                                          81
[+] │  ├── INTRA-population sample-sets (A)                                                          36
[+] │  └── INTRA-population sample-sets (B)                                                          36
[+] ├── variants .............................................................. 223,820 (7.68 per 1 kb)
[+] │  │                                                                 HOMREF  HOMALT     HET    MISS
[+] │  ├── fla3Fall                                                      45.30%  41.07%   6.20%   7.42%
[+] │  ├── flaASH13F2                                                    44.58%  39.39%   5.75%  10.27%
[+] │  ├── flaCRAN14F7                                                   45.19%  40.92%   6.37%   7.52%
[+] │  ├── flaJX13F31                                                    45.02%  40.80%   6.48%   7.70%
[+] │  ├── flaLB15F3                                                     45.14%  40.46%   6.42%   7.98%
[+] │  ├── flaMB14F10                                                    45.42%  40.94%   6.25%   7.39%
[+] │  ├── flaMT13F11                                                    44.54%  39.90%   6.83%   8.73%
[+] │  ├── flaTER14F5                                                    45.46%  41.02%   6.20%   7.32%
[+] │  ├── flaVAN14F20                                                   45.02%  40.12%   7.12%   7.75%
[+] │  ├── mon4Fall                                                      81.47%   4.57%  11.61%   2.35%
[+] │  ├── monAF15F28                                                    80.44%   4.52%  11.82%   3.22%
[+] │  ├── monASH13F13                                                   80.21%   4.40%  11.82%   3.56%
[+] │  ├── monAZA2                                                       81.30%   4.49%  11.80%   2.41%
[+] │  ├── monCRAN14F16                                                  81.27%   4.63%  11.69%   2.41%
[+] │  ├── monJX13F48                                                    80.02%   4.37%  12.39%   3.22%
[+] │  ├── monMB14F1                                                     80.66%   4.35%  12.58%   2.41%
[+] │  ├── monTER14F11                                                   81.50%   4.55%  11.44%   2.51%
[+] │  └── monVAN14F1                                                    80.27%   4.35%  11.95%   3.43%
[+] └── intervals ............................. 156,624 intervals across 3,083,326 b (10.58% of genome)
[+] [ ============================================ Blocks =========================================== ]
[+] blocks
[+] ├── '-l 64 -m 128 -u 3 -i 3' ..................................  6,519,268 blocks (0.43% discarded)
[+] │                                                                     X             A             B
[+] ├── BED interval sites in blocks (estimated %)                   87.09%        86.86%        93.08%
[+] ├── Total blocks                                              3,398,567     1,506,405     1,614,296
[+] ├── Invariant blocks                                             16.58%        73.88%        51.49%
[+] ├── Four-gamete-violation blocks                                  0.79%         0.20%         0.61%
[+] ├── Heterozygosity (population A)                               0.00430       0.00423             -
[+] ├── Heterozygosity (population B)                               0.00780             -       0.00835
[+] ├── D_xy                                                        0.03498             -             -
[+] ├── F_st                                                        0.70519             -             -
[+] ├── Pi                                                                -       0.00406       0.00836
[+] └── Watterson theta                                                   -       0.00394       0.00836
[+] [ =========================================== Windows =========================================== ]
[+] [ =========================================== Tallies =========================================== ]
[+] Tally
[+] └── 'tally/blocks_raw' .......................................................  shape (9, 9, 9, 9)



# X inversions

bedtools intersect -a gimble.D_montana.ref_genome.non_repeats.introns.sorted.merged.bed -b X_inverted.bed > gimble.D_montana.ref_genome.non_repeats.introns.X_inverted.bed
sort -k1,1V -k2,2n -k3,3n gimble.D_montana.ref_genome.non_repeats.introns.X_inverted.bed > gimble.D_montana.ref_genome.non_repeats.introns.X_inverted.sorted.bed

gIMble/./gIMble measure -f -g gimble.X.genomefile -b gimble.D_montana.ref_genome.non_repeats.introns.X_inverted.sorted.bed -s gimble.samples.montana.flavomontana.sympatric.csv -v gimble.vcf.gz -z /scratch/npoikela/montana.flavomontana.sympatric.introns.X_inverted.64bp

gIMble/./gIMble blocks -z /scratch/npoikela/montana.flavomontana.sympatric.introns.X_inverted.64bp.z -l 64 -f

gIMble/./gIMble info -z /scratch/npoikela/montana.flavomontana.sympatric.introns.X_inverted.64bp.z

# gimble v0.7.1
[+] [ =========================================== Storage =========================================== ]
[+] 2montana.flavomontana.sympatric.introns.X_inverted.64bp.z ....................... 60.4 MB | 100.00%
[+] ├── blocks ...................................................................... 50.6 MB |  83.78%
[+] ├── seqs ......................................................................... 9.8 MB |  16.21%
[+] └── tally ........................................................................ 4.9 KB |   0.01%
[+] [ ========================================= Parsed data ========================================= ]
[+] seqs
[+] ├── genome ..................................... 29,140,820 b in 1 sequence(s) (n50 = 29,140,820 b)
[+] ├── populations ....................................................... 18 samples in 2 populations
[+] │  ├── A = flavomontana                                                                           9
[+] │  └── B = montana                                                                                9
[+] ├── sample sets ............................................................................... 153
[+] │  ├── INTER-population sample-sets (X)                                                          81
[+] │  ├── INTRA-population sample-sets (A)                                                          36
[+] │  └── INTRA-population sample-sets (B)                                                          36
[+] ├── variants ............................................................. 387,350 (13.29 per 1 kb)
[+] │  │                                                                 HOMREF  HOMALT     HET    MISS
[+] │  ├── fla3Fall                                                      48.25%  39.93%   5.21%   6.61%
[+] │  ├── flaASH13F2                                                    47.22%  38.04%   5.30%   9.45%
[+] │  ├── flaCRAN14F7                                                   46.85%  38.78%   8.08%   6.29%
[+] │  ├── flaJX13F31                                                    46.74%  38.59%   8.10%   6.57%
[+] │  ├── flaLB15F3                                                     47.91%  39.36%   5.26%   7.47%
[+] │  ├── flaMB14F10                                                    46.95%  38.69%   8.18%   6.17%
[+] │  ├── flaMT13F11                                                    46.12%  37.72%   8.24%   7.92%
[+] │  ├── flaTER14F5                                                    48.32%  39.93%   5.18%   6.57%
[+] │  ├── flaVAN14F20                                                   47.84%  38.96%   6.06%   7.14%
[+] │  ├── mon4Fall                                                      82.13%   5.52%  11.39%   0.96%
[+] │  ├── monAF15F28                                                    81.38%   5.52%  11.52%   1.58%
[+] │  ├── monASH13F13                                                   81.00%   5.47%  11.35%   2.18%
[+] │  ├── monAZA2                                                       82.26%   5.68%  11.15%   0.90%
[+] │  ├── monCRAN14F16                                                  82.17%   5.62%  11.31%   0.90%
[+] │  ├── monJX13F48                                                    81.21%   5.54%  11.84%   1.41%
[+] │  ├── monMB14F1                                                     81.41%   5.38%  11.62%   1.59%
[+] │  ├── monTER14F11                                                   82.23%   5.54%  11.35%   0.88%
[+] │  └── monVAN14F1                                                    81.03%   5.37%  11.47%   2.13%
[+] └── intervals ............................. 224,691 intervals across 4,654,742 b (15.97% of genome)
[+] [ ============================================ Blocks =========================================== ]
[+] blocks
[+] ├── '-l 64 -m 128 -u 3 -i 3' ..................................  9,944,115 blocks (0.37% discarded)
[+] │                                                                     X             A             B
[+] ├── BED interval sites in blocks (estimated %)                   87.92%        87.47%        94.50%
[+] ├── Total blocks                                              5,179,588     2,290,210     2,474,317
[+] ├── Invariant blocks                                             15.24%        63.15%        42.61%
[+] ├── Four-gamete-violation blocks                                  0.81%         0.24%         0.73%
[+] ├── Heterozygosity (population A)                               0.00563       0.00555             -
[+] ├── Heterozygosity (population B)                               0.00886             -       0.00950
[+] ├── D_xy                                                        0.03799             -             -
[+] ├── F_st                                                        0.67976             -             -
[+] ├── Pi                                                                -       0.00528       0.00973
[+] └── Watterson theta                                                   -       0.00521       0.00981
[+] [ =========================================== Windows =========================================== ]
[+] [ =========================================== Tallies =========================================== ]
[+] Tally
[+] └── 'tally/blocks_raw' .......................................................  shape (9, 9, 9, 9)





## sympatry, CDS

# collinear autosomes
bedtools intersect -a gimble.D_montana.ref_genome.non_repeats.CDS.sorted.merged.bed -b autosomes_collinear.bed > gimble.D_montana.ref_genome.non_repeats.CDS.autosomes_collinear.bed
sort -k1,1V -k2,2n -k3,3n gimble.D_montana.ref_genome.non_repeats.CDS.autosomes_collinear.bed > gimble.D_montana.ref_genome.non_repeats.CDS.autosomes_collinear.sorted.bed

gIMble/./gIMble measure -f -g gimble.autosomes.genomefile -b gimble.D_montana.ref_genome.non_repeats.CDS.autosomes_collinear.sorted.bed -s gimble.samples.montana.flavomontana.sympatric.csv -v gimble.vcf.gz -z /scratch/npoikela/montana.flavomontana.sympatric.CDS.autosomes_collinear.64bp

gIMble/./gIMble blocks -z /scratch/npoikela/montana.flavomontana.sympatric.CDS.autosomes_collinear.64bp.z -l 64 -f

gIMble/./gIMble info -z /scratch/npoikela/montana.flavomontana.sympatric.CDS.autosomes_collinear.64bp.z

# gimble v0.7.1
[+] [ =========================================== Storage =========================================== ]
[+] 2montana.flavomontana.sympatric.CDS.autosomes_collinear.64bp.z ................. 140.0 MB | 100.00%
[+] ├── blocks ..................................................................... 129.1 MB |  92.21%
[+] ├── seqs ........................................................................ 10.9 MB |   7.79%
[+] └── tally ........................................................................ 5.0 KB |   0.00%
[+] [ ========================================= Parsed data ========================================= ]
[+] seqs
[+] ├── genome .................................... 116,312,519 b in 5 sequence(s) (n50 = 26,508,887 b)
[+] ├── populations ....................................................... 18 samples in 2 populations
[+] │  ├── A = flavomontana                                                                           9
[+] │  └── B = montana                                                                                9
[+] ├── sample sets ............................................................................... 153
[+] │  ├── INTER-population sample-sets (X)                                                          81
[+] │  ├── INTRA-population sample-sets (A)                                                          36
[+] │  └── INTRA-population sample-sets (B)                                                          36
[+] ├── variants .............................................................. 611,643 (5.26 per 1 kb)
[+] │  │                                                                 HOMREF  HOMALT     HET    MISS
[+] │  ├── fla3Fall                                                      56.86%  35.96%   6.03%   1.15%
[+] │  ├── flaASH13F2                                                    57.11%  35.98%   5.37%   1.54%
[+] │  ├── flaCRAN14F7                                                   56.44%  35.46%   6.92%   1.18%
[+] │  ├── flaJX13F31                                                    56.24%  35.57%   6.72%   1.47%
[+] │  ├── flaLB15F3                                                     56.59%  36.05%   5.38%   1.98%
[+] │  ├── flaMB14F10                                                    57.02%  35.89%   6.02%   1.06%
[+] │  ├── flaMT13F11                                                    56.39%  35.71%   5.83%   2.07%
[+] │  ├── flaTER14F5                                                    56.96%  35.92%   5.98%   1.14%
[+] │  ├── flaVAN14F20                                                   56.63%  35.75%   5.95%   1.67%
[+] │  ├── mon4Fall                                                      83.34%   4.61%  11.65%   0.39%
[+] │  ├── monAF15F28                                                    82.49%   3.93%  12.99%   0.58%
[+] │  ├── monASH13F13                                                   83.00%   4.01%  12.21%   0.78%
[+] │  ├── monAZA2                                                       83.17%   4.62%  11.70%   0.50%
[+] │  ├── monCRAN14F16                                                  82.51%   4.32%  12.69%   0.47%
[+] │  ├── monJX13F48                                                    81.81%   3.97%  13.66%   0.56%
[+] │  ├── monMB14F1                                                     79.91%   3.68%  11.68%   4.73%
[+] │  ├── monTER14F11                                                   83.64%   4.23%  11.59%   0.54%
[+] │  └── monVAN14F1                                                    82.63%   3.96%  12.36%   1.05%
[+] └── intervals ............................ 134,276 intervals across 12,555,362 b (10.79% of genome)
[+] [ ============================================ Blocks =========================================== ]
[+] blocks
[+] ├── '-l 64 -m 128 -u 3 -i 3' .................................  27,494,058 blocks (0.31% discarded)
[+] │                                                                     X             A             B
[+] ├── BED interval sites in blocks (estimated %)                   91.51%        91.62%        91.79%
[+] ├── Total blocks                                             14,540,558     6,470,582     6,482,918
[+] ├── Invariant blocks                                             27.75%        76.10%        56.74%
[+] ├── Four-gamete-violation blocks                                  0.23%         0.03%         0.22%
[+] ├── Heterozygosity (population A)                               0.00288       0.00286             -
[+] ├── Heterozygosity (population B)                               0.00598             -       0.00602
[+] ├── D_xy                                                        0.02014             -             -
[+] ├── F_st                                                        0.63935             -             -
[+] ├── Pi                                                                -       0.00286       0.00607
[+] └── Watterson theta                                                   -       0.00284       0.00611
[+] [ =========================================== Windows =========================================== ]
[+] [ =========================================== Tallies =========================================== ]
[+] Tally
[+] └── 'tally/blocks_raw' .......................................................  shape (9, 9, 9, 9)






# 4 inversion

bedtools intersect -a gimble.D_montana.ref_genome.non_repeats.CDS.sorted.merged.bed -b 4_inverted.bed > gimble.D_montana.ref_genome.non_repeats.CDS.4_inverted.bed
sort -k1,1V -k2,2n -k3,3n gimble.D_montana.ref_genome.non_repeats.CDS.4_inverted.bed > gimble.D_montana.ref_genome.non_repeats.CDS.4_inverted.sorted.bed

gIMble/./gIMble measure -f -g gimble.4.genomefile -b gimble.D_montana.ref_genome.non_repeats.CDS.4_inverted.sorted.bed -s gimble.samples.montana.flavomontana.sympatric.csv -v gimble.vcf.gz -z /scratch/npoikela/montana.flavomontana.sympatric.CDS.4_inverted.64bp

gIMble/./gIMble blocks -z /scratch/npoikela/montana.flavomontana.sympatric.CDS.4_inverted.64bp.z -l 64 -f

gIMble/./gIMble info -z /scratch/npoikela/montana.flavomontana.sympatric.CDS.4_inverted.64bp.z

# gimble v0.7.1
[+] [ =========================================== Storage =========================================== ]
[+] 2montana.flavomontana.sympatric.CDS.4_inverted.64bp.z ........................... 21.0 MB | 100.00%
[+] ├── blocks ...................................................................... 19.3 MB |  91.76%
[+] ├── seqs ......................................................................... 1.7 MB |   8.22%
[+] └── tally ........................................................................ 3.0 KB |   0.01%
[+] [ ========================================= Parsed data ========================================= ]
[+] seqs
[+] ├── genome ..................................... 32,544,174 b in 1 sequence(s) (n50 = 32,544,174 b)
[+] ├── populations ....................................................... 18 samples in 2 populations
[+] │  ├── A = flavomontana                                                                           9
[+] │  └── B = montana                                                                                9
[+] ├── sample sets ............................................................................... 153
[+] │  ├── INTER-population sample-sets (X)                                                          81
[+] │  ├── INTRA-population sample-sets (A)                                                          36
[+] │  └── INTRA-population sample-sets (B)                                                          36
[+] ├── variants ............................................................... 97,011 (2.98 per 1 kb)
[+] │  │                                                                 HOMREF  HOMALT     HET    MISS
[+] │  ├── fla3Fall                                                      56.04%  36.81%   6.35%   0.80%
[+] │  ├── flaASH13F2                                                    55.97%  36.50%   6.19%   1.34%
[+] │  ├── flaCRAN14F7                                                   56.28%  36.70%   6.14%   0.89%
[+] │  ├── flaJX13F31                                                    55.82%  36.65%   6.40%   1.12%
[+] │  ├── flaLB15F3                                                     55.91%  36.80%   5.78%   1.51%
[+] │  ├── flaMB14F10                                                    56.47%  36.78%   6.03%   0.73%
[+] │  ├── flaMT13F11                                                    55.79%  36.50%   6.05%   1.66%
[+] │  ├── flaTER14F5                                                    56.50%  36.79%   6.03%   0.68%
[+] │  ├── flaVAN14F20                                                   55.84%  36.54%   6.36%   1.26%
[+] │  ├── mon4Fall                                                      84.07%   4.95%  10.77%   0.22%
[+] │  ├── monAF15F28                                                    80.09%   4.64%  14.76%   0.51%
[+] │  ├── monASH13F13                                                   82.49%   5.02%  11.88%   0.62%
[+] │  ├── monAZA2                                                       82.71%   4.94%  12.08%   0.27%
[+] │  ├── monCRAN14F16                                                  80.35%   5.11%  14.28%   0.26%
[+] │  ├── monJX13F48                                                    80.01%   4.63%  14.90%   0.45%
[+] │  ├── monMB14F1                                                     80.65%   4.35%  11.63%   3.36%
[+] │  ├── monTER14F11                                                   84.90%   8.36%   6.28%   0.46%
[+] │  └── monVAN14F1                                                    83.11%   4.90%  10.88%   1.11%
[+] └── intervals ............................... 18,736 intervals across 1,852,599 b (5.69% of genome)
[+] [ ============================================ Blocks =========================================== ]
[+] blocks
[+] ├── '-l 64 -m 128 -u 3 -i 3' ..................................  4,062,098 blocks (0.30% discarded)
[+] │                                                                     X             A             B
[+] ├── BED interval sites in blocks (estimated %)                   91.61%        91.74%        91.93%
[+] ├── Total blocks                                              2,148,087       956,039       957,972
[+] ├── Invariant blocks                                             24.12%        72.63%        53.22%
[+] ├── Four-gamete-violation blocks                                  0.22%         0.03%         0.15%
[+] ├── Heterozygosity (population A)                               0.00320       0.00320             -
[+] ├── Heterozygosity (population B)                               0.00624             -       0.00627
[+] ├── D_xy                                                        0.02203             -             -
[+] ├── F_st                                                        0.64720             -             -
[+] ├── Pi                                                                -       0.00323       0.00652
[+] └── Watterson theta                                                   -       0.00321       0.00654
[+] [ =========================================== Windows =========================================== ]
[+] [ =========================================== Tallies =========================================== ]
[+] Tally
[+] └── 'tally/blocks_raw' .......................................................  shape (9, 9, 9, 9)






# 5 inversion

bedtools intersect -a gimble.D_montana.ref_genome.non_repeats.CDS.sorted.merged.bed -b 5_inverted.bed > gimble.D_montana.ref_genome.non_repeats.CDS.5_inverted.bed
sort -k1,1V -k2,2n -k3,3n gimble.D_montana.ref_genome.non_repeats.CDS.5_inverted.bed > gimble.D_montana.ref_genome.non_repeats.CDS.5_inverted.sorted.bed

gIMble/./gIMble measure -f -g gimble.5.genomefile -b gimble.D_montana.ref_genome.non_repeats.CDS.5_inverted.sorted.bed -s gimble.samples.montana.flavomontana.sympatric.csv -v gimble.vcf.gz -z /scratch/npoikela/montana.flavomontana.sympatric.CDS.5_inverted.64bp

gIMble/./gIMble blocks -z /scratch/npoikela/montana.flavomontana.sympatric.CDS.5_inverted.64bp.z -l 64 -f

gIMble/./gIMble info -z /scratch/npoikela/montana.flavomontana.sympatric.CDS.5_inverted.64bp.z

# gimble v0.7.1
[+] [ =========================================== Storage =========================================== ]
[+] 2montana.flavomontana.sympatric.CDS.5_inverted.64bp.z ........................... 17.7 MB | 100.00%
[+] ├── blocks ...................................................................... 16.3 MB |  92.29%
[+] ├── seqs ......................................................................... 1.4 MB |   7.68%
[+] └── tally ........................................................................ 3.7 KB |   0.02%
[+] [ ========================================= Parsed data ========================================= ]
[+] seqs
[+] ├── genome ..................................... 26,508,887 b in 1 sequence(s) (n50 = 26,508,887 b)
[+] ├── populations ....................................................... 18 samples in 2 populations
[+] │  ├── A = flavomontana                                                                           9
[+] │  └── B = montana                                                                                9
[+] ├── sample sets ............................................................................... 153
[+] │  ├── INTER-population sample-sets (X)                                                          81
[+] │  ├── INTRA-population sample-sets (A)                                                          36
[+] │  └── INTRA-population sample-sets (B)                                                          36
[+] ├── variants ............................................................... 76,316 (2.88 per 1 kb)
[+] │  │                                                                 HOMREF  HOMALT     HET    MISS
[+] │  ├── fla3Fall                                                      58.56%  34.36%   6.09%   0.99%
[+] │  ├── flaASH13F2                                                    58.69%  34.19%   5.88%   1.25%
[+] │  ├── flaCRAN14F7                                                   58.35%  34.34%   6.17%   1.14%
[+] │  ├── flaJX13F31                                                    58.25%  34.31%   6.25%   1.19%
[+] │  ├── flaLB15F3                                                     58.28%  34.63%   5.28%   1.81%
[+] │  ├── flaMB14F10                                                    58.54%  34.33%   6.22%   0.91%
[+] │  ├── flaMT13F11                                                    58.18%  34.28%   6.13%   1.41%
[+] │  ├── flaTER14F5                                                    58.55%  34.49%   5.83%   1.12%
[+] │  ├── flaVAN14F20                                                   58.46%  34.26%   6.02%   1.27%
[+] │  ├── mon4Fall                                                      83.61%   3.67%  12.09%   0.63%
[+] │  ├── monAF15F28                                                    83.41%   3.86%  12.07%   0.67%
[+] │  ├── monASH13F13                                                   83.37%   3.52%  12.62%   0.49%
[+] │  ├── monAZA2                                                       83.40%   3.76%  12.34%   0.50%
[+] │  ├── monCRAN14F16                                                  83.68%   3.96%  11.83%   0.53%
[+] │  ├── monJX13F48                                                    82.93%   3.82%  12.51%   0.74%
[+] │  ├── monMB14F1                                                     80.09%   3.45%  12.17%   4.29%
[+] │  ├── monTER14F11                                                   83.43%   3.76%  12.29%   0.52%
[+] │  └── monVAN14F1                                                    83.27%   3.64%  12.28%   0.81%
[+] └── intervals ............................... 16,068 intervals across 1,538,721 b (5.80% of genome)
[+] [ ============================================ Blocks =========================================== ]
[+] blocks
[+] ├── '-l 64 -m 128 -u 3 -i 3' ..................................  3,348,357 blocks (0.28% discarded)
[+] │                                                                     X             A             B
[+] ├── BED interval sites in blocks (estimated %)                   90.96%        91.13%        91.06%
[+] ├── Total blocks                                              1,771,470       788,763       788,124
[+] ├── Invariant blocks                                             27.74%        76.37%        55.16%
[+] ├── Four-gamete-violation blocks                                  0.20%         0.02%         0.17%
[+] ├── Heterozygosity (population A)                               0.00290       0.00289             -
[+] ├── Heterozygosity (population B)                               0.00604             -       0.00608
[+] ├── D_xy                                                        0.01989             -             -
[+] ├── F_st                                                        0.63304             -             -
[+] ├── Pi                                                                -       0.00284       0.00611
[+] └── Watterson theta                                                   -       0.00281       0.00617
[+] [ =========================================== Windows =========================================== ]
[+] [ =========================================== Tallies =========================================== ]
[+] Tally
[+] └── 'tally/blocks_raw' .......................................................  shape (9, 9, 9, 9)





# collinear X chromosome

bedtools intersect -a gimble.D_montana.ref_genome.non_repeats.CDS.sorted.merged.bed -b X_collinear.bed > gimble.D_montana.ref_genome.non_repeats.CDS.X_collinear.bed
sort -k1,1V -k2,2n -k3,3n gimble.D_montana.ref_genome.non_repeats.CDS.X_collinear.bed > gimble.D_montana.ref_genome.non_repeats.CDS.X_collinear.sorted.bed

gIMble/./gIMble measure -f -g gimble.X.genomefile -b gimble.D_montana.ref_genome.non_repeats.CDS.X_collinear.sorted.bed -s gimble.samples.montana.flavomontana.sympatric.csv -v gimble.vcf.gz -z /scratch/npoikela/montana.flavomontana.sympatric.CDS.X_collinear.64bp

gIMble/./gIMble blocks -z /scratch/npoikela/montana.flavomontana.sympatric.CDS.X_collinear.64bp.z -l 64 -f

gIMble/./gIMble info -z /scratch/npoikela/montana.flavomontana.sympatric.CDS.X_collinear.64bp.z

# gimble v0.7.1
[+] [ =========================================== Storage =========================================== ]
[+] 2montana.flavomontana.sympatric.CDS.X_collinear.64bp.z .......................... 16.0 MB | 100.00%
[+] ├── blocks ...................................................................... 14.9 MB |  93.28%
[+] ├── seqs ......................................................................... 1.1 MB |   6.70%
[+] └── tally ........................................................................ 3.1 KB |   0.02%
[+] [ ========================================= Parsed data ========================================= ]
[+] seqs
[+] ├── genome ..................................... 29,140,820 b in 1 sequence(s) (n50 = 29,140,820 b)
[+] ├── populations ....................................................... 18 samples in 2 populations
[+] │  ├── A = flavomontana                                                                           9
[+] │  └── B = montana                                                                                9
[+] ├── sample sets ............................................................................... 153
[+] │  ├── INTER-population sample-sets (X)                                                          81
[+] │  ├── INTRA-population sample-sets (A)                                                          36
[+] │  └── INTRA-population sample-sets (B)                                                          36
[+] ├── variants ............................................................... 50,889 (1.75 per 1 kb)
[+] │  │                                                                 HOMREF  HOMALT     HET    MISS
[+] │  ├── fla3Fall                                                      48.50%  44.93%   5.34%   1.23%
[+] │  ├── flaASH13F2                                                    48.98%  45.48%   3.80%   1.74%
[+] │  ├── flaCRAN14F7                                                   48.46%  44.88%   5.46%   1.20%
[+] │  ├── flaJX13F31                                                    48.14%  44.96%   5.40%   1.49%
[+] │  ├── flaLB15F3                                                     48.28%  45.04%   4.84%   1.84%
[+] │  ├── flaMB14F10                                                    48.63%  44.91%   5.22%   1.24%
[+] │  ├── flaMT13F11                                                    48.02%  44.57%   5.26%   2.14%
[+] │  ├── flaTER14F5                                                    48.54%  44.89%   5.30%   1.28%
[+] │  ├── flaVAN14F20                                                   48.52%  44.98%   4.94%   1.56%
[+] │  ├── mon4Fall                                                      86.59%   3.30%   9.63%   0.48%
[+] │  ├── monAF15F28                                                    86.02%   3.57%   9.39%   1.02%
[+] │  ├── monASH13F13                                                   85.93%   3.25%   9.90%   0.92%
[+] │  ├── monAZA2                                                       86.07%   3.50%   9.86%   0.58%
[+] │  ├── monCRAN14F16                                                  86.37%   3.30%   9.82%   0.52%
[+] │  ├── monJX13F48                                                    85.76%   3.43%   9.92%   0.89%
[+] │  ├── monMB14F1                                                     81.41%   3.33%   8.72%   6.54%
[+] │  ├── monTER14F11                                                   86.34%   3.34%   9.73%   0.60%
[+] │  └── monVAN14F1                                                    85.79%   3.37%   9.64%   1.20%
[+] └── intervals ............................... 17,131 intervals across 1,492,814 b (5.12% of genome)
[+] [ ============================================ Blocks =========================================== ]
[+] blocks
[+] ├── '-l 64 -m 128 -u 3 -i 3' ..................................  3,293,738 blocks (0.21% discarded)
[+] │                                                                     X             A             B
[+] ├── BED interval sites in blocks (estimated %)                   92.23%        92.36%        92.37%
[+] ├── Total blocks                                              1,742,514       775,554       775,670
[+] ├── Invariant blocks                                             35.31%        86.46%        72.80%
[+] ├── Four-gamete-violation blocks                                  0.20%         0.04%         0.07%
[+] ├── Heterozygosity (population A)                               0.00164       0.00164             -
[+] ├── Heterozygosity (population B)                               0.00316             -       0.00320
[+] ├── D_xy                                                        0.01678             -             -
[+] ├── F_st                                                        0.74937             -             -
[+] ├── Pi                                                                -       0.00162       0.00318
[+] └── Watterson theta                                                   -       0.00158       0.00322
[+] [ =========================================== Windows =========================================== ]
[+] [ =========================================== Tallies =========================================== ]
[+] Tally
[+] └── 'tally/blocks_raw' .......................................................  shape (9, 9, 9, 9)





# X inversions

bedtools intersect -a gimble.D_montana.ref_genome.non_repeats.CDS.sorted.merged.bed -b X_inverted.bed > gimble.D_montana.ref_genome.non_repeats.CDS.X_inverted.bed
sort -k1,1V -k2,2n -k3,3n gimble.D_montana.ref_genome.non_repeats.CDS.X_inverted.bed > gimble.D_montana.ref_genome.non_repeats.CDS.X_inverted.sorted.bed

gIMble/./gIMble measure -f -g gimble.X.genomefile -b gimble.D_montana.ref_genome.non_repeats.CDS.X_inverted.sorted.bed -s gimble.samples.montana.flavomontana.sympatric.csv -v gimble.vcf.gz -z /scratch/npoikela/montana.flavomontana.sympatric.CDS.X_inverted.64bp

gIMble/./gIMble blocks -z /scratch/npoikela/montana.flavomontana.sympatric.CDS.X_inverted.64bp.z -l 64 -f

gIMble/./gIMble info -z /scratch/npoikela/montana.flavomontana.sympatric.CDS.X_inverted.64bp.z

# gimble v0.7.1
[+] [ =========================================== Storage =========================================== ]
[+] 2montana.flavomontana.sympatric.CDS.X_inverted.64bp.z ........................... 22.8 MB | 100.00%
[+] ├── blocks ...................................................................... 21.0 MB |  92.16%
[+] ├── seqs ......................................................................... 1.8 MB |   7.82%
[+] └── tally ........................................................................ 3.6 KB |   0.02%
[+] [ ========================================= Parsed data ========================================= ]
[+] seqs
[+] ├── genome ..................................... 29,140,820 b in 1 sequence(s) (n50 = 29,140,820 b)
[+] ├── populations ....................................................... 18 samples in 2 populations
[+] │  ├── A = flavomontana                                                                           9
[+] │  └── B = montana                                                                                9
[+] ├── sample sets ............................................................................... 153
[+] │  ├── INTER-population sample-sets (X)                                                          81
[+] │  ├── INTRA-population sample-sets (A)                                                          36
[+] │  └── INTRA-population sample-sets (B)                                                          36
[+] ├── variants ............................................................... 85,520 (2.93 per 1 kb)
[+] │  │                                                                 HOMREF  HOMALT     HET    MISS
[+] │  ├── fla3Fall                                                      50.09%  43.20%   5.54%   1.17%
[+] │  ├── flaASH13F2                                                    50.23%  43.26%   4.79%   1.73%
[+] │  ├── flaCRAN14F7                                                   47.80%  41.32%   9.30%   1.58%
[+] │  ├── flaJX13F31                                                    47.83%  41.60%   9.10%   1.48%
[+] │  ├── flaLB15F3                                                     49.69%  43.23%   4.77%   2.30%
[+] │  ├── flaMB14F10                                                    48.23%  41.46%   9.40%   0.91%
[+] │  ├── flaMT13F11                                                    47.34%  41.09%   8.98%   2.59%
[+] │  ├── flaTER14F5                                                    50.14%  43.14%   5.24%   1.48%
[+] │  ├── flaVAN14F20                                                   49.75%  42.84%   5.25%   2.17%
[+] │  ├── mon4Fall                                                      85.26%   4.15%   9.60%   0.98%
[+] │  ├── monAF15F28                                                    85.18%   4.03%   9.92%   0.87%
[+] │  ├── monASH13F13                                                   85.57%   4.19%   9.50%   0.74%
[+] │  ├── monAZA2                                                       85.85%   4.23%   9.03%   0.89%
[+] │  ├── monCRAN14F16                                                  85.58%   4.12%   9.46%   0.85%
[+] │  ├── monJX13F48                                                    85.31%   4.08%  10.10%   0.50%
[+] │  ├── monMB14F1                                                     79.17%   3.82%   8.95%   8.06%
[+] │  ├── monTER14F11                                                   85.59%   4.05%   9.52%   0.84%
[+] │  └── monVAN14F1                                                    85.16%   4.04%   9.38%   1.42%
[+] └── intervals ............................... 28,962 intervals across 2,090,679 b (7.17% of genome)
[+] [ ============================================ Blocks =========================================== ]
[+] blocks
[+] ├── '-l 64 -m 128 -u 3 -i 3' ..................................  4,560,508 blocks (0.29% discarded)
[+] │                                                                     X             A             B
[+] ├── BED interval sites in blocks (estimated %)                   91.18%        91.39%        91.25%
[+] ├── Total blocks                                              2,412,627     1,074,762     1,073,119
[+] ├── Invariant blocks                                             30.15%        78.36%        67.28%
[+] ├── Four-gamete-violation blocks                                  0.27%         0.07%         0.09%
[+] ├── Heterozygosity (population A)                               0.00279       0.00279             -
[+] ├── Heterozygosity (population B)                               0.00380             -       0.00385
[+] ├── D_xy                                                        0.01925             -             -
[+] ├── F_st                                                        0.70780             -             -
[+] ├── Pi                                                                -       0.00260       0.00384
[+] └── Watterson theta                                                   -       0.00256       0.00389
[+] [ =========================================== Windows =========================================== ]
[+] [ =========================================== Tallies =========================================== ]
[+] Tally
[+] └── 'tally/blocks_raw' .......................................................  shape (9, 9, 9, 9)






























## allopatry, intergenic

# collinear autosomes

bedtools intersect -a gimble.D_montana.ref_genome.non_repeats.intergenic.sorted.bed -b autosomes_collinear.bed > gimble.D_montana.ref_genome.non_repeats.intergenic.autosomes_collinear.bed
sort -k1,1V -k2,2n -k3,3n gimble.D_montana.ref_genome.non_repeats.intergenic.autosomes_collinear.bed > gimble.D_montana.ref_genome.non_repeats.intergenic.autosomes_collinear.sorted.bed

gIMble/./gIMble measure -f -g gimble.autosomes.genomefile -b gimble.D_montana.ref_genome.non_repeats.intergenic.autosomes_collinear.sorted.bed -s gimble.samples.montana.flavomontana.allopatric.csv -v gimble.vcf.gz -z /scratch/npoikela/montana.flavomontana.allopatric.intergenic.autosomes_collinear.64bp

gIMble/./gIMble blocks -z /scratch/npoikela/montana.flavomontana.allopatric.intergenic.autosomes_collinear.64bp.z -l 64 -f

gIMble/./gIMble info -z /scratch/npoikela/montana.flavomontana.allopatric.intergenic.autosomes_collinear.64bp.z

# gimble v0.7.1
[+] [ =========================================== Storage =========================================== ]
[+] 2montana.flavomontana.allopatric.intergenic.autosomes_collinear.64bp.z ......... 215.7 MB | 100.00%
[+] ├── blocks ..................................................................... 160.9 MB |  74.59%
[+] ├── seqs ........................................................................ 54.8 MB |  25.40%
[+] └── tally ........................................................................ 6.1 KB |   0.00%
[+] [ ========================================= Parsed data ========================================= ]
[+] seqs
[+] ├── genome .................................... 116,312,519 b in 5 sequence(s) (n50 = 26,508,887 b)
[+] ├── populations ....................................................... 12 samples in 2 populations
[+] │  ├── A = flavomontana                                                                           9
[+] │  └── B = montana                                                                                3
[+] ├── sample sets ................................................................................ 66
[+] │  ├── INTER-population sample-sets (X)                                                          27
[+] │  ├── INTRA-population sample-sets (A)                                                          36
[+] │  └── INTRA-population sample-sets (B)                                                           3
[+] ├── variants ........................................................... 3,045,138 (26.18 per 1 kb)
[+] │  │                                                                 HOMREF  HOMALT     HET    MISS
[+] │  ├── fla3Fall                                                      58.49%  30.32%   6.11%   5.08%
[+] │  ├── flaASH13F2                                                    57.40%  28.60%   6.20%   7.80%
[+] │  ├── flaCRAN14F7                                                   58.22%  29.92%   6.90%   4.96%
[+] │  ├── flaJX13F31                                                    57.93%  29.68%   6.87%   5.52%
[+] │  ├── flaLB15F3                                                     58.40%  29.89%   5.86%   5.85%
[+] │  ├── flaMB14F10                                                    58.60%  30.23%   6.17%   4.99%
[+] │  ├── flaMT13F11                                                    57.78%  29.21%   6.40%   6.61%
[+] │  ├── flaTER14F5                                                    58.61%  30.27%   6.14%   4.98%
[+] │  ├── flaVAN14F20                                                   58.26%  29.65%   6.58%   5.51%
[+] │  ├── monFA13F2                                                     81.85%   5.10%  12.11%   0.94%
[+] │  ├── monHO13F3                                                     81.87%   4.76%  12.46%   0.92%
[+] │  └── monSE13F37                                                    86.29%   0.23%  12.94%   0.54%
[+] └── intervals .......................... 1,356,755 intervals across 36,297,468 b (31.21% of genome)
[+] [ ============================================ Blocks =========================================== ]
[+] blocks
[+] ├── '-l 64 -m 128 -u 3 -i 3' .................................  34,056,807 blocks (0.14% discarded)
[+] │                                                                     X             A             B
[+] ├── BED interval sites in blocks (estimated %)                   91.15%        90.45%        95.85%
[+] ├── Total blocks                                             13,957,746    18,468,216     1,630,845
[+] ├── Invariant blocks                                             20.68%        61.44%        42.10%
[+] ├── Four-gamete-violation blocks                                  0.67%         0.22%         0.88%
[+] ├── Heterozygosity (population A)                               0.00543       0.00537             -
[+] ├── Heterozygosity (population B)                               0.00986             -       0.01042
[+] ├── D_xy                                                        0.03030             -             -
[+] ├── F_st                                                        0.59683             -             -
[+] ├── Pi                                                                -       0.00550       0.01093
[+] └── Watterson theta                                                   -       0.00548       0.01098
[+] [ =========================================== Windows =========================================== ]
[+] [ =========================================== Tallies =========================================== ]
[+] Tally
[+] └── 'tally/blocks_raw' .......................................................  shape (9, 9, 9, 9)







# 4 inversion

bedtools intersect -a gimble.D_montana.ref_genome.non_repeats.intergenic.sorted.bed -b 4_inverted.bed > gimble.D_montana.ref_genome.non_repeats.intergenic.4_inverted.bed
sort -k1,1V -k2,2n -k3,3n gimble.D_montana.ref_genome.non_repeats.intergenic.4_inverted.bed > gimble.D_montana.ref_genome.non_repeats.intergenic.4_inverted.sorted.bed

gIMble/./gIMble measure -f -g gimble.4.genomefile -b gimble.D_montana.ref_genome.non_repeats.intergenic.4_inverted.sorted.bed -s gimble.samples.montana.flavomontana.allopatric.csv -v gimble.vcf.gz -z /scratch/npoikela/montana.flavomontana.allopatric.intergenic.4_inverted.64bp

gIMble/./gIMble blocks -z /scratch/npoikela/montana.flavomontana.allopatric.intergenic.4_inverted.64bp.z -l 64 -f

gIMble/./gIMble info -z /scratch/npoikela/montana.flavomontana.allopatric.intergenic.4_inverted.64bp.z

# gimble v0.7.1
[+] [ =========================================== Storage =========================================== ]
[+] 2montana.flavomontana.allopatric.intergenic.4_inverted.64bp.z ................... 45.2 MB | 100.00%
[+] ├── blocks ...................................................................... 32.4 MB |  71.76%
[+] ├── seqs ........................................................................ 12.8 MB |  28.23%
[+] └── tally ........................................................................ 4.3 KB |   0.01%
[+] [ ========================================= Parsed data ========================================= ]
[+] seqs
[+] ├── genome ..................................... 32,544,174 b in 1 sequence(s) (n50 = 32,544,174 b)
[+] ├── populations ....................................................... 12 samples in 2 populations
[+] │  ├── A = flavomontana                                                                           9
[+] │  └── B = montana                                                                                3
[+] ├── sample sets ................................................................................ 66
[+] │  ├── INTER-population sample-sets (X)                                                          27
[+] │  ├── INTRA-population sample-sets (A)                                                          36
[+] │  └── INTRA-population sample-sets (B)                                                           3
[+] ├── variants ............................................................. 664,323 (20.41 per 1 kb)
[+] │  │                                                                 HOMREF  HOMALT     HET    MISS
[+] │  ├── fla3Fall                                                      56.13%  31.47%   6.46%   5.93%
[+] │  ├── flaASH13F2                                                    54.41%  28.84%   6.88%   9.87%
[+] │  ├── flaCRAN14F7                                                   56.28%  31.36%   6.46%   5.89%
[+] │  ├── flaJX13F31                                                    55.75%  30.79%   6.37%   7.09%
[+] │  ├── flaLB15F3                                                     55.95%  30.69%   6.22%   7.14%
[+] │  ├── flaMB14F10                                                    56.30%  31.33%   6.46%   5.91%
[+] │  ├── flaMT13F11                                                    55.14%  29.83%   6.66%   8.37%
[+] │  ├── flaTER14F5                                                    56.34%  31.36%   6.35%   5.96%
[+] │  ├── flaVAN14F20                                                   55.88%  30.44%   6.92%   6.76%
[+] │  ├── monFA13F2                                                     81.78%   5.11%  12.59%   0.52%
[+] │  ├── monHO13F3                                                     82.04%   5.11%  12.26%   0.59%
[+] │  └── monSE13F37                                                    87.37%   0.28%  12.02%   0.33%
[+] └── intervals ............................. 291,221 intervals across 7,099,504 b (21.81% of genome)
[+] [ ============================================ Blocks =========================================== ]
[+] blocks
[+] ├── '-l 64 -m 128 -u 3 -i 3' ..................................  6,556,395 blocks (0.10% discarded)
[+] │                                                                     X             A             B
[+] ├── BED interval sites in blocks (estimated %)                   89.85%        88.73%        96.71%
[+] ├── Total blocks                                              2,691,199     3,543,358       321,838
[+] ├── Invariant blocks                                             17.18%        55.38%        38.48%
[+] ├── Four-gamete-violation blocks                                  0.68%         0.29%         0.68%
[+] ├── Heterozygosity (population A)                               0.00641       0.00631             -
[+] ├── Heterozygosity (population B)                               0.01076             -       0.01151
[+] ├── D_xy                                                        0.03511             -             -
[+] ├── F_st                                                        0.60717             -             -
[+] ├── Pi                                                                -       0.00656       0.01218
[+] └── Watterson theta                                                   -       0.00654       0.01217
[+] [ =========================================== Windows =========================================== ]
[+] [ =========================================== Tallies =========================================== ]
[+] Tally
[+] └── 'tally/blocks_raw' .......................................................  shape (9, 9, 9, 9)






# 5 inversion

bedtools intersect -a gimble.D_montana.ref_genome.non_repeats.intergenic.sorted.bed -b 5_inverted.bed > gimble.D_montana.ref_genome.non_repeats.intergenic.5_inverted.bed
sort -k1,1V -k2,2n -k3,3n gimble.D_montana.ref_genome.non_repeats.intergenic.5_inverted.bed > gimble.D_montana.ref_genome.non_repeats.intergenic.5_inverted.sorted.bed

gIMble/./gIMble measure -f -g gimble.5.genomefile -b gimble.D_montana.ref_genome.non_repeats.intergenic.5_inverted.sorted.bed -s gimble.samples.montana.flavomontana.allopatric.csv -v gimble.vcf.gz -z /scratch/npoikela/montana.flavomontana.allopatric.intergenic.5_inverted.64bp

gIMble/./gIMble blocks -z /scratch/npoikela/montana.flavomontana.allopatric.intergenic.5_inverted.64bp.z -l 64 -f

gIMble/./gIMble info -z /scratch/npoikela/montana.flavomontana.allopatric.intergenic.5_inverted.64bp.z

# gimble v0.7.1
[+] [ =========================================== Storage =========================================== ]
[+] 2montana.flavomontana.allopatric.intergenic.5_inverted.64bp.z ................... 24.6 MB | 100.00%
[+] ├── blocks ...................................................................... 18.8 MB |  76.53%
[+] ├── seqs ......................................................................... 5.8 MB |  23.45%
[+] └── tally ........................................................................ 3.7 KB |   0.01%
[+] [ ========================================= Parsed data ========================================= ]
[+] seqs
[+] ├── genome ..................................... 26,508,887 b in 1 sequence(s) (n50 = 26,508,887 b)
[+] ├── populations ....................................................... 12 samples in 2 populations
[+] │  ├── A = flavomontana                                                                           9
[+] │  └── B = montana                                                                                3
[+] ├── sample sets ................................................................................ 66
[+] │  ├── INTER-population sample-sets (X)                                                          27
[+] │  ├── INTRA-population sample-sets (A)                                                          36
[+] │  └── INTRA-population sample-sets (B)                                                           3
[+] ├── variants ............................................................. 345,062 (13.02 per 1 kb)
[+] │  │                                                                 HOMREF  HOMALT     HET    MISS
[+] │  ├── fla3Fall                                                      58.30%  31.45%   5.87%   4.38%
[+] │  ├── flaASH13F2                                                    57.16%  29.57%   6.46%   6.81%
[+] │  ├── flaCRAN14F7                                                   58.20%  31.37%   6.03%   4.40%
[+] │  ├── flaJX13F31                                                    57.94%  31.06%   6.08%   4.93%
[+] │  ├── flaLB15F3                                                     58.14%  31.03%   5.70%   5.14%
[+] │  ├── flaMB14F10                                                    58.30%  31.36%   5.98%   4.35%
[+] │  ├── flaMT13F11                                                    57.59%  30.40%   6.32%   5.69%
[+] │  ├── flaTER14F5                                                    58.26%  31.34%   5.99%   4.40%
[+] │  ├── flaVAN14F20                                                   58.06%  30.78%   6.44%   4.73%
[+] │  ├── monFA13F2                                                     83.36%   4.37%  11.86%   0.41%
[+] │  ├── monHO13F3                                                     83.72%   4.27%  11.66%   0.35%
[+] │  └── monSE13F37                                                    87.63%   0.24%  12.00%   0.12%
[+] └── intervals ............................. 138,253 intervals across 4,117,807 b (15.53% of genome)
[+] [ ============================================ Blocks =========================================== ]
[+] blocks
[+] ├── '-l 64 -m 128 -u 3 -i 3' ..................................  3,894,879 blocks (0.06% discarded)
[+] │                                                                     X             A             B
[+] ├── BED interval sites in blocks (estimated %)                   91.87%        91.22%        96.36%
[+] ├── Total blocks                                              1,596,050     2,112,827       186,002
[+] ├── Invariant blocks                                             19.74%        60.91%        42.18%
[+] ├── Four-gamete-violation blocks                                  0.52%         0.18%         0.65%
[+] ├── Heterozygosity (population A)                               0.00526       0.00521             -
[+] ├── Heterozygosity (population B)                               0.00934             -       0.00989
[+] ├── D_xy                                                        0.03113             -             -
[+] ├── F_st                                                        0.62004             -             -
[+] ├── Pi                                                                -       0.00536       0.01026
[+] └── Watterson theta                                                   -       0.00536       0.01033
[+] [ =========================================== Windows =========================================== ]
[+] [ =========================================== Tallies =========================================== ]
[+] Tally
[+] └── 'tally/blocks_raw' .......................................................  shape (9, 9, 9, 9)






# collinear X chromosome

bedtools intersect -a gimble.D_montana.ref_genome.non_repeats.intergenic.sorted.bed -b X_collinear.bed > gimble.D_montana.ref_genome.non_repeats.intergenic.X_collinear.bed
sort -k1,1V -k2,2n -k3,3n gimble.D_montana.ref_genome.non_repeats.intergenic.X_collinear.bed > gimble.D_montana.ref_genome.non_repeats.intergenic.X_collinear.sorted.bed

gIMble/./gIMble measure -f -g gimble.X.genomefile -b gimble.D_montana.ref_genome.non_repeats.intergenic.X_collinear.sorted.bed -s gimble.samples.montana.flavomontana.allopatric.csv -v gimble.vcf.gz -z /scratch/npoikela/montana.flavomontana.allopatric.intergenic.X_collinear.64bp

gIMble/./gIMble blocks -z /scratch/npoikela/montana.flavomontana.allopatric.intergenic.X_collinear.64bp.z -l 64 -f

gIMble/./gIMble info -z /scratch/npoikela/montana.flavomontana.allopatric.intergenic.X_collinear.64bp.z

# gimble v0.7.1
[+] [ =========================================== Storage =========================================== ]
[+] 2montana.flavomontana.allopatric.intergenic.X_collinear.64bp.z .................. 62.0 MB | 100.00%
[+] ├── blocks ...................................................................... 42.4 MB |  68.39%
[+] ├── seqs ........................................................................ 19.6 MB |  31.60%
[+] └── tally ........................................................................ 5.4 KB |   0.01%
[+] [ ========================================= Parsed data ========================================= ]
[+] seqs
[+] ├── genome ..................................... 29,140,820 b in 1 sequence(s) (n50 = 29,140,820 b)
[+] ├── populations ....................................................... 12 samples in 2 populations
[+] │  ├── A = flavomontana                                                                           9
[+] │  └── B = montana                                                                                3
[+] ├── sample sets ................................................................................ 66
[+] │  ├── INTER-population sample-sets (X)                                                          27
[+] │  ├── INTRA-population sample-sets (A)                                                          36
[+] │  └── INTRA-population sample-sets (B)                                                           3
[+] ├── variants ............................................................. 798,068 (27.39 per 1 kb)
[+] │  │                                                                 HOMREF  HOMALT     HET    MISS
[+] │  ├── fla3Fall                                                      43.27%  38.90%   7.40%  10.43%
[+] │  ├── flaASH13F2                                                    42.56%  37.43%   7.10%  12.91%
[+] │  ├── flaCRAN14F7                                                   43.23%  38.78%   7.55%  10.44%
[+] │  ├── flaJX13F31                                                    42.86%  38.58%   8.02%  10.54%
[+] │  ├── flaLB15F3                                                     43.02%  38.23%   8.27%  10.48%
[+] │  ├── flaMB14F10                                                    43.37%  38.74%   7.41%  10.48%
[+] │  ├── flaMT13F11                                                    42.60%  37.73%   8.43%  11.25%
[+] │  ├── flaTER14F5                                                    43.49%  38.86%   7.43%  10.23%
[+] │  ├── flaVAN14F20                                                   42.98%  38.02%   8.57%  10.43%
[+] │  ├── monFA13F2                                                     78.72%   4.91%  11.20%   5.16%
[+] │  ├── monHO13F3                                                     80.60%   2.95%  11.43%   5.02%
[+] │  └── monSE13F37                                                    83.58%   0.24%  11.91%   4.27%
[+] └── intervals ............................ 649,749 intervals across 11,751,252 b (40.33% of genome)
[+] [ ============================================ Blocks =========================================== ]
[+] blocks
[+] ├── '-l 64 -m 128 -u 3 -i 3' .................................  10,633,564 blocks (0.52% discarded)
[+] │                                                                     X             A             B
[+] ├── BED interval sites in blocks (estimated %)                   87.67%        87.17%        95.35%
[+] ├── Total blocks                                              4,346,262     5,762,055       525,247
[+] ├── Invariant blocks                                             19.87%        74.64%        55.21%
[+] ├── Four-gamete-violation blocks                                  0.73%         0.18%         0.44%
[+] ├── Heterozygosity (population A)                               0.00460       0.00458             -
[+] ├── Heterozygosity (population B)                               0.00664             -       0.00733
[+] ├── D_xy                                                        0.03211             -             -
[+] ├── F_st                                                        0.70211             -             -
[+] ├── Pi                                                                -       0.00421       0.00764
[+] └── Watterson theta                                                   -       0.00404       0.00752
[+] [ =========================================== Windows =========================================== ]
[+] [ =========================================== Tallies =========================================== ]
[+] Tally
[+] └── 'tally/blocks_raw' .......................................................  shape (9, 9, 9, 9)




# X inversions

bedtools intersect -a gimble.D_montana.ref_genome.non_repeats.intergenic.sorted.bed -b X_inverted.bed > gimble.D_montana.ref_genome.non_repeats.intergenic.X_inverted.bed
sort -k1,1V -k2,2n -k3,3n gimble.D_montana.ref_genome.non_repeats.intergenic.X_inverted.bed > gimble.D_montana.ref_genome.non_repeats.intergenic.X_inverted.sorted.bed

gIMble/./gIMble measure -f -g gimble.X.genomefile -b gimble.D_montana.ref_genome.non_repeats.intergenic.X_inverted.sorted.bed -s gimble.samples.montana.flavomontana.allopatric.csv -v gimble.vcf.gz -z /scratch/npoikela/montana.flavomontana.allopatric.intergenic.X_inverted.64bp

gIMble/./gIMble blocks -z /scratch/npoikela/montana.flavomontana.allopatric.intergenic.X_inverted.64bp.z -l 64 -f

gIMble/./gIMble info -z /scratch/npoikela/montana.flavomontana.allopatric.intergenic.X_inverted.64bp.z

# gimble v0.7.1
[+] [ =========================================== Storage =========================================== ]
[+] 2montana.flavomontana.allopatric.intergenic.X_inverted.64bp.z ................... 85.1 MB | 100.00%
[+] ├── blocks ...................................................................... 59.3 MB |  69.65%
[+] ├── seqs ........................................................................ 25.8 MB |  30.35%
[+] └── tally ........................................................................ 4.7 KB |   0.01%
[+] [ ========================================= Parsed data ========================================= ]
[+] seqs
[+] ├── genome ..................................... 29,140,820 b in 1 sequence(s) (n50 = 29,140,820 b)
[+] ├── populations ....................................................... 12 samples in 2 populations
[+] │  ├── A = flavomontana                                                                           9
[+] │  └── B = montana                                                                                3
[+] ├── sample sets ................................................................................ 66
[+] │  ├── INTER-population sample-sets (X)                                                          27
[+] │  ├── INTRA-population sample-sets (A)                                                          36
[+] │  └── INTRA-population sample-sets (B)                                                           3
[+] ├── variants ........................................................... 1,161,612 (39.86 per 1 kb)
[+] │  │                                                                 HOMREF  HOMALT     HET    MISS
[+] │  ├── fla3Fall                                                      48.05%  39.96%   5.26%   6.74%
[+] │  ├── flaASH13F2                                                    46.95%  37.94%   5.41%   9.70%
[+] │  ├── flaCRAN14F7                                                   46.59%  38.76%   8.14%   6.51%
[+] │  ├── flaJX13F31                                                    46.41%  38.52%   8.25%   6.82%
[+] │  ├── flaLB15F3                                                     47.72%  39.33%   5.36%   7.58%
[+] │  ├── flaMB14F10                                                    46.71%  38.72%   8.27%   6.30%
[+] │  ├── flaMT13F11                                                    45.82%  37.57%   8.36%   8.24%
[+] │  ├── flaTER14F5                                                    48.10%  39.89%   5.30%   6.71%
[+] │  ├── flaVAN14F20                                                   47.67%  38.92%   6.07%   7.35%
[+] │  ├── monFA13F2                                                     84.52%   5.16%   9.07%   1.25%
[+] │  ├── monHO13F3                                                     87.98%   2.95%   7.92%   1.15%
[+] │  └── monSE13F37                                                    90.67%   0.16%   8.37%   0.80%
[+] └── intervals ............................ 674,102 intervals across 15,129,926 b (51.92% of genome)
[+] [ ============================================ Blocks =========================================== ]
[+] blocks
[+] ├── '-l 64 -m 128 -u 3 -i 3' .................................  14,289,733 blocks (0.27% discarded)
[+] │                                                                     X             A             B
[+] ├── BED interval sites in blocks (estimated %)                   91.70%        90.94%        98.38%
[+] ├── Total blocks                                              5,852,838     7,739,164       697,731
[+] ├── Invariant blocks                                             17.74%        65.50%        53.83%
[+] ├── Four-gamete-violation blocks                                  0.54%         0.21%         0.31%
[+] ├── Heterozygosity (population A)                               0.00522       0.00511             -
[+] ├── Heterozygosity (population B)                               0.00585             -       0.00643
[+] ├── D_xy                                                        0.03505             -             -
[+] ├── F_st                                                        0.72733             -             -
[+] ├── Pi                                                                -       0.00485       0.00723
[+] └── Watterson theta                                                   -       0.00479       0.00719
[+] [ =========================================== Windows =========================================== ]
[+] [ =========================================== Tallies =========================================== ]
[+] Tally
[+] └── 'tally/blocks_raw' .......................................................  shape (9, 9, 9, 9)







## allopatry, introns

# collinear autosomes

bedtools intersect -a gimble.D_montana.ref_genome.non_repeats.introns.sorted.merged.bed -b autosomes_collinear.bed > gimble.D_montana.ref_genome.non_repeats.introns.autosomes_collinear.bed
sort -k1,1V -k2,2n -k3,3n gimble.D_montana.ref_genome.non_repeats.introns.autosomes_collinear.bed > gimble.D_montana.ref_genome.non_repeats.introns.autosomes_collinear.sorted.bed

gIMble/./gIMble measure -f -g gimble.autosomes.genomefile -b gimble.D_montana.ref_genome.non_repeats.introns.autosomes_collinear.sorted.bed -s gimble.samples.montana.flavomontana.allopatric.csv -v gimble.vcf.gz -z /scratch/npoikela/montana.flavomontana.allopatric.introns.autosomes_collinear.64bp

gIMble/./gIMble blocks -z /scratch/npoikela/montana.flavomontana.allopatric.introns.autosomes_collinear.64bp.z -l 64 -f

gIMble/./gIMble info -z /scratch/npoikela/montana.flavomontana.allopatric.introns.autosomes_collinear.64bp.z

# gimble v0.7.1
[+] [ =========================================== Storage =========================================== ]
[+] 2montana.flavomontana.allopatric.introns.autosomes_collinear.64bp.z ............ 115.7 MB | 100.00%
[+] ├── blocks ...................................................................... 87.4 MB |  75.58%
[+] ├── seqs ........................................................................ 28.2 MB |  24.42%
[+] └── tally ........................................................................ 5.5 KB |   0.00%
[+] [ ========================================= Parsed data ========================================= ]
[+] seqs
[+] ├── genome .................................... 116,312,519 b in 5 sequence(s) (n50 = 26,508,887 b)
[+] ├── populations ....................................................... 12 samples in 2 populations
[+] │  ├── A = flavomontana                                                                           9
[+] │  └── B = montana                                                                                3
[+] ├── sample sets ................................................................................ 66
[+] │  ├── INTER-population sample-sets (X)                                                          27
[+] │  ├── INTRA-population sample-sets (A)                                                          36
[+] │  └── INTRA-population sample-sets (B)                                                           3
[+] ├── variants ........................................................... 1,671,519 (14.37 per 1 kb)
[+] │  │                                                                 HOMREF  HOMALT     HET    MISS
[+] │  ├── fla3Fall                                                      57.47%  31.56%   5.89%   5.08%
[+] │  ├── flaASH13F2                                                    56.58%  30.02%   5.81%   7.59%
[+] │  ├── flaCRAN14F7                                                   57.18%  31.12%   6.84%   4.86%
[+] │  ├── flaJX13F31                                                    56.93%  30.97%   6.71%   5.38%
[+] │  ├── flaLB15F3                                                     57.35%  31.21%   5.72%   5.72%
[+] │  ├── flaMB14F10                                                    57.56%  31.45%   6.01%   4.97%
[+] │  ├── flaMT13F11                                                    56.84%  30.58%   6.16%   6.43%
[+] │  ├── flaTER14F5                                                    57.62%  31.51%   5.94%   4.93%
[+] │  ├── flaVAN14F20                                                   57.28%  30.94%   6.33%   5.46%
[+] │  ├── monFA13F2                                                     81.70%   5.19%  12.35%   0.77%
[+] │  ├── monHO13F3                                                     81.75%   4.85%  12.66%   0.74%
[+] │  └── monSE13F37                                                    86.23%   0.22%  13.14%   0.41%
[+] └── intervals ............................ 726,823 intervals across 19,574,474 b (16.83% of genome)
[+] [ ============================================ Blocks =========================================== ]
[+] blocks
[+] ├── '-l 64 -m 128 -u 3 -i 3' .................................  17,531,205 blocks (0.13% discarded)
[+] │                                                                     X             A             B
[+] ├── BED interval sites in blocks (estimated %)                   86.99%        86.34%        91.68%
[+] ├── Total blocks                                              7,183,507     9,506,466       841,232
[+] ├── Invariant blocks                                             19.88%        61.47%        41.92%
[+] ├── Four-gamete-violation blocks                                  0.68%         0.23%         0.91%
[+] ├── Heterozygosity (population A)                               0.00538       0.00530             -
[+] ├── Heterozygosity (population B)                               0.01005             -       0.01066
[+] ├── D_xy                                                        0.03127             -             -
[+] ├── F_st                                                        0.60419             -             -
[+] ├── Pi                                                                -       0.00546       0.01117
[+] └── Watterson theta                                                   -       0.00544       0.01122
[+] [ =========================================== Windows =========================================== ]
[+] [ =========================================== Tallies =========================================== ]
[+] Tally
[+] └── 'tally/blocks_raw' .......................................................  shape (9, 9, 9, 9)









# 4 inversion

bedtools intersect -a gimble.D_montana.ref_genome.non_repeats.introns.sorted.merged.bed -b 4_inverted.bed > gimble.D_montana.ref_genome.non_repeats.introns.4_inverted.bed
sort -k1,1V -k2,2n -k3,3n gimble.D_montana.ref_genome.non_repeats.introns.4_inverted.bed > gimble.D_montana.ref_genome.non_repeats.introns.4_inverted.sorted.bed

gIMble/./gIMble measure -f -g gimble.4.genomefile -b gimble.D_montana.ref_genome.non_repeats.introns.4_inverted.sorted.bed -s gimble.samples.montana.flavomontana.allopatric.csv -v gimble.vcf.gz -z /scratch/npoikela/montana.flavomontana.allopatric.introns.4_inverted.64bp

gIMble/./gIMble blocks -z /scratch/npoikela/montana.flavomontana.allopatric.introns.4_inverted.64bp.z -l 64 -f

gIMble/./gIMble info -z /scratch/npoikela/montana.flavomontana.allopatric.introns.4_inverted.64bp.z

# gimble v0.7.1
[+] [ =========================================== Storage =========================================== ]
[+] 2montana.flavomontana.allopatric.introns.4_inverted.64bp.z ...................... 19.3 MB | 100.00%
[+] ├── blocks ...................................................................... 13.8 MB |  71.92%
[+] ├── seqs ......................................................................... 5.4 MB |  28.05%
[+] └── tally ........................................................................ 3.6 KB |   0.02%
[+] [ ========================================= Parsed data ========================================= ]
[+] seqs
[+] ├── genome ..................................... 32,544,174 b in 1 sequence(s) (n50 = 32,544,174 b)
[+] ├── populations ....................................................... 12 samples in 2 populations
[+] │  ├── A = flavomontana                                                                           9
[+] │  └── B = montana                                                                                3
[+] ├── sample sets ................................................................................ 66
[+] │  ├── INTER-population sample-sets (X)                                                          27
[+] │  ├── INTRA-population sample-sets (A)                                                          36
[+] │  └── INTRA-population sample-sets (B)                                                           3
[+] ├── variants .............................................................. 292,678 (8.99 per 1 kb)
[+] │  │                                                                 HOMREF  HOMALT     HET    MISS
[+] │  ├── fla3Fall                                                      55.58%  32.09%   6.33%   6.01%
[+] │  ├── flaASH13F2                                                    53.97%  29.67%   7.02%   9.34%
[+] │  ├── flaCRAN14F7                                                   55.59%  32.03%   6.32%   6.05%
[+] │  ├── flaJX13F31                                                    55.12%  31.60%   6.39%   6.89%
[+] │  ├── flaLB15F3                                                     55.46%  31.42%   6.26%   6.86%
[+] │  ├── flaMB14F10                                                    55.59%  31.99%   6.40%   6.02%
[+] │  ├── flaMT13F11                                                    54.69%  30.75%   6.54%   8.02%
[+] │  ├── flaTER14F5                                                    55.68%  32.07%   6.32%   5.93%
[+] │  ├── flaVAN14F20                                                   55.32%  31.16%   7.07%   6.45%
[+] │  ├── monFA13F2                                                     81.62%   5.29%  12.47%   0.62%
[+] │  ├── monHO13F3                                                     81.50%   5.45%  12.40%   0.64%
[+] │  └── monSE13F37                                                    87.29%   0.24%  12.18%   0.29%
[+] └── intervals .............................. 123,050 intervals across 3,028,337 b (9.31% of genome)
[+] [ ============================================ Blocks =========================================== ]
[+] blocks
[+] ├── '-l 64 -m 128 -u 3 -i 3' ..................................  2,674,398 blocks (0.09% discarded)
[+] │                                                                     X             A             B
[+] ├── BED interval sites in blocks (estimated %)                   85.85%        84.89%        92.73%
[+] ├── Total blocks                                              1,096,783     1,445,977       131,638
[+] ├── Invariant blocks                                             16.08%        54.58%        37.60%
[+] ├── Four-gamete-violation blocks                                  0.71%         0.29%         0.67%
[+] ├── Heterozygosity (population A)                               0.00664       0.00656             -
[+] ├── Heterozygosity (population B)                               0.01109             -       0.01188
[+] ├── D_xy                                                        0.03676             -             -
[+] ├── F_st                                                        0.61137             -             -
[+] ├── Pi                                                                -       0.00678       0.01268
[+] └── Watterson theta                                                   -       0.00676       0.01266
[+] [ =========================================== Windows =========================================== ]
[+] [ =========================================== Tallies =========================================== ]
[+] Tally
[+] └── 'tally/blocks_raw' .......................................................  shape (9, 9, 9, 9)




# 5 inversion

bedtools intersect -a gimble.D_montana.ref_genome.non_repeats.introns.sorted.merged.bed -b 5_inverted.bed > gimble.D_montana.ref_genome.non_repeats.introns.5_inverted.bed
sort -k1,1V -k2,2n -k3,3n gimble.D_montana.ref_genome.non_repeats.introns.5_inverted.bed > gimble.D_montana.ref_genome.non_repeats.introns.5_inverted.sorted.bed

gIMble/./gIMble measure -f -g gimble.5.genomefile -b gimble.D_montana.ref_genome.non_repeats.introns.5_inverted.sorted.bed -s gimble.samples.montana.flavomontana.allopatric.csv -v gimble.vcf.gz -z /scratch/npoikela/montana.flavomontana.allopatric.introns.5_inverted.64bp

gIMble/./gIMble blocks -z /scratch/npoikela/montana.flavomontana.allopatric.introns.5_inverted.64bp.z -l 64 -f

gIMble/./gIMble info -z /scratch/npoikela/montana.flavomontana.allopatric.introns.5_inverted.64bp.z

# gimble v0.7.1
[+] [ =========================================== Storage =========================================== ]
[+] 2montana.flavomontana.allopatric.introns.5_inverted.64bp.z ...................... 13.3 MB | 100.00%
[+] ├── blocks ...................................................................... 10.0 MB |  74.73%
[+] ├── seqs ......................................................................... 3.4 MB |  25.24%
[+] └── tally ........................................................................ 3.2 KB |   0.02%
[+] [ ========================================= Parsed data ========================================= ]
[+] seqs
[+] ├── genome ..................................... 26,508,887 b in 1 sequence(s) (n50 = 26,508,887 b)
[+] ├── populations ....................................................... 12 samples in 2 populations
[+] │  ├── A = flavomontana                                                                           9
[+] │  └── B = montana                                                                                3
[+] ├── sample sets ................................................................................ 66
[+] │  ├── INTER-population sample-sets (X)                                                          27
[+] │  ├── INTRA-population sample-sets (A)                                                          36
[+] │  └── INTRA-population sample-sets (B)                                                           3
[+] ├── variants .............................................................. 197,123 (7.44 per 1 kb)
[+] │  │                                                                 HOMREF  HOMALT     HET    MISS
[+] │  ├── fla3Fall                                                      57.59%  32.07%   5.77%   4.58%
[+] │  ├── flaASH13F2                                                    56.41%  30.38%   6.32%   6.89%
[+] │  ├── flaCRAN14F7                                                   57.51%  32.10%   5.86%   4.53%
[+] │  ├── flaJX13F31                                                    57.34%  31.99%   5.79%   4.89%
[+] │  ├── flaLB15F3                                                     57.56%  32.00%   5.36%   5.09%
[+] │  ├── flaMB14F10                                                    57.59%  32.04%   5.86%   4.51%
[+] │  ├── flaMT13F11                                                    56.91%  31.14%   6.14%   5.82%
[+] │  ├── flaTER14F5                                                    57.64%  32.05%   5.81%   4.49%
[+] │  ├── flaVAN14F20                                                   57.51%  31.65%   6.01%   4.83%
[+] │  ├── monFA13F2                                                     82.59%   4.45%  12.52%   0.43%
[+] │  ├── monHO13F3                                                     82.94%   4.29%  12.35%   0.41%
[+] │  └── monSE13F37                                                    86.96%   0.21%  12.64%   0.20%
[+] └── intervals ............................... 79,172 intervals across 2,210,464 b (8.34% of genome)
[+] [ ============================================ Blocks =========================================== ]
[+] blocks
[+] ├── '-l 64 -m 128 -u 3 -i 3' ..................................  1,954,408 blocks (0.08% discarded)
[+] │                                                                     X             A             B
[+] ├── BED interval sites in blocks (estimated %)                   85.89%        85.19%        90.87%
[+] ├── Total blocks                                                800,950     1,059,300        94,158
[+] ├── Invariant blocks                                             18.07%        60.13%        39.74%
[+] ├── Four-gamete-violation blocks                                  0.58%         0.20%         0.78%
[+] ├── Heterozygosity (population A)                               0.00542       0.00536             -
[+] ├── Heterozygosity (population B)                               0.01042             -       0.01090
[+] ├── D_xy                                                        0.03333             -             -
[+] ├── F_st                                                        0.61595             -             -
[+] ├── Pi                                                                -       0.00552       0.01125
[+] └── Watterson theta                                                   -       0.00551       0.01132
[+] [ =========================================== Windows =========================================== ]
[+] [ =========================================== Tallies =========================================== ]
[+] Tally
[+] └── 'tally/blocks_raw' .......................................................  shape (9, 9, 9, 9)






# collinear X chromosome

bedtools intersect -a gimble.D_montana.ref_genome.non_repeats.introns.sorted.merged.bed -b X_collinear.bed > gimble.D_montana.ref_genome.non_repeats.introns.X_collinear.bed
sort -k1,1V -k2,2n -k3,3n gimble.D_montana.ref_genome.non_repeats.introns.X_collinear.bed > gimble.D_montana.ref_genome.non_repeats.introns.X_collinear.sorted.bed

gIMble/./gIMble measure -f -g gimble.X.genomefile -b gimble.D_montana.ref_genome.non_repeats.introns.X_collinear.sorted.bed -s gimble.samples.montana.flavomontana.allopatric.csv -v gimble.vcf.gz -z /scratch/npoikela/montana.flavomontana.allopatric.introns.X_collinear.64bp

gIMble/./gIMble blocks -z /scratch/npoikela/montana.flavomontana.allopatric.introns.X_collinear.64bp.z -l 64 -f

gIMble/./gIMble info -z /scratch/npoikela/montana.flavomontana.allopatric.introns.X_collinear.64bp.z

# gimble v0.7.1
[+] [ =========================================== Storage =========================================== ]
[+] 2montana.flavomontana.allopatric.introns.X_collinear.64bp.z ..................... 17.8 MB | 100.00%
[+] ├── blocks ...................................................................... 13.1 MB |  73.69%
[+] ├── seqs ......................................................................... 4.7 MB |  26.28%
[+] └── tally ........................................................................ 4.2 KB |   0.02%
[+] [ ========================================= Parsed data ========================================= ]
[+] seqs
[+] ├── genome ..................................... 29,140,820 b in 1 sequence(s) (n50 = 29,140,820 b)
[+] ├── populations ....................................................... 12 samples in 2 populations
[+] │  ├── A = flavomontana                                                                           9
[+] │  └── B = montana                                                                                3
[+] ├── sample sets ................................................................................ 66
[+] │  ├── INTER-population sample-sets (X)                                                          27
[+] │  ├── INTRA-population sample-sets (A)                                                          36
[+] │  └── INTRA-population sample-sets (B)                                                           3
[+] ├── variants .............................................................. 223,820 (7.68 per 1 kb)
[+] │  │                                                                 HOMREF  HOMALT     HET    MISS
[+] │  ├── fla3Fall                                                      45.30%  41.07%   6.20%   7.42%
[+] │  ├── flaASH13F2                                                    44.58%  39.39%   5.75%  10.27%
[+] │  ├── flaCRAN14F7                                                   45.19%  40.92%   6.37%   7.52%
[+] │  ├── flaJX13F31                                                    45.02%  40.80%   6.48%   7.70%
[+] │  ├── flaLB15F3                                                     45.14%  40.46%   6.42%   7.98%
[+] │  ├── flaMB14F10                                                    45.42%  40.94%   6.25%   7.39%
[+] │  ├── flaMT13F11                                                    44.54%  39.90%   6.83%   8.73%
[+] │  ├── flaTER14F5                                                    45.46%  41.02%   6.20%   7.32%
[+] │  ├── flaVAN14F20                                                   45.02%  40.12%   7.12%   7.75%
[+] │  ├── monFA13F2                                                     81.35%   5.36%  10.71%   2.57%
[+] │  ├── monHO13F3                                                     83.16%   3.44%  10.98%   2.42%
[+] │  └── monSE13F37                                                    86.37%   0.24%  11.55%   1.84%
[+] └── intervals ............................. 156,624 intervals across 3,083,326 b (10.58% of genome)
[+] [ ============================================ Blocks =========================================== ]
[+] blocks
[+] ├── '-l 64 -m 128 -u 3 -i 3' ..................................  2,780,460 blocks (0.35% discarded)
[+] │                                                                     X             A             B
[+] ├── BED interval sites in blocks (estimated %)                   87.48%        86.86%        94.18%
[+] ├── Total blocks                                              1,137,934     1,506,405       136,121
[+] ├── Invariant blocks                                             16.57%        73.88%        51.34%
[+] ├── Four-gamete-violation blocks                                  0.75%         0.20%         0.58%
[+] ├── Heterozygosity (population A)                               0.00433       0.00423             -
[+] ├── Heterozygosity (population B)                               0.00714             -       0.00779
[+] ├── D_xy                                                        0.03510             -             -
[+] ├── F_st                                                        0.71912             -             -
[+] ├── Pi                                                                -       0.00406       0.00837
[+] └── Watterson theta                                                   -       0.00394       0.00829
[+] [ =========================================== Windows =========================================== ]
[+] [ =========================================== Tallies =========================================== ]
[+] Tally
[+] └── 'tally/blocks_raw' .......................................................  shape (9, 9, 9, 9)






# X inversions

bedtools intersect -a gimble.D_montana.ref_genome.non_repeats.introns.sorted.merged.bed -b X_inverted.bed > gimble.D_montana.ref_genome.non_repeats.introns.X_inverted.bed
sort -k1,1V -k2,2n -k3,3n gimble.D_montana.ref_genome.non_repeats.introns.X_inverted.bed > gimble.D_montana.ref_genome.non_repeats.introns.X_inverted.sorted.bed

gIMble/./gIMble measure -f -g gimble.X.genomefile -b gimble.D_montana.ref_genome.non_repeats.introns.X_inverted.sorted.bed -s gimble.samples.montana.flavomontana.allopatric.csv -v gimble.vcf.gz -z /scratch/npoikela/montana.flavomontana.allopatric.introns.X_inverted.64bp

gIMble/./gIMble blocks -z /scratch/npoikela/montana.flavomontana.allopatric.introns.X_inverted.64bp.z -l 64 -f

gIMble/./gIMble info -z /scratch/npoikela/montana.flavomontana.allopatric.introns.X_inverted.64bp.z

# gimble v0.7.1
[+] [ =========================================== Storage =========================================== ]
[+] 2montana.flavomontana.allopatric.introns.X_inverted.64bp.z ...................... 28.4 MB | 100.00%
[+] ├── blocks ...................................................................... 20.6 MB |  72.46%
[+] ├── seqs ......................................................................... 7.8 MB |  27.52%
[+] └── tally ........................................................................ 3.9 KB |   0.01%
[+] [ ========================================= Parsed data ========================================= ]
[+] seqs
[+] ├── genome ..................................... 29,140,820 b in 1 sequence(s) (n50 = 29,140,820 b)
[+] ├── populations ....................................................... 12 samples in 2 populations
[+] │  ├── A = flavomontana                                                                           9
[+] │  └── B = montana                                                                                3
[+] ├── sample sets ................................................................................ 66
[+] │  ├── INTER-population sample-sets (X)                                                          27
[+] │  ├── INTRA-population sample-sets (A)                                                          36
[+] │  └── INTRA-population sample-sets (B)                                                           3
[+] ├── variants ............................................................. 387,350 (13.29 per 1 kb)
[+] │  │                                                                 HOMREF  HOMALT     HET    MISS
[+] │  ├── fla3Fall                                                      48.25%  39.93%   5.21%   6.61%
[+] │  ├── flaASH13F2                                                    47.22%  38.04%   5.30%   9.45%
[+] │  ├── flaCRAN14F7                                                   46.85%  38.78%   8.08%   6.29%
[+] │  ├── flaJX13F31                                                    46.74%  38.59%   8.10%   6.57%
[+] │  ├── flaLB15F3                                                     47.91%  39.36%   5.26%   7.47%
[+] │  ├── flaMB14F10                                                    46.95%  38.69%   8.18%   6.17%
[+] │  ├── flaMT13F11                                                    46.12%  37.72%   8.24%   7.92%
[+] │  ├── flaTER14F5                                                    48.32%  39.93%   5.18%   6.57%
[+] │  ├── flaVAN14F20                                                   47.84%  38.96%   6.06%   7.14%
[+] │  ├── monFA13F2                                                     84.29%   5.26%   9.50%   0.96%
[+] │  ├── monHO13F3                                                     88.00%   3.16%   8.02%   0.82%
[+] │  └── monSE13F37                                                    90.80%   0.17%   8.53%   0.50%
[+] └── intervals ............................. 224,691 intervals across 4,654,742 b (15.97% of genome)
[+] [ ============================================ Blocks =========================================== ]
[+] blocks
[+] ├── '-l 64 -m 128 -u 3 -i 3' ..................................  4,232,964 blocks (0.30% discarded)
[+] │                                                                     X             A             B
[+] ├── BED interval sites in blocks (estimated %)                   88.30%        87.47%        95.66%
[+] ├── Total blocks                                              1,734,038     2,290,210       208,716
[+] ├── Invariant blocks                                             15.42%        63.15%        50.05%
[+] ├── Four-gamete-violation blocks                                  0.64%         0.24%         0.34%
[+] ├── Heterozygosity (population A)                               0.00567       0.00555             -
[+] ├── Heterozygosity (population B)                               0.00661             -       0.00720
[+] ├── D_xy                                                        0.03824             -             -
[+] ├── F_st                                                        0.72333             -             -
[+] ├── Pi                                                                -       0.00528       0.00810
[+] └── Watterson theta                                                   -       0.00521       0.00807
[+] [ =========================================== Windows =========================================== ]
[+] [ =========================================== Tallies =========================================== ]
[+] Tally
[+] └── 'tally/blocks_raw' .......................................................  shape (9, 9, 9, 9)








## allopatry, CDS

# collinear autosomes
bedtools intersect -a gimble.D_montana.ref_genome.non_repeats.CDS.sorted.merged.bed -b autosomes_collinear.bed > gimble.D_montana.ref_genome.non_repeats.CDS.autosomes_collinear.bed
sort -k1,1V -k2,2n -k3,3n gimble.D_montana.ref_genome.non_repeats.CDS.autosomes_collinear.bed > gimble.D_montana.ref_genome.non_repeats.CDS.autosomes_collinear.sorted.bed

gIMble/./gIMble measure -f -g gimble.autosomes.genomefile -b gimble.D_montana.ref_genome.non_repeats.CDS.autosomes_collinear.sorted.bed -s gimble.samples.montana.flavomontana.allopatric.csv -v gimble.vcf.gz -z /scratch/npoikela/montana.flavomontana.allopatric.CDS.autosomes_collinear.64bp

gIMble/./gIMble blocks -z /scratch/npoikela/montana.flavomontana.allopatric.CDS.autosomes_collinear.64bp.z -l 64 -f

gIMble/./gIMble info -z /scratch/npoikela/montana.flavomontana.allopatric.CDS.autosomes_collinear.64bp.z

# gimble v0.7.1
[+] [ =========================================== Storage =========================================== ]
[+] 2montana.flavomontana.allopatric.CDS.autosomes_collinear.64bp.z ................. 60.5 MB | 100.00%
[+] ├── blocks ...................................................................... 52.9 MB |  87.35%
[+] ├── seqs ......................................................................... 7.7 MB |  12.64%
[+] └── tally ........................................................................ 4.2 KB |   0.01%
[+] [ ========================================= Parsed data ========================================= ]
[+] seqs
[+] ├── genome .................................... 116,312,519 b in 5 sequence(s) (n50 = 26,508,887 b)
[+] ├── populations ....................................................... 12 samples in 2 populations
[+] │  ├── A = flavomontana                                                                           9
[+] │  └── B = montana                                                                                3
[+] ├── sample sets ................................................................................ 66
[+] │  ├── INTER-population sample-sets (X)                                                          27
[+] │  ├── INTRA-population sample-sets (A)                                                          36
[+] │  └── INTRA-population sample-sets (B)                                                           3
[+] ├── variants .............................................................. 611,643 (5.26 per 1 kb)
[+] │  │                                                                 HOMREF  HOMALT     HET    MISS
[+] │  ├── fla3Fall                                                      56.86%  35.96%   6.03%   1.15%
[+] │  ├── flaASH13F2                                                    57.11%  35.98%   5.37%   1.54%
[+] │  ├── flaCRAN14F7                                                   56.44%  35.46%   6.92%   1.18%
[+] │  ├── flaJX13F31                                                    56.24%  35.57%   6.72%   1.47%
[+] │  ├── flaLB15F3                                                     56.59%  36.05%   5.38%   1.98%
[+] │  ├── flaMB14F10                                                    57.02%  35.89%   6.02%   1.06%
[+] │  ├── flaMT13F11                                                    56.39%  35.71%   5.83%   2.07%
[+] │  ├── flaTER14F5                                                    56.96%  35.92%   5.98%   1.14%
[+] │  ├── flaVAN14F20                                                   56.63%  35.75%   5.95%   1.67%
[+] │  ├── monFA13F2                                                     83.69%   3.99%  11.80%   0.52%
[+] │  ├── monHO13F3                                                     83.84%   3.78%  11.94%   0.44%
[+] │  └── monSE13F37                                                    87.70%   0.03%  11.97%   0.29%
[+] └── intervals ............................ 134,276 intervals across 12,555,362 b (10.79% of genome)
[+] [ ============================================ Blocks =========================================== ]
[+] blocks
[+] ├── '-l 64 -m 128 -u 3 -i 3' .................................  11,874,086 blocks (0.22% discarded)
[+] │                                                                     X             A             B
[+] ├── BED interval sites in blocks (estimated %)                   91.75%        91.62%        92.36%
[+] ├── Total blocks                                              4,859,933     6,470,582       543,571
[+] ├── Invariant blocks                                             27.66%        76.10%        57.44%
[+] ├── Four-gamete-violation blocks                                  0.23%         0.03%         0.19%
[+] ├── Heterozygosity (population A)                               0.00292       0.00286             -
[+] ├── Heterozygosity (population B)                               0.00576             -       0.00585
[+] ├── D_xy                                                        0.02025             -             -
[+] ├── F_st                                                        0.64721             -             -
[+] ├── Pi                                                                -       0.00286       0.00591
[+] └── Watterson theta                                                   -       0.00284       0.00594
[+] [ =========================================== Windows =========================================== ]
[+] [ =========================================== Tallies =========================================== ]
[+] Tally
[+] └── 'tally/blocks_raw' .......................................................  shape (9, 9, 9, 9)







# 4 inversion

bedtools intersect -a gimble.D_montana.ref_genome.non_repeats.CDS.sorted.merged.bed -b 4_inverted.bed > gimble.D_montana.ref_genome.non_repeats.CDS.4_inverted.bed
sort -k1,1V -k2,2n -k3,3n gimble.D_montana.ref_genome.non_repeats.CDS.4_inverted.bed > gimble.D_montana.ref_genome.non_repeats.CDS.4_inverted.sorted.bed

gIMble/./gIMble measure -f -g gimble.4.genomefile -b gimble.D_montana.ref_genome.non_repeats.CDS.4_inverted.sorted.bed -s gimble.samples.montana.flavomontana.allopatric.csv -v gimble.vcf.gz -z /scratch/npoikela/montana.flavomontana.allopatric.CDS.4_inverted.64bp

gIMble/./gIMble blocks -z /scratch/npoikela/montana.flavomontana.allopatric.CDS.4_inverted.64bp.z -l 64 -f

gIMble/./gIMble info -z /scratch/npoikela/montana.flavomontana.allopatric.CDS.4_inverted.64bp.z

# gimble v0.7.1
[+] [ =========================================== Storage =========================================== ]
[+] 2montana.flavomontana.allopatric.CDS.4_inverted.64bp.z ........................... 9.1 MB | 100.00%
[+] ├── blocks ....................................................................... 7.9 MB |  86.51%
[+] ├── seqs ......................................................................... 1.2 MB |  13.45%
[+] └── tally ........................................................................ 2.5 KB |   0.03%
[+] [ ========================================= Parsed data ========================================= ]
[+] seqs
[+] ├── genome ..................................... 32,544,174 b in 1 sequence(s) (n50 = 32,544,174 b)
[+] ├── populations ....................................................... 12 samples in 2 populations
[+] │  ├── A = flavomontana                                                                           9
[+] │  └── B = montana                                                                                3
[+] ├── sample sets ................................................................................ 66
[+] │  ├── INTER-population sample-sets (X)                                                          27
[+] │  ├── INTRA-population sample-sets (A)                                                          36
[+] │  └── INTRA-population sample-sets (B)                                                           3
[+] ├── variants ............................................................... 97,011 (2.98 per 1 kb)
[+] │  │                                                                 HOMREF  HOMALT     HET    MISS
[+] │  ├── fla3Fall                                                      56.04%  36.81%   6.35%   0.80%
[+] │  ├── flaASH13F2                                                    55.97%  36.50%   6.19%   1.34%
[+] │  ├── flaCRAN14F7                                                   56.28%  36.70%   6.14%   0.89%
[+] │  ├── flaJX13F31                                                    55.82%  36.65%   6.40%   1.12%
[+] │  ├── flaLB15F3                                                     55.91%  36.80%   5.78%   1.51%
[+] │  ├── flaMB14F10                                                    56.47%  36.78%   6.03%   0.73%
[+] │  ├── flaMT13F11                                                    55.79%  36.50%   6.05%   1.66%
[+] │  ├── flaTER14F5                                                    56.50%  36.79%   6.03%   0.68%
[+] │  ├── flaVAN14F20                                                   55.84%  36.54%   6.36%   1.26%
[+] │  ├── monFA13F2                                                     84.63%   3.98%  11.19%   0.20%
[+] │  ├── monHO13F3                                                     84.61%   4.17%  10.95%   0.28%
[+] │  └── monSE13F37                                                    89.01%   0.04%  10.90%   0.04%
[+] └── intervals ............................... 18,736 intervals across 1,852,599 b (5.69% of genome)
[+] [ ============================================ Blocks =========================================== ]
[+] blocks
[+] ├── '-l 64 -m 128 -u 3 -i 3' ..................................  1,754,497 blocks (0.23% discarded)
[+] │                                                                     X             A             B
[+] ├── BED interval sites in blocks (estimated %)                   91.89%        91.74%        92.48%
[+] ├── Total blocks                                                718,152       956,039        80,306
[+] ├── Invariant blocks                                             24.54%        72.63%        56.69%
[+] ├── Four-gamete-violation blocks                                  0.20%         0.03%         0.11%
[+] ├── Heterozygosity (population A)                               0.00323       0.00320             -
[+] ├── Heterozygosity (population B)                               0.00569             -       0.00578
[+] ├── D_xy                                                        0.02206             -             -
[+] ├── F_st                                                        0.66363             -             -
[+] ├── Pi                                                                -       0.00323       0.00594
[+] └── Watterson theta                                                   -       0.00321       0.00593
[+] [ =========================================== Windows =========================================== ]
[+] [ =========================================== Tallies =========================================== ]
[+] Tally
[+] └── 'tally/blocks_raw' .......................................................  shape (9, 9, 9, 9)






# 5 inversion

bedtools intersect -a gimble.D_montana.ref_genome.non_repeats.CDS.sorted.merged.bed -b 5_inverted.bed > gimble.D_montana.ref_genome.non_repeats.CDS.5_inverted.bed
sort -k1,1V -k2,2n -k3,3n gimble.D_montana.ref_genome.non_repeats.CDS.5_inverted.bed > gimble.D_montana.ref_genome.non_repeats.CDS.5_inverted.sorted.bed

gIMble/./gIMble measure -f -g gimble.5.genomefile -b gimble.D_montana.ref_genome.non_repeats.CDS.5_inverted.sorted.bed -s gimble.samples.montana.flavomontana.allopatric.csv -v gimble.vcf.gz -z /scratch/npoikela/montana.flavomontana.allopatric.CDS.5_inverted.64bp

gIMble/./gIMble blocks -z /scratch/npoikela/montana.flavomontana.allopatric.CDS.5_inverted.64bp.z -l 64 -f

gIMble/./gIMble info -z /scratch/npoikela/montana.flavomontana.allopatric.CDS.5_inverted.64bp.z

# gimble v0.7.1
[+] [ =========================================== Storage =========================================== ]
[+] 2montana.flavomontana.allopatric.CDS.5_inverted.64bp.z ........................... 7.7 MB | 100.00%
[+] ├── blocks ....................................................................... 6.7 MB |  86.68%
[+] ├── seqs ......................................................................... 1.0 MB |  13.27%
[+] └── tally ........................................................................ 2.9 KB |   0.04%
[+] [ ========================================= Parsed data ========================================= ]
[+] seqs
[+] ├── genome ..................................... 26,508,887 b in 1 sequence(s) (n50 = 26,508,887 b)
[+] ├── populations ....................................................... 12 samples in 2 populations
[+] │  ├── A = flavomontana                                                                           9
[+] │  └── B = montana                                                                                3
[+] ├── sample sets ................................................................................ 66
[+] │  ├── INTER-population sample-sets (X)                                                          27
[+] │  ├── INTRA-population sample-sets (A)                                                          36
[+] │  └── INTRA-population sample-sets (B)                                                           3
[+] ├── variants ............................................................... 76,316 (2.88 per 1 kb)
[+] │  │                                                                 HOMREF  HOMALT     HET    MISS
[+] │  ├── fla3Fall                                                      58.56%  34.36%   6.09%   0.99%
[+] │  ├── flaASH13F2                                                    58.69%  34.19%   5.88%   1.25%
[+] │  ├── flaCRAN14F7                                                   58.35%  34.34%   6.17%   1.14%
[+] │  ├── flaJX13F31                                                    58.25%  34.31%   6.25%   1.19%
[+] │  ├── flaLB15F3                                                     58.28%  34.63%   5.28%   1.81%
[+] │  ├── flaMB14F10                                                    58.54%  34.33%   6.22%   0.91%
[+] │  ├── flaMT13F11                                                    58.18%  34.28%   6.13%   1.41%
[+] │  ├── flaTER14F5                                                    58.55%  34.49%   5.83%   1.12%
[+] │  ├── flaVAN14F20                                                   58.46%  34.26%   6.02%   1.27%
[+] │  ├── monFA13F2                                                     83.85%   3.65%  11.93%   0.58%
[+] │  ├── monHO13F3                                                     84.40%   3.32%  11.84%   0.44%
[+] │  └── monSE13F37                                                    87.59%   0.03%  11.97%   0.41%
[+] └── intervals ............................... 16,068 intervals across 1,538,721 b (5.80% of genome)
[+] [ ============================================ Blocks =========================================== ]
[+] blocks
[+] ├── '-l 64 -m 128 -u 3 -i 3' ..................................  1,446,800 blocks (0.21% discarded)
[+] │                                                                     X             A             B
[+] ├── BED interval sites in blocks (estimated %)                   91.20%        91.13%        91.55%
[+] ├── Total blocks                                                592,002       788,763        66,035
[+] ├── Invariant blocks                                             27.68%        76.37%        56.06%
[+] ├── Four-gamete-violation blocks                                  0.19%         0.02%         0.11%
[+] ├── Heterozygosity (population A)                               0.00290       0.00289             -
[+] ├── Heterozygosity (population B)                               0.00585             -       0.00593
[+] ├── D_xy                                                        0.01997             -             -
[+] ├── F_st                                                        0.64051             -             -
[+] ├── Pi                                                                -       0.00284       0.00596
[+] └── Watterson theta                                                   -       0.00281       0.00601
[+] [ =========================================== Windows =========================================== ]
[+] [ =========================================== Tallies =========================================== ]
[+] Tally
[+] └── 'tally/blocks_raw' .......................................................  shape (9, 9, 9, 9)





# collinear X chromosome

bedtools intersect -a gimble.D_montana.ref_genome.non_repeats.CDS.sorted.merged.bed -b X_collinear.bed > gimble.D_montana.ref_genome.non_repeats.CDS.X_collinear.bed
sort -k1,1V -k2,2n -k3,3n gimble.D_montana.ref_genome.non_repeats.CDS.X_collinear.bed > gimble.D_montana.ref_genome.non_repeats.CDS.X_collinear.sorted.bed

gIMble/./gIMble measure -f -g gimble.X.genomefile -b gimble.D_montana.ref_genome.non_repeats.CDS.X_collinear.sorted.bed -s gimble.samples.montana.flavomontana.allopatric.csv -v gimble.vcf.gz -z /scratch/npoikela/montana.flavomontana.allopatric.CDS.X_collinear.64bp

gIMble/./gIMble blocks -z /scratch/npoikela/montana.flavomontana.allopatric.CDS.X_collinear.64bp.z -l 64 -f

gIMble/./gIMble info -z /scratch/npoikela/montana.flavomontana.allopatric.CDS.X_collinear.64bp.z

# gimble v0.7.1
[+] [ =========================================== Storage =========================================== ]
[+] 2montana.flavomontana.allopatric.CDS.X_collinear.64bp.z .......................... 6.7 MB | 100.00%
[+] ├── blocks ....................................................................... 6.1 MB |  90.44%
[+] ├── seqs ....................................................................... 653.0 KB |   9.51%
[+] └── tally ........................................................................ 2.5 KB |   0.04%
[+] [ ========================================= Parsed data ========================================= ]
[+] seqs
[+] ├── genome ..................................... 29,140,820 b in 1 sequence(s) (n50 = 29,140,820 b)
[+] ├── populations ....................................................... 12 samples in 2 populations
[+] │  ├── A = flavomontana                                                                           9
[+] │  └── B = montana                                                                                3
[+] ├── sample sets ................................................................................ 66
[+] │  ├── INTER-population sample-sets (X)                                                          27
[+] │  ├── INTRA-population sample-sets (A)                                                          36
[+] │  └── INTRA-population sample-sets (B)                                                           3
[+] ├── variants ............................................................... 50,889 (1.75 per 1 kb)
[+] │  │                                                                 HOMREF  HOMALT     HET    MISS
[+] │  ├── fla3Fall                                                      48.50%  44.93%   5.34%   1.23%
[+] │  ├── flaASH13F2                                                    48.98%  45.48%   3.80%   1.74%
[+] │  ├── flaCRAN14F7                                                   48.46%  44.88%   5.46%   1.20%
[+] │  ├── flaJX13F31                                                    48.14%  44.96%   5.40%   1.49%
[+] │  ├── flaLB15F3                                                     48.28%  45.04%   4.84%   1.84%
[+] │  ├── flaMB14F10                                                    48.63%  44.91%   5.22%   1.24%
[+] │  ├── flaMT13F11                                                    48.02%  44.57%   5.26%   2.14%
[+] │  ├── flaTER14F5                                                    48.54%  44.89%   5.30%   1.28%
[+] │  ├── flaVAN14F20                                                   48.52%  44.98%   4.94%   1.56%
[+] │  ├── monFA13F2                                                     86.12%   4.34%   8.90%   0.63%
[+] │  ├── monHO13F3                                                     87.88%   2.38%   9.28%   0.45%
[+] │  └── monSE13F37                                                    90.16%   0.03%   9.33%   0.48%
[+] └── intervals ............................... 17,131 intervals across 1,492,814 b (5.12% of genome)
[+] [ ============================================ Blocks =========================================== ]
[+] blocks
[+] ├── '-l 64 -m 128 -u 3 -i 3' ..................................  1,422,640 blocks (0.11% discarded)
[+] │                                                                     X             A             B
[+] ├── BED interval sites in blocks (estimated %)                   92.44%        92.36%        92.81%
[+] ├── Total blocks                                                582,144       775,554        64,942
[+] ├── Invariant blocks                                             35.13%        86.46%        72.11%
[+] ├── Four-gamete-violation blocks                                  0.19%         0.04%         0.07%
[+] ├── Heterozygosity (population A)                               0.00167       0.00164             -
[+] ├── Heterozygosity (population B)                               0.00301             -       0.00310
[+] ├── D_xy                                                        0.01694             -             -
[+] ├── F_st                                                        0.75704             -             -
[+] ├── Pi                                                                -       0.00162       0.00332
[+] └── Watterson theta                                                   -       0.00158       0.00331
[+] [ =========================================== Windows =========================================== ]
[+] [ =========================================== Tallies =========================================== ]
[+] Tally
[+] └── 'tally/blocks_raw' .......................................................  shape (9, 9, 9, 9)






# X inversions

bedtools intersect -a gimble.D_montana.ref_genome.non_repeats.CDS.sorted.merged.bed -b X_inverted.bed > gimble.D_montana.ref_genome.non_repeats.CDS.X_inverted.bed
sort -k1,1V -k2,2n -k3,3n gimble.D_montana.ref_genome.non_repeats.CDS.X_inverted.bed > gimble.D_montana.ref_genome.non_repeats.CDS.X_inverted.sorted.bed

gIMble/./gIMble measure -f -g gimble.X.genomefile -b gimble.D_montana.ref_genome.non_repeats.CDS.X_inverted.sorted.bed -s gimble.samples.montana.flavomontana.allopatric.csv -v gimble.vcf.gz -z /scratch/npoikela/montana.flavomontana.allopatric.CDS.X_inverted.64bp

gIMble/./gIMble blocks -z /scratch/npoikela/montana.flavomontana.allopatric.CDS.X_inverted.64bp.z -l 64 -f

gIMble/./gIMble info -z /scratch/npoikela/montana.flavomontana.allopatric.CDS.X_inverted.64bp.z

# gimble v0.7.1
[+] [ =========================================== Storage =========================================== ]
[+] 2montana.flavomontana.allopatric.CDS.X_inverted.64bp.z ........................... 9.9 MB | 100.00%
[+] ├── blocks ....................................................................... 8.6 MB |  86.69%
[+] ├── seqs ......................................................................... 1.3 MB |  13.27%
[+] └── tally ........................................................................ 2.8 KB |   0.03%
[+] [ ========================================= Parsed data ========================================= ]
[+] seqs
[+] ├── genome ..................................... 29,140,820 b in 1 sequence(s) (n50 = 29,140,820 b)
[+] ├── populations ....................................................... 12 samples in 2 populations
[+] │  ├── A = flavomontana                                                                           9
[+] │  └── B = montana                                                                                3
[+] ├── sample sets ................................................................................ 66
[+] │  ├── INTER-population sample-sets (X)                                                          27
[+] │  ├── INTRA-population sample-sets (A)                                                          36
[+] │  └── INTRA-population sample-sets (B)                                                           3
[+] ├── variants ............................................................... 85,520 (2.93 per 1 kb)
[+] │  │                                                                 HOMREF  HOMALT     HET    MISS
[+] │  ├── fla3Fall                                                      50.09%  43.20%   5.54%   1.17%
[+] │  ├── flaASH13F2                                                    50.23%  43.26%   4.79%   1.73%
[+] │  ├── flaCRAN14F7                                                   47.80%  41.32%   9.30%   1.58%
[+] │  ├── flaJX13F31                                                    47.83%  41.60%   9.10%   1.48%
[+] │  ├── flaLB15F3                                                     49.69%  43.23%   4.77%   2.30%
[+] │  ├── flaMB14F10                                                    48.23%  41.46%   9.40%   0.91%
[+] │  ├── flaMT13F11                                                    47.34%  41.09%   8.98%   2.59%
[+] │  ├── flaTER14F5                                                    50.14%  43.14%   5.24%   1.48%
[+] │  ├── flaVAN14F20                                                   49.75%  42.84%   5.25%   2.17%
[+] │  ├── monFA13F2                                                     86.79%   3.87%   8.39%   0.95%
[+] │  ├── monHO13F3                                                     89.77%   2.33%   6.92%   0.99%
[+] │  └── monSE13F37                                                    91.81%   0.04%   7.23%   0.92%
[+] └── intervals ............................... 28,962 intervals across 2,090,679 b (7.17% of genome)
[+] [ ============================================ Blocks =========================================== ]
[+] blocks
[+] ├── '-l 64 -m 128 -u 3 -i 3' ..................................  1,969,742 blocks (0.15% discarded)
[+] │                                                                     X             A             B
[+] ├── BED interval sites in blocks (estimated %)                   91.28%        91.39%        91.69%
[+] ├── Total blocks                                                805,123     1,074,762        89,857
[+] ├── Invariant blocks                                             30.25%        78.36%        71.52%
[+] ├── Four-gamete-violation blocks                                  0.22%         0.07%         0.06%
[+] ├── Heterozygosity (population A)                               0.00282       0.00279             -
[+] ├── Heterozygosity (population B)                               0.00299             -       0.00309
[+] ├── D_xy                                                        0.01945             -             -
[+] ├── F_st                                                        0.73996             -             -
[+] ├── Pi                                                                -       0.00260       0.00335
[+] └── Watterson theta                                                   -       0.00256       0.00335
[+] [ =========================================== Windows =========================================== ]
[+] [ =========================================== Tallies =========================================== ]
[+] Tally
[+] └── 'tally/blocks_raw' .......................................................  shape (9, 9, 9, 9)







####################################################################################################################################################################################################################################################################################################################################################################################################################################

#### Intergenic background for dxy / fst simulations ####

## autosomes colinear, intergenic 

gIMble/./gIMble optimize -z /scratch/npoikela/2montana.flavomontana.sympatric.intergenic.autosomes_collinear.64bp.z -c gimble.optimize.IM_AB.sympatric.intergenic.autosomes_collinear.64bp.kmax2.model4.config.ini -t sympatric.intergenic.autosomes_collinear.64bp.kmax2.IM_AB_model4 -i 1000 --xtol 0.00000000000000001 --ftol 0.00000000000000001 -f -n 30

results: gimble.optimize.sympatric.intergenic.autosomes_collinear.64bp.kmax2.model4.0.20221007_193019.log

0,514,64,-129101349.59821434,1.0,0.4993544534459234,0.2762712879673355,3.3672797123912805,0.010229387330035058,380754.6003916321,762493.6510811858,1378190.991879873,2564214.482596784,1.3433044957977441e-08
0,515,64,-129101349.59821425,1.0,0.4993544534463697,0.2762712879673418,3.3672797123856495,0.010229387329907231,380754.6003919134,762493.6510810675,1378190.9918808597,2564214.48259439,1.3433044957799659e-08
0,516,64,-129101349.59821445,1.0,0.499354453445428,0.27627128796713113,3.3672797123936333,0.010229387330047088,380754.6003914782,762493.651081634,1378190.9918803354,2564214.482597539,1.3433044957998668e-08
0,517,64,-129101349.59821421,1.0,0.49935445344598944,0.2762712879673632,3.367279712390756,0.010229387330035158,380754.6003917094,762493.6510812397,1378190.9918800145,2564214.482596905,1.3433044957974845e-08
0,518,64,-129101349.59821427,1.0,0.4993544534457075,0.2762712879672473,3.3672797123919405,0.01022938733004325,380754.60039166344,762493.6510815781,1378190.9918804262,2564214.4825974973,1.3433044957987093e-08

gIMble/./gIMble optimize -z /scratch/npoikela/2montana.flavomontana.allopatric.intergenic.autosomes_collinear.64bp.z -c gimble.optimize.IM_AB.allopatric.intergenic.autosomes_collinear.64bp.kmax2.model4.config.ini -t allopatric.intergenic.autosomes_collinear.64bp.kmax2.IM_AB_model4 -i 1000 --xtol 0.00000000000000001 --ftol 0.00000000000000001 -f -n 30

results: gimble.optimize.allopatric.intergenic.autosomes_collinear.64bp.kmax2.model4.0.20221007_142925.log

0,514,64,-43046368.353824764,1.0,0.5302274664033017,0.2766626014994483,3.33268477822588,0.008736425978296955,386119.83378634346,728215.4513901642,1395634.3636388218,2573631.3852617075,1.1313101806538111e-08
0,515,64,-43046368.35382475,1.0,0.5302274664034217,0.27666260149957506,3.3326847782262345,0.008736425978301215,386119.83378636895,728215.4513900476,1395634.3636382744,2573631.3852621512,1.131310180654288e-08
0,516,64,-43046368.353824764,1.0,0.5302274664035738,0.2766626014995418,3.3326847782258118,0.008736425978315195,386119.83378637535,728215.4513898507,1395634.3636384653,2573631.385261867,1.1313101806560796e-08
0,517,64,-43046368.353824735,1.0,0.5302274664035896,0.2766626014996446,3.332684778226437,0.008736425978316205,386119.83378634334,728215.4513897685,1395634.363637831,2573631.385262137,1.1313101806563042e-08
0,518,64,-43046368.35382477,1.0,0.5302274664035006,0.27666260149960786,3.332684778226328,0.00873642597830765,386119.83378635766,728215.4513899178,1395634.363638068,2573631.385262148,1.1313101806551545e-08


## X colinear, intergenic

gIMble/./gIMble optimize -z /scratch/npoikela/2montana.flavomontana.sympatric.intergenic.X_collinear.64bp.z -c gimble.optimize.IM_AB.sympatric.intergenic.X_collinear.64bp.kmax2.model4.config.ini -t sympatric.intergenic.X_collinear.64bp.kmax2.IM_model4 -i 1000 --xtol 0.00000000000000001 --ftol 0.00000000000000001 -f -n 30

results: gimble.optimize.sympatric.intergenic.X_collinear.64bp.kmax2.model4.0.20221106_070133.log

0,578,64,-36254507.153319746,1.0,0.4705642664687799,0.13515567485653376,5.5415994169783485,0.022264018887141353,238791.87908207427,507458.5898203071,1766791.363629749,2646577.875800774,4.661804030506638e-08
0,579,64,-36254507.15331984,1.0,0.4705642664696004,0.13515567485669372,5.541599416975338,0.02226401888724293,238791.87908246188,507458.589820246,1766791.3636305258,2646577.8758036327,4.66180403052034e-08
0,580,64,-36254507.15331961,1.0,0.470564266469146,0.13515567485651261,5.541599416973978,0.022264018887102176,238791.87908219727,507458.5898201737,1766791.3636309355,2646577.87580005,4.661804030496034e-08
0,581,64,-36254507.153319634,1.0,0.4705642664692749,0.13515567485648314,5.541599416971633,0.022264018887122226,238791.87908224648,507458.5898201392,1766791.3636316848,2646577.8757994757,4.6618040304992715e-08
0,582,64,-36254507.15331989,1.0,0.47056426646890803,0.13515567485653343,5.54159941697701,0.02226401888714028,238791.8790821692,507458.58982037066,1766791.363630456,2646577.875801187,4.66180403050456e-08

 
gIMble/./gIMble optimize -z /scratch/npoikela/2montana.flavomontana.allopatric.intergenic.X_collinear.64bp.z -c gimble.optimize.IM_AB.allopatric.intergenic.X_collinear.64bp.kmax2.model4.config.ini -t allopatric.intergenic.X_collinear.64bp.kmax2.IM_model4 -i 1000 --xtol 0.00000000000000001 --ftol 0.00000000000000001 -f -n 30

results: gimble.optimize.allopatric.intergenic.X_collinear.64bp.kmax2.model4.0.20221106_070817.log

0,561,64,-11953507.247514494,1.0,0.5786109203542482,0.13045409451181286,4.479280259530013,0.0169283039695039,254876.25497835237,440496.79328953417,1953762.0182191585,2283324.3550949437,3.320886830148553e-08
0,562,64,-11953507.247514468,1.0,0.5786109203536907,0.1304540945118932,4.479280259538198,0.01692830396955143,254876.25497829157,440496.79328985355,1953762.0182174898,2283324.3550985716,3.32088683015867e-08
0,563,64,-11953507.247514453,1.0,0.5786109203540662,0.13045409451186807,4.4792802595336285,0.01692830396952122,254876.25497834565,440496.793289661,1953762.0182182805,2283324.3550967267,3.3208868301520384e-08
0,564,64,-11953507.24751446,1.0,0.5786109203537348,0.13045409451186873,4.479280259536983,0.016928303969547722,254876.25497828514,440496.79328980873,1953762.0182178067,2283324.3550978946,3.320886830158026e-08
0,565,64,-11953507.247514471,1.0,0.5786109203536445,0.13045409451189294,4.479280259538576,0.016928303969553176,254876.25497828255,440496.7932898731,1953762.0182174244,2283324.3550986834,3.3208868301591296e-08



#### Coding and intronic background for dxy / fst simulations ####

### autosomes colinear, introns

bedtools intersect -a gimble2.bed -b D_montana.ref_genome.non_repeats.introns.sorted.merged.bed > gimble2.D_montana.ref_genome.non_repeats.introns.bed
sort -k1,1V -k2,2n gimble2.D_montana.ref_genome.non_repeats.introns.bed > gimble2.D_montana.ref_genome.non_repeats.introns.sorted.merged.bed

bedtools intersect -a gimble2.D_montana.ref_genome.non_repeats.introns.sorted.merged.bed -b autosomes_collinear.bed > gimble2.D_montana.ref_genome.non_repeats.introns.autosomes_collinear.bed
sort -k1,1V -k2,2n -k3,3n gimble2.D_montana.ref_genome.non_repeats.introns.autosomes_collinear.bed > gimble2.D_montana.ref_genome.non_repeats.introns.autosomes_collinear.sorted.bed


## measure
gIMble/./gIMble measure -f -g gimble2.autosomes.genomefile -b gimble2.D_montana.ref_genome.non_repeats.introns.autosomes_collinear.sorted.bed -s gimble2.samples.montana.flavomontana.sympatric.csv -v gimble2.vcf.gz -z /scratch/npoikela/2montana.flavomontana.sympatric.introns.autosomes_collinear.64bp

gIMble/./gIMble measure -f -g gimble2.autosomes.genomefile -b gimble2.D_montana.ref_genome.non_repeats.introns.autosomes_collinear.sorted.bed -s gimble2.samples.montana.flavomontana.allopatric.csv -v gimble2.vcf.gz -z /scratch/npoikela/2montana.flavomontana.allopatric.introns.autosomes_collinear.64bp


## blocks
gIMble/./gIMble blocks -z /scratch/npoikela/2montana.flavomontana.sympatric.introns.autosomes_collinear.64bp.z -l 64 -f
gIMble/./gIMble blocks -z /scratch/npoikela/2montana.flavomontana.allopatric.introns.autosomes_collinear.64bp.z -l 64 -f

## tally
gIMble/./gIMble tally -z /scratch/npoikela/2montana.flavomontana.sympatric.introns.autosomes_collinear.64bp.z -d blocks -l sympatric.introns.autosomes_collinear.64bp.kmax2.IM_model4 -k 2,2,2,2 -S gimble2.autosomes.genomefile --overwrite

gIMble/./gIMble tally -z /scratch/npoikela/2montana.flavomontana.allopatric.introns.autosomes_collinear.64bp.z -d blocks -l allopatric.introns.autosomes_collinear.64bp.kmax2.IM_model4 -k 2,2,2,2 -S gimble2.autosomes.genomefile --overwrite


# mu = 2.8e-9
gIMble/./gIMble makeconfig -l sympatric.introns.autosomes_collinear.64bp.kmax2.model4 -t optimize -m 4
[+] Wrote INI file 'gimble.optimize.IM_AB.sympatric.introns.autosomes_collinear.64bp.kmax2.model4.config.ini'. Please fill in values before starting 'optimize'.
[*] Total runtime was 00h:00m:00.005s

gIMble/./gIMble makeconfig -l allopatric.introns.autosomes_collinear.64bp.kmax2.model4 -t optimize -m 4
[+] Wrote INI file 'gimble.optimize.IM_AB.allopatric.introns.autosomes_collinear.64bp.kmax2.model4.config.ini'. Please fill in values before starting 'optimize'.
[*] Total runtime was 00h:00m:00.027s


gIMble/./gIMble optimize -z /scratch/npoikela/2montana.flavomontana.sympatric.introns.autosomes_collinear.64bp.z -c gimble.optimize.IM_AB.sympatric.introns.autosomes_collinear.64bp.kmax2.model4.config.ini -t sympatric.introns.autosomes_collinear.64bp.kmax2.IM_model4 -i 1000 --xtol 0.00000000000000001 --ftol 0.00000000000000001 -f -n 60

results: gimble.optimize.sympatric.introns.autosomes_collinear.64bp.kmax2.model4.0.20240113_231637.log

0,590,64,-66588753.7013882,1.0,0.5007377618094868,0.26306885375178146,3.4416773711860675,0.009677740649151766,379943.16221735533,758766.7461794312,1444272.694386887,2615283.567480698,1.2735774204584038e-08
0,591,64,-66588753.701388076,1.0,0.5007377618094597,0.26306885375183875,3.4416773711860187,0.009677740649138953,379943.1622173587,758766.7461794789,1444272.6943865854,2615283.5674806843,1.2735774204567064e-08
0,592,64,-66588753.70138816,1.0,0.5007377618093894,0.2630688537517464,3.4416773711864748,0.009677740649156849,379943.1622173096,758766.7461794873,1444272.6943869055,2615283.5674806926,1.2735774204592262e-08
0,593,64,-66588753.70138807,1.0,0.500737761809352,0.26306885375172273,3.441677371186394,0.009677740649163307,379943.1622173149,758766.7461795546,1444272.6943870557,2615283.567480668,1.2735774204600582e-08
0,594,64,-66588753.70138807,1.0,0.5007377618094258,0.2630688537517163,3.441677371186563,0.009677740649160976,379943.16221730574,758766.7461794247,1444272.6943870564,2615283.5674807336,1.273577420459782e-08


gIMble/./gIMble optimize -z /scratch/npoikela/2montana.flavomontana.allopatric.introns.autosomes_collinear.64bp.z -c gimble.optimize.IM_AB.allopatric.introns.autosomes_collinear.64bp.kmax2.model4.config.ini -t allopatric.introns.autosomes_collinear.64bp.kmax2.IM_model4 -i 1000 --xtol 0.00000000000000001 --ftol 0.00000000000000001 -f -n 60

results: gimble.optimize.allopatric.introns.autosomes_collinear.64bp.kmax2.model4.0.20240113_230922.log

0,677,64,-22224406.661696132,1.0,0.5219040897804555,0.2648221672834952,3.435188903028998,0.008814393681278915,384378.27441811067,736492.167708062,1451458.0798163668,2640823.9656930575,1.1465780284568042e-08
0,678,64,-22224406.66169611,1.0,0.5219040897804198,0.264822167283468,3.435188903029034,0.00881439368126902,384378.2744180758,736492.1677080456,1451458.0798163842,2640823.9656928456,1.1465780284556211e-08
0,679,64,-22224406.661696106,1.0,0.5219040897804581,0.26482216728348246,3.4351889030294074,0.008814393681280267,384378.2744180743,736492.1677079885,1451458.0798162995,2640823.9656931222,1.1465780284570884e-08
0,680,64,-22224406.661696106,1.0,0.5219040897804971,0.26482216728347524,3.435188903029467,0.008814393681281622,384378.2744180716,736492.1677079285,1451458.0798163288,2640823.9656931497,1.1465780284572727e-08
0,681,64,-22224406.661696125,1.0,0.5219040897804613,0.2648221672834663,3.4351889030291325,0.008814393681272315,384378.2744180716,736492.1677079789,1451458.079816378,2640823.9656928927,1.146578028456062e-08


### autosomes collinear, CDS

bedtools intersect -a gimble2.bed -b D_montana.ref_genome.non_repeats.CDS.sorted.merged.bed > gimble2.D_montana.ref_genome.non_repeats.CDS.bed
sort -k1,1V -k2,2n gimble2.D_montana.ref_genome.non_repeats.CDS.bed > gimble2.D_montana.ref_genome.non_repeats.CDS.sorted.merged.bed

bedtools intersect -a gimble2.D_montana.ref_genome.non_repeats.CDS.sorted.merged.bed -b autosomes_collinear.bed > gimble2.D_montana.ref_genome.non_repeats.CDS.autosomes_collinear.bed
sort -k1,1V -k2,2n -k3,3n gimble2.D_montana.ref_genome.non_repeats.CDS.autosomes_collinear.bed > gimble2.D_montana.ref_genome.non_repeats.CDS.autosomes_collinear.sorted.bed


## measure
gIMble/./gIMble measure -f -g gimble2.autosomes.genomefile -b gimble2.D_montana.ref_genome.non_repeats.CDS.autosomes_collinear.sorted.bed -s gimble2.samples.montana.flavomontana.sympatric.csv -v gimble2.vcf.gz -z /scratch/npoikela/2montana.flavomontana.sympatric.CDS.autosomes_collinear.64bp

gIMble/./gIMble measure -f -g gimble2.autosomes.genomefile -b gimble2.D_montana.ref_genome.non_repeats.CDS.autosomes_collinear.sorted.bed -s gimble2.samples.montana.flavomontana.allopatric.csv -v gimble2.vcf.gz -z /scratch/npoikela/2montana.flavomontana.allopatric.CDS.autosomes_collinear.64bp

## blocks
gIMble/./gIMble blocks -z /scratch/npoikela/2montana.flavomontana.sympatric.CDS.autosomes_collinear.64bp.z -l 64 -f
gIMble/./gIMble blocks -z /scratch/npoikela/2montana.flavomontana.allopatric.CDS.autosomes_collinear.64bp.z -l 64 -f

## tally
gIMble/./gIMble tally -z /scratch/npoikela/2montana.flavomontana.sympatric.CDS.autosomes_collinear.64bp.z -d blocks -l sympatric.CDS.autosomes_collinear.64bp.kmax2.IM_model4 -k 2,2,2,2 -S gimble2.autosomes.genomefile --overwrite

gIMble/./gIMble tally -z /scratch/npoikela/2montana.flavomontana.allopatric.CDS.autosomes_collinear.64bp.z -d blocks -l allopatric.CDS.autosomes_collinear.64bp.kmax2.IM_model4 -k 2,2,2,2 -S gimble2.autosomes.genomefile --overwrite


# mu = 2.8e-9
gIMble/./gIMble makeconfig -l sympatric.CDS.autosomes_collinear.64bp.kmax2.model4 -t optimize -m 4
[+] Wrote INI file 'gimble.optimize.IM_AB.sympatric.CDS.autosomes_collinear.64bp.kmax2.model4.config.ini'. Please fill in values before starting 'optimize'.
[*] Total runtime was 00h:00m:00.005s

gIMble/./gIMble makeconfig -l allopatric.CDS.autosomes_collinear.64bp.kmax2.model4 -t optimize -m 4
[+] Wrote INI file 'gimble.optimize.IM_AB.allopatric.CDS.autosomes_collinear.64bp.kmax2.model4.config.ini'. Please fill in values before starting 'optimize'.
[*] Total runtime was 00h:00m:00.027s



gIMble/./gIMble optimize -z /scratch/npoikela/2montana.flavomontana.sympatric.CDS.autosomes_collinear.64bp.z -c gimble.optimize.IM_AB.sympatric.CDS.autosomes_collinear.64bp.kmax2.model4.config.ini -t sympatric.CDS.autosomes_collinear.64bp.kmax2.IM_model4 -i 1000 --xtol 0.00000000000000001 --ftol 0.00000000000000001 -f -n 30

results: gimble.optimize.sympatric.CDS.autosomes_collinear.64bp.kmax2.model4.0.20240113_230402.log

0,538,64,-36697859.82823895,1.0,0.4111851697075179,0.23477841576072792,5.096421798585414,0.014231392695209741,195912.74612023996,476458.68711557763,834458.0803369186,1996907.979895842,3.6320742210604646e-08
0,539,64,-36697859.82823862,1.0,0.4111851697074462,0.2347784157606699,5.096421798587427,0.01423139269522358,195912.74612018146,476458.6871155185,834458.0803368755,1996907.9798960343,3.632074221065081e-08
0,540,64,-36697859.82823896,1.0,0.41118516970762076,0.23477841576062425,5.0964217985838305,0.014231392695193575,195912.74612021993,476458.68711540976,834458.0803372017,1996907.9798950173,3.63207422105671e-08
0,541,64,-36697859.82823889,1.0,0.4111851697075436,0.234778415760702,5.096421798585019,0.014231392695205701,195912.74612023495,476458.68711553566,834458.0803369894,1996907.979895636,3.632074221059526e-08
0,542,64,-36697859.82823923,1.0,0.41118516970759506,0.23477841576065017,5.096421798584227,0.014231392695197615,195912.74612022494,476458.6871154517,834458.0803371309,1996907.9798952234,3.632074221057648e-08


gIMble/./gIMble optimize -z /scratch/npoikela/2montana.flavomontana.allopatric.CDS.autosomes_collinear.64bp.z -c gimble.optimize.IM_AB.allopatric.CDS.autosomes_collinear.64bp.kmax2.model4.config.ini -t allopatric.CDS.autosomes_collinear.64bp.kmax2.IM_model4 -i 1000 --xtol 0.00000000000000001 --ftol 0.00000000000000001 -f -n 30

results: gimble.optimize.allopatric.CDS.autosomes_collinear.64bp.kmax2.model4.0.20240113_230403.log

0,630,64,-12214796.805622209,1.0,0.43401730176773157,0.23497028529270997,5.048436605718788,0.013985269666150135,198045.9218076347,456308.8176462164,842855.1787342923,1999644.5625339677,3.5308148581151444e-08
0,631,64,-12214796.80562222,1.0,0.434017301767891,0.2349702852927842,5.048436605716524,0.01398526966614385,198045.92180770636,456308.81764621387,842855.1787343309,1999644.5625337944,3.5308148581122804e-08
0,632,64,-12214796.80562233,1.0,0.43401730176785724,0.23497028529272204,5.048436605717406,0.013985269666144027,198045.92180766357,456308.8176461508,842855.1787343718,1999644.5625337118,3.530814858113088e-08
0,633,64,-12214796.805622414,1.0,0.43401730176777265,0.23497028529273217,5.04843660571831,0.013985269666150678,198045.9218076419,456308.81764618977,842855.1787342431,1999644.562533851,3.530814858115154e-08
0,634,64,-12214796.805622313,1.0,0.43401730176792014,0.23497028529275646,5.0484366057163506,0.013985269666137877,198045.92180771197,456308.81764619617,842855.1787344543,1999644.5625337826,3.5308148581106724e-08


## X collinear, introns

bedtools intersect -a gimble2.bed -b D_montana.ref_genome.non_repeats.introns.sorted.merged.bed > gimble2.D_montana.ref_genome.non_repeats.introns.bed
sort -k1,1V -k2,2n gimble2.D_montana.ref_genome.non_repeats.introns.bed > gimble2.D_montana.ref_genome.non_repeats.introns.sorted.merged.bed

bedtools intersect -a gimble2.D_montana.ref_genome.non_repeats.introns.sorted.merged.bed -b X_collinear.bed > gimble2.D_montana.ref_genome.non_repeats.introns.X_collinear.bed
sort -k1,1V -k2,2n -k3,3n gimble2.D_montana.ref_genome.non_repeats.introns.X_collinear.bed > gimble2.D_montana.ref_genome.non_repeats.introns.X_collinear.sorted.bed


## measure
gIMble/./gIMble measure -f -g gimble2.X.genomefile -b gimble2.D_montana.ref_genome.non_repeats.introns.X_collinear.sorted.bed -s gimble2.samples.montana.flavomontana.sympatric.csv -v gimble2.vcf.gz -z /scratch/npoikela/2montana.flavomontana.sympatric.introns.X_collinear.64bp

gIMble/./gIMble measure -f -g gimble2.X.genomefile -b gimble2.D_montana.ref_genome.non_repeats.introns.X_collinear.sorted.bed -s gimble2.samples.montana.flavomontana.allopatric.csv -v gimble2.vcf.gz -z /scratch/npoikela/2montana.flavomontana.allopatric.introns.X_collinear.64bp

## blocks
gIMble/./gIMble blocks -z /scratch/npoikela/2montana.flavomontana.sympatric.introns.X_collinear.64bp.z -l 64 -f
gIMble/./gIMble blocks -z /scratch/npoikela/2montana.flavomontana.allopatric.introns.X_collinear.64bp.z -l 64 -f

## tally
gIMble/./gIMble tally -z /scratch/npoikela/2montana.flavomontana.sympatric.introns.X_collinear.64bp.z -d blocks -l sympatric.introns.X_collinear.64bp.kmax2.IM_model4 -k 2,2,2,2 -S gimble2.X.genomefile --overwrite

gIMble/./gIMble tally -z /scratch/npoikela/2montana.flavomontana.allopatric.introns.X_collinear.64bp.z -d blocks -l allopatric.introns.X_collinear.64bp.kmax2.IM_model4 -k 2,2,2,2 -S gimble2.X.genomefile --overwrite


# mu = 2.8e-9
gIMble/./gIMble makeconfig -l sympatric.introns.X_collinear.64bp.kmax2.model4 -t optimize -m 4
[+] Wrote INI file 'gimble.optimize.IM_AB.sympatric.introns.X_collinear.64bp.kmax2.model4.config.ini'. Please fill in values before starting 'optimize'.
[*] Total runtime was 00h:00m:00.005s

gIMble/./gIMble makeconfig -l allopatric.introns.X_collinear.64bp.kmax2.model4 -t optimize -m 4
[+] Wrote INI file 'gimble.optimize.IM_AB.allopatric.introns.X_collinear.64bp.kmax2.model4.config.ini'. Please fill in values before starting 'optimize'.
[*] Total runtime was 00h:00m:00.027s


gIMble/./gIMble optimize -z /scratch/npoikela/2montana.flavomontana.sympatric.introns.X_collinear.64bp.z -c gimble.optimize.IM_AB.sympatric.introns.X_collinear.64bp.kmax2.model4.config.ini -t sympatric.introns.X_collinear.64bp.kmax2.IM_model4 -i 1000 --xtol 0.00000000000000001 --ftol 0.00000000000000001 -f -n 60

results: gimble.optimize.sympatric.introns.X_collinear.64bp.kmax2.model4.0.20240113_230116.log

0,591,64,-7302951.967219129,1.0,0.3999414259661011,0.13170181193002373,7.096408886614284,0.008295292890056412,209542.8100065261,523933.7472990029,1591039.6898553008,2974002.9181128806,1.97937903233188e-08
0,592,64,-7302951.967219144,1.0,0.39994142596613624,0.13170181193009053,7.096408886614334,0.008295292890052777,209542.81000656818,523933.7472990621,1591039.6898548133,2974002.918113499,1.979379032330615e-08
0,593,64,-7302951.967219132,1.0,0.39994142596628285,0.13170181193011232,7.0964088866093435,0.008295292890045377,209542.81000665098,523933.7472990771,1591039.6898551788,2974002.9181125825,1.979379032328067e-08
0,594,64,-7302951.96721914,1.0,0.39994142596605514,0.13170181193006708,7.096408886614833,0.008295292890056377,209542.81000654222,523933.7472991034,1591039.6898548994,2974002.9181133397,1.9793790323317192e-08
0,595,64,-7302951.967219157,1.0,0.399941425966084,0.1317018119300159,7.096408886613315,0.008295292890057544,209542.81000653518,523933.747299048,1591039.6898554643,2974002.918112603,1.9793790323320643e-08


gIMble/./gIMble optimize -z /scratch/npoikela/2montana.flavomontana.allopatric.introns.X_collinear.64bp.z -c gimble.optimize.IM_AB.allopatric.introns.X_collinear.64bp.kmax2.model4.config.ini -t allopatric.introns.X_collinear.64bp.kmax2.IM_model4 -i 1000 --xtol 0.00000000000000001 --ftol 0.00000000000000001 -f -n 60

results: gimble.optimize.allopatric.introns.X_collinear.64bp.kmax2.model4.0.20240114_182308.log

0,577,64,-2409252.875655053,1.0,0.4460520403624995,0.1280661633796538,6.695355056264817,0.007412465755417373,213502.50611550006,478649.3206980735,1667126.5889536263,2858950.1676912466,1.7359200812863983e-08
0,578,64,-2409252.8756550523,1.0,0.4460520403624623,0.12806616337964652,6.695355056265197,0.007412465755413885,213502.50611548824,478649.3206980869,1667126.588953629,2858950.167691251,1.7359200812856777e-08
0,579,64,-2409252.8756550564,1.0,0.4460520403624429,0.12806616337965318,6.69535505626595,0.00741246575541792,213502.5061154893,478649.32069811015,1667126.5889535502,2858950.1676915865,1.735920081286614e-08
0,580,64,-2409252.875655053,1.0,0.4460520403625297,0.12806616337964086,6.695355056265381,0.007412465755427006,213502.50611550204,478649.32069804554,1667126.5889538103,2858950.167691514,1.7359200812886383e-08
0,581,64,-2409252.875655053,1.0,0.446052040362434,0.12806616337964824,6.69535505626612,0.007412465755420921,213502.50611548004,478649.3206980989,1667126.5889535425,2858950.167691535,1.7359200812873923e-08


## X collinear, CDS

bedtools intersect -a gimble2.bed -b D_montana.ref_genome.non_repeats.CDS.sorted.merged.bed > gimble2.D_montana.ref_genome.non_repeats.CDS.bed
sort -k1,1V -k2,2n gimble2.D_montana.ref_genome.non_repeats.CDS.bed > gimble2.D_montana.ref_genome.non_repeats.CDS.sorted.merged.bed

bedtools intersect -a gimble2.D_montana.ref_genome.non_repeats.CDS.sorted.merged.bed -b X_collinear.bed > gimble2.D_montana.ref_genome.non_repeats.CDS.X_collinear.bed
sort -k1,1V -k2,2n -k3,3n gimble2.D_montana.ref_genome.non_repeats.CDS.X_collinear.bed > gimble2.D_montana.ref_genome.non_repeats.CDS.X_collinear.sorted.bed


## measure
gIMble/./gIMble measure -f -g gimble2.X.genomefile -b gimble2.D_montana.ref_genome.non_repeats.CDS.X_collinear.sorted.bed -s gimble2.samples.montana.flavomontana.sympatric.csv -v gimble2.vcf.gz -z /scratch/npoikela/2montana.flavomontana.sympatric.CDS.X_collinear.64bp

gIMble/./gIMble measure -f -g gimble2.X.genomefile -b gimble2.D_montana.ref_genome.non_repeats.CDS.X_collinear.sorted.bed -s gimble2.samples.montana.flavomontana.allopatric.csv -v gimble2.vcf.gz -z /scratch/npoikela/2montana.flavomontana.allopatric.CDS.X_collinear.64bp


## blocks
gIMble/./gIMble blocks -z /scratch/npoikela/2montana.flavomontana.sympatric.CDS.X_collinear.64bp.z -l 64 -f
gIMble/./gIMble blocks -z /scratch/npoikela/2montana.flavomontana.allopatric.CDS.X_collinear.64bp.z -l 64 -f

## tally
gIMble/./gIMble tally -z /scratch/npoikela/2montana.flavomontana.sympatric.CDS.X_collinear.64bp.z -d blocks -l sympatric.CDS.X_collinear.64bp.kmax2.IM_model4 -k 2,2,2,2 -S gimble2.X.genomefile --overwrite

gIMble/./gIMble tally -z /scratch/npoikela/2montana.flavomontana.allopatric.CDS.X_collinear.64bp.z -d blocks -l allopatric.CDS.X_collinear.64bp.kmax2.IM_model4 -k 2,2,2,2 -S gimble2.X.genomefile --overwrite

# mu = 2.8e-9
gIMble/./gIMble makeconfig -l sympatric.CDS.X_collinear.64bp.kmax2.model4 -t optimize -m 4
[+] Wrote INI file 'gimble.optimize.IM_AB.sympatric.CDS.X_collinear.64bp.kmax2.model4.config.ini'. Please fill in values before starting 'optimize'.
[*] Total runtime was 00h:00m:00.005s

gIMble/./gIMble makeconfig -l allopatric.CDS.X_collinear.64bp.kmax2.model4 -t optimize -m 4
[+] Wrote INI file 'gimble.optimize.IM_AB.allopatric.CDS.X_collinear.64bp.kmax2.model4.config.ini'. Please fill in values before starting 'optimize'.
[*] Total runtime was 00h:00m:00.027s

gIMble/./gIMble optimize -z /scratch/npoikela/2montana.flavomontana.sympatric.CDS.X_collinear.64bp.z -c gimble.optimize.IM_AB.sympatric.CDS.X_collinear.64bp.kmax2.model4.config.ini -t sympatric.CDS.X_collinear.64bp.kmax2.IM_model4 -i 1000 --xtol 0.00000000000000001 --ftol 0.00000000000000001 -f -n 60

results: gimble.optimize.sympatric.CDS.X_collinear.64bp.kmax2.model4.0.20240114_101738.log

0,526,64,-3303734.938411299,1.0,0.371074698118143,0.13748094639346095,9.029215014168244,0.007969649848940203,93672.5499830631,252435.83154041826,681349.324690992,1691579.1894449973,4.253994286683341e-08
0,527,64,-3303734.9384106793,1.0,0.3710746981176741,0.13748094639397807,9.029215014239249,0.007969649848859523,93672.54998281064,252435.83154005688,681349.3246865929,1691579.1894537406,4.2539942866517415e-08
0,528,64,-3303734.9384110332,1.0,0.3710746981186132,0.13748094639414024,9.029215014182059,0.00796964984888637,93672.54998303278,252435.83154001666,681349.324687405,1691579.1894470379,4.253994286655983e-08
0,529,64,-3303734.9384106128,1.0,0.37107469811757315,0.13748094639374703,9.02921501423023,0.007969649848880666,93672.54998283733,252435.83154019748,681349.324687932,1691579.1894525331,4.2539942866618146e-08
0,530,64,-3303734.9384112386,1.0,0.3710746981178281,0.1374809463938143,9.029215014217243,0.007969649848881166,93672.54998290008,252435.83154019312,681349.3246880551,1691579.189451233,4.2539942866592325e-08

gIMble/./gIMble optimize -z /scratch/npoikela/2montana.flavomontana.allopatric.CDS.X_collinear.64bp.z -c gimble.optimize.IM_AB.allopatric.CDS.X_collinear.64bp.kmax2.model4.config.ini -t allopatric.CDS.X_collinear.64bp.kmax2.IM_model4 -i 1000 --xtol 0.00000000000000001 --ftol 0.00000000000000001 -f -n 60

results: gimble.optimize.allopatric.CDS.X_collinear.64bp.kmax2.model4.0.20240114_164223.log

0,593,64,-1098686.9930941474,1.0,0.39978497086063136,0.13375942968439175,8.704882467340994,0.007896901741381008,95399.13573860865,238626.11826862706,713214.2830132048,1660876.528180996,4.138874886151134e-08
0,594,64,-1098686.9930940007,1.0,0.39978497086043013,0.13375942968430402,8.7048824673407,0.007896901741377079,95399.13573858558,238626.1182686895,713214.2830135002,1660876.5281805387,4.1388748861500746e-08
0,595,64,-1098686.993094123,1.0,0.39978497086050857,0.13375942968433685,8.704882467342923,0.007896901741382039,95399.13573858837,238626.11826864965,713214.283013346,1660876.528181011,4.138874886152553e-08
0,596,64,-1098686.993093891,1.0,0.3997849708600824,0.1337594296843632,8.704882467355183,0.007896901741387685,95399.13573853324,238626.11826876612,713214.2830127934,1660876.5281823906,4.138874886157905e-08
0,597,64,-1098686.993094254,1.0,0.3997849708600849,0.13375942968428234,8.704882467349979,0.00789690174138151,95399.13573853497,238626.11826876894,713214.2830132374,1660876.5281814276,4.138874886154593e-08



#### Inter and intraspecific dxy; correlation analysis ####

awk -v OFS='\t' '{ if($4==21) print }' gimble2.bed > gimble2.callable_all_samples.bed

bedtools intersect -a gimble2.callable_all_samples.bed -b D_montana.ref_genome.non_repeats.intergenic.sorted.bed > gimble2.D_montana.ref_genome.non_repeats.intergenic.all_callable.bed
sort -k1,1V -k2,2n gimble2.D_montana.ref_genome.non_repeats.intergenic.all_callable.bed > gimble2.D_montana.ref_genome.non_repeats.intergenic.all_callable.sorted.bed

gIMble/./gIMble measure -f -g gimble2.autosomes.genomefile -b gimble2.D_montana.ref_genome.non_repeats.intergenic.all_callable.sorted.bed -s gimble2.samples.montana.flavomontana.sympatric.csv -v gimble2.vcf.gz -z 2montana.flavomontana.sympatric.intergenic_callable_all_samples.64bp
gIMble/./gIMble measure -f -g gimble2.autosomes.genomefile -b gimble2.D_montana.ref_genome.non_repeats.intergenic.all_callable.sorted.bed -s gimble2.samples.montana.flavomontana.allopatric.csv -v gimble2.vcf.gz -z 2montana.flavomontana.allopatric.intergenic_callable_all_samples.64bp
gIMble/./gIMble measure -f -g gimble2.autosomes.genomefile -b gimble2.D_montana.ref_genome.non_repeats.intergenic.all_callable.sorted.bed -s gimble2.samples.montana.allopatric.sympatric.csv -v gimble2.vcf.gz -z 2montana.allopatric.sympatric.intergenic_callable_all_samples.64bp

## blocks
gIMble/./gIMble blocks -f -z 2montana.flavomontana.sympatric.intergenic_callable_all_samples.64bp.z -l 64
gIMble/./gIMble blocks -f -z 2montana.flavomontana.allopatric.intergenic_callable_all_samples.64bp.z -l 64
gIMble/./gIMble blocks -f -z 2montana.allopatric.sympatric.intergenic_callable_all_samples.64bp.z -l 64

## windows
# 9*9 = 81
# 3*9 = 27
gIMble/./gIMble windows -z 2montana.flavomontana.sympatric.intergenic_callable_all_samples.64bp.z -w 405000 -s 40500 -f
gIMble/./gIMble windows -z 2montana.flavomontana.allopatric.intergenic_callable_all_samples.64bp.z -w 135000 -s 13500 -f
gIMble/./gIMble windows -z 2montana.allopatric.sympatric.intergenic_callable_all_samples.64bp.z -w 135000 -s 13500 -f

# fetch windows
gIMble/./gIMble query -z 2montana.flavomontana.sympatric.intergenic_callable_all_samples.64bp.z -l windows
gIMble/./gIMble query -z 2montana.flavomontana.allopatric.intergenic_callable_all_samples.64bp.z -l windows
gIMble/./gIMble query -z 2montana.allopatric.sympatric.intergenic_callable_all_samples.64bp.z -l windows